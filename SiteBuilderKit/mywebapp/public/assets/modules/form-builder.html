<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title></title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content=""> 
<!-- <link href="assets/scripts/formbuilderai/formbuilderai.css" rel="stylesheet">
<script src="assets/scripts/formbuilderai/formbuilderai.min.js"></script>  -->
<style>
.fb-ui *,
.fb-ui ::before,
.fb-ui ::after {
  box-sizing: border-box;
  border-width: 0;
  border-style: solid;
  border-color: #e5e7eb;
}

.fb-ui button {
  background-color: transparent;
  background-image: none;
}

.fb-ui textarea {
  resize: vertical;
}

.fb-ui button,
.fb-ui [role=button] {
  cursor: pointer;
}

.fb-ui :disabled {
  cursor: default;
}

.fb-ui button, .fb-ui input, .fb-ui optgroup, .fb-ui select, .fb-ui textarea {
  font-family: inherit;
  font-feature-settings: inherit;
  font-variation-settings: inherit;
  font-size: 100%;
  font-weight: inherit;
  line-height: inherit;
  letter-spacing: inherit;
  color: inherit;
  margin: 0;
  padding: 0;
}

.fb-ui h1, .fb-ui p {
  margin: 0;
}

.fb-ui .relative {
  position: relative;
}

.fb-ui .hidden {
  display: none;
}

.fb-ui .block {
  display: block;
}

.fb-ui .flex {
  display: flex;
}

.fb-ui .flex-wrap {
  flex-wrap: wrap;
}

.fb-ui .flex-col {
  flex-direction: column;
}

.fb-ui .justify-between {
  justify-content: space-between;
}

.fb-ui .items-center {
  align-items: center;
}

.fb-ui .gap-2 {
  gap: 0.5rem;
}

.fb-ui .gap-4 {
  gap: 1rem;
}

.fb-ui .gap-6 {
  gap: 1.5rem;
}

.fb-ui .w-full {
  width: 100%;
}

.fb-ui .size-4 {
  width: 1rem;
  height: 1rem;
}

.fb-ui .size-5 {
  width: 1.25rem;
  height: 1.25rem;
}

.fb-ui .mt-1 {
  margin-top: 0.25rem;
}

.fb-ui .ml-1 {
  margin-left: 0.25rem;
}

.fb-ui .mb-1 {
  margin-bottom: 0.25rem;
}

.fb-ui .mb-2 {
  margin-bottom: 0.5rem;
}

.fb-ui .mt-3 {
  margin-top: 0.75rem;
}

.fb-ui .mt-4 {
  margin-top: 1rem;
}

.fb-ui .mb-4 {
  margin-bottom: 1rem;
}

.fb-ui .mb-5 {
  margin-bottom: 1.25rem;
}

.fb-ui .p-1 {
  padding: 0.25rem;
}

.fb-ui .pb-0 {
  padding-bottom: 0;
}

.fb-ui .px-1 {
  padding-left: 0.25rem;
  padding-right: 0.25rem;
}

.fb-ui .text-base {
  font-size: 1rem;
}

.fb-ui input, .fb-ui textarea, .fb-ui select {
  font-size: var(--formbuilder-input-font-size);
  line-height: var(--formbuilder-input-line-height);
  background-color: var(--formbuilder-input-background-color);
  transition: all 250ms ease-in-out;
}

.fb-ui .inp-base {
  width: 100%;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  outline: none;
  transition: border-color 250ms ease-in-out, box-shadow 250ms ease-in-out;
  border-radius: 0.25rem;
}

.fb-ui .inp-base:focus {
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.fb-ui .btn-base {
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 0.25rem;
  padding-left: 1rem;
  padding-right: 1rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  font-size: 1rem;
  background-color: #ececec;
  transition: background-color 0.3s;
}

.fb-ui .btn-base:hover {
  background-color: #e7e7e7;
}

.fb-ui .btn-base:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.fb-ui .input-checkbox {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 0.25rem;
  cursor: pointer;
  position: relative;
  margin-top: 0.5rem;
  padding: 0 0.25rem;
}

.fb-ui .peer {
  position: absolute;
  opacity: 0;
}

.fb-ui .peer-span-square {
  transition: all 0.2s ease-in-out;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: 0.25rem;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  border-radius: 0.125rem;
  color: transparent;
}

.fb-ui .peer:checked ~ .peer-span-square {
  border-color: var(--formbuilder-primary-color);
  color: var(--formbuilder-primary-color);
}

.fb-ui .peer:focus ~ .peer-span-square {
  box-shadow: 0 0 0 var(--formbuilder-secondary-border-width) var(--formbuilder-primary-color);
  border-color: transparent;
  outline-offset: 3px;
}

.fb-ui .demo-info {
  font-size: 0.75rem;
  margin-top: 0.75rem;
  max-width: 460px;
}

.dark .fb-ui .btn-base {
  background-color: #2c2c2c;
  color: #d1d5db;
}

.dark .fb-ui .btn-base:hover {
  background-color: #333;
}

/* Customize for Form Viewer */

:root {
  --form-font-family: system-ui, sans-serif;
  --form-text-color: inherit;
  --form-font-size: 1rem;
  --form-line-height: 1.5rem;
  --form-fields-gap: 0.75rem;
  --form-primary-color: #3b82f6;
  --form-primary-border-width: 1px;
  --form-secondary-border-width: 2px;
  --form-primary-rounded: 0.25rem;
  --form-label-color: inherit;
  --form-label-size: 1rem;
  --form-label-leading: 1.25rem;
  --form-label-weight: 600;
  --form-info-color: inherit;
  --form-input-font-size: 1rem;
  --form-input-line-height: 1.5rem;
  --form-input-background-color: #ffffff30;
  --form-input-placeholder-color: #9ca3af;
  --form-input-border-color: rgb(194 194 194);
  --form-choice-border-color: rgb(194 194 194);
  --form-switch-background-color: #ccc;
  --form-switch-knob-color: #fff;
  --form-switch-focus-offset-color: #fff;
  --form-dropfile-hover-color: rgba(0, 0, 0, 0.03);
  --form-dropfile-border-color: rgb(155 155 155);
  --form-title-font-size: 2.25rem;
  --form-title-line-height: 2.5rem;
  --form-title-font-weight: 600;
  --form-title-color: inherit;
  --form-desc-font-size: 1rem;
  --form-desc-line-height: 1.5rem;
  --form-desc-font-weight: 400;
  --form-desc-color: inherit;
  --form-button-background-color: #111827;
  --form-button-hover-background-color: #1f2937;
  --form-button-text-color: #fff;
  --form-button-hover-text-color: #fff;
}

.dark {
  /* Dark mode variables */
  --form-primary-color: rgb(96, 165, 250);
  --form-text-color: inherit;
  --form-input-background-color: #38393a;
  --form-input-placeholder-color: #9ca3af;
  --form-input-border-color: #4b5563;
  --form-choice-border-color: #4b5563;
  --form-switch-background-color: #575757;
  --form-switch-knob-color: #e0e0e0;
  --form-switch-focus-offset-color: #000;
  --form-dropfile-hover-color: rgba(255, 255, 255, 0.1);
  --form-dropfile-border-color: #4b5563;
  --form-title-color: inherit;
  --form-desc-color: inherit;
  --form-label-color: inherit;
  --form-info-color: inherit;
  --form-button-background-color: #2c2c2c;
  --form-button-hover-background-color: #333;
  --form-button-text-color: #d1d5db;
  --form-button-hover-text-color: #d1d5db;
}

/* Customize for Form Builder */

:root {
  --formbuilder-font-family: system-ui, sans-serif;
  --formbuilder-color: #3c3c3c;
  --formbuilder-font-size: 1rem;
  --formbuilder-line-height: 1.5rem;
  --formbuilder-primary-color: rgb(62, 147, 247);
  --formbuilder-secondary-color: rgb(156, 163, 175);
  --formbuilder-primary-border-width: 1px;
  --formbuilder-secondary-border-width: 2px;
  --formbuilder-input-font-size: 1rem;
  --formbuilder-input-line-height: 1.5rem;
  --formbuilder-input-background-color: #fff;
}

.dark {
  --formbuilder-color: #ededed;
  --formbuilder-primary-color: rgb(62, 147, 247);
  --formbuilder-secondary-color: #4b5563;
  --formbuilder-input-background-color: #38393a;
}

/* Form View */

.formview-container {
  font-family: var(--form-font-family);
  color: var(--form-color);
  font-size: var(--form-font-size);
  line-height: var(--form-line-height);
  /* animate spin */
}

.formview-container input, .formview-container textarea, .formview-container select {
  font-size: var(--form-input-font-size);
  line-height: var(--form-input-line-height);
  background-color: var(--form-input-background-color);
  transition: all 250ms ease-in-out;
}

.formview-container .text-red-500 {
  color: #f87171;
}

.formview-container .btn-submitform {
  margin-top: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  transition: all 0.2s ease-in-out;
  font-weight: 500;
  border-radius: 0.375rem;
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--form-button-background-color);
  color: var(--form-button-text-color);
}

.formview-container .btn-submitform:hover {
  background-color: var(--form-button-hover-background-color);
  color: var(--form-button-hover-text-color);
}

.formview-container .btn-submitform:focus-visible {
  outline: none;
  box-shadow: 0 0 0 var(--form-secondary-border-width) var(--form-primary-color);
}

.formview-container .custom-class {
  margin-top: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  transition: all 0.2s ease-in-out;
  font-weight: 500;
  border-radius: 0.375rem;
  box-shadow: var(--default-shadow);
  display: flex;
  align-items: center;
  justify-content: center;
}

.formview-container .custom-class:focus,
.formview-container .custom-class:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--primary-color);
}

.formview-container .text-info-color {
  opacity: 0.7;
}

.formview-container input::-moz-placeholder {
  color: var(--form-input-placeholder-color);
  /* Muted color for placeholders */
  opacity: 1;
  /* Ensure visibility */
}

.formview-container input::placeholder {
  color: var(--form-input-placeholder-color);
  /* Muted color for placeholders */
  opacity: 1;
  /* Ensure visibility */
}

.formview-container .form-header {
  display: flex;
  flex-direction: column;
  margin-bottom: 1rem;
}

.formview-container .form-title {
  font-size: var(--form-title-font-size);
  line-height: var(--form-title-line-height);
  font-weight: var(--form-title-font-weight);
  color: var(--form-title-color);
  margin-bottom: 1rem;
}

.formview-container .form-desc {
  font-size: var(--form-desc-font-size);
  line-height: var(--form-desc-line-height);
  font-weight: var(--form-desc-font-weight);
  color: var(--form-desc-color);
  margin-bottom: 1rem;
}

.formview-container .switch {
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  width: 59px;
  height: 34px;
  border: 2px solid transparent;
  border-radius: 500px;
  background-color: var(--form-switch-background-color);
  position: relative;
  outline: none;
  transition: all 0.15s ease-in-out;
}

.formview-container .switch[data-checked=true] {
  background-color: var(--form-primary-color);
}

.formview-container .switch-thumb {
  width: 26px;
  height: 26px;
  background: var(--form-switch-knob-color);
  border-radius: 50%;
  position: absolute;
  top: 50%;
  left: 2px;
  transform: translateY(-50%);
  transition: transform 0.2s;
}

.formview-container .switch[data-checked=true] .switch-thumb {
  transform: translate(24px, -50%);
}

.formview-container .switch:focus {
  box-shadow: 0 0 0 2px var(--form-switch-focus-offset-color), 0 0 0 4px var(--form-primary-color), 0 0 rgba(0, 0, 0, 0);
  /* Fallback for no shadow */
}

.formview-container .peer-span * {
  color: inherit;
}

.formview-container .form-wrapper {
  display: flex;
  flex-direction: column;
  gap: var(--form-fields-gap);
}

.formview-container .form-field {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  width: 100%;
}

.formview-container .field-label {
  font-size: var(--form-label-size);
  line-height: var(--form-label-leading);
  font-weight: var(--form-label-weight);
  color: var(--form-label-color);
  cursor: pointer;
}

.formview-container .field-label-normal {
  font-size: var(--form-label-size);
  line-height: var(--form-label-leading);
  font-weight: var(--form-label-weight);
  color: var(--form-label-color);
}

.formview-container .div-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 0.25rem;
  margin-bottom: 0.25rem;
}

.formview-container .option-label {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 0.25rem;
  cursor: pointer;
  position: relative;
}

.formview-container .option-label .peer {
  position: absolute;
  opacity: 0;
}

.formview-container .peer-span-rounded {
  transition: all 0.2s ease-in-out;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: 0.25rem;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-width: var(--form-primary-border-width);
  border-color: var(--form-choice-border-color);
  border-radius: 50%;
  color: transparent;
}

.formview-container .peer:checked ~ .peer-span-rounded {
  border-color: var(--form-primary-color);
  color: var(--form-primary-color);
}

.formview-container .peer:focus ~ .peer-span-rounded {
  box-shadow: 0 0 0 var(--form-secondary-border-width) var(--form-primary-color);
  border-color: transparent;
  outline-offset: 3px;
}

.formview-container .peer-span-square {
  transition: all 0.2s ease-in-out;
  width: 1.25rem;
  height: 1.25rem;
  margin-right: 0.25rem;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-width: var(--form-primary-border-width);
  border-color: var(--form-choice-border-color);
  border-radius: 0.125rem;
  color: transparent;
}

.formview-container .peer:checked ~ .peer-span-square {
  border-color: var(--form-primary-color);
  color: var(--form-primary-color);
}

.formview-container .peer:focus ~ .peer-span-square {
  box-shadow: 0 0 0 var(--form-secondary-border-width) var(--form-primary-color);
  border-color: transparent;
  outline-offset: 3px;
}

.formview-container select {
  display: block;
  width: 100%;
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none;
  padding-left: 0.75rem;
  padding-right: 0.75rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  border-width: var(--form-primary-border-width);
  border-color: var(--form-input-border-color);
  outline: none;
  border-radius: var(--form-primary-rounded);
}

.formview-container select:focus {
  border-color: transparent;
  box-shadow: 0 0 0 var(--form-secondary-border-width) var(--form-primary-color);
}

.formview-container .select-arrow {
  pointer-events: none;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  display: flex;
  align-items: center;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  color: #6b7280;
  /* Tailwind's gray-500 */
  height: 100%;
}

.formview-container .select-arrow svg {
  width: 1.25rem;
  height: 1.25rem;
}

.formview-container .input-other {
  margin-top: 0.5rem;
}

.formview-container .input-other.hidden {
  display: none;
}

.formview-container .input-color {
  width: 44px;
  height: 44px;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 2px;
  padding-right: 2px;
  border-width: var(--form-primary-border-width);
  border-color: var(--form-input-border-color);
  outline: none;
  border-radius: var(--form-primary-rounded);
  cursor: pointer;
}

.formview-container .input-color:focus-visible {
  border-color: transparent;
  box-shadow: 0 0 0 var(--form-secondary-border-width) var(--form-primary-color);
}

.formview-container .file-input-wrapper {
  position: relative;
  outline: none;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 100%;
  min-height: 150px;
  cursor: pointer;
  text-align: center;
}

.formview-container .file-input-wrapper:hover {
  background-color: var(--form-dropfile-hover-color);
}

.formview-container .file-input-wrapper input[type=file] {
  opacity: 0;
  position: absolute;
}

.formview-container .file-drop-area {
  transition: all 0.4s ease-in-out;
  position: absolute;
  width: 100%;
  height: 100%;
  cursor: pointer;
  border-width: var(--form-primary-border-width);
  border-color: var(--form-dropfile-border-color);
  border-style: dashed;
  border-radius: var(--form-primary-rounded);
}

.formview-container .peer:focus ~ .file-drop-area {
  border-width: var(--form-secondary-border-width);
  border-color: var(--form-primary-color);
  border-style: dashed;
  transform: scale(1.007);
}

.formview-container .file-drop-info {
  font-size: 0.875rem;
  color: var(--form-info-color);
  padding-left: 0.5rem;
  padding-right: 0.5rem;
}

.formview-container .file-drop-info-highlight {
  font-size: 0.875rem;
  color: var(--form-info-color);
  font-weight: 600;
  margin-top: 0.5rem;
}

.formview-container .inp-base {
  width: 100%;
  padding-left: 0.75rem;
  padding-right: 0.75rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  border-width: var(--form-primary-border-width);
  border-color: var(--form-input-border-color);
  outline: none;
  border-radius: var(--form-primary-rounded);
}

.formview-container .inp-base:focus {
  border-color: transparent;
  box-shadow: 0 0 0 var(--form-secondary-border-width) var(--form-primary-color);
}

.formview-container textarea.inp-base {
  height: 120px;
}

.formview-container .loading-icon {
  display: flex;
  align-items: center;
}

.formview-container .animate-spin {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

.dark .formview-container ::-webkit-calendar-picker-indicator {
  filter: invert(1);
  opacity: 0.7;
}

.dark .formview-container input[type=number]::-webkit-inner-spin-button {
  filter: invert(1);
  opacity: 0.7;
}

.dark .formview-container input[type=number]::-webkit-outer-spin-button {
  filter: invert(1);
  opacity: 0.7;
}

.result-container {
  font-family: var(--form-font-family);
  color: var(--form-color);
  font-size: var(--form-font-size);
  line-height: var(--form-line-height);
  margin-bottom: 1.5rem;
}

.result-container h1, .result-container h2, .result-container h3, .result-container h4, .result-container h5, .result-container h6 {
  font-weight: 600;
  line-height: 1.2;
}

.result-container h1 {
  font-size: 3.5rem;
}

.result-container h2 {
  font-size: 2rem;
  margin: 1.5rem 0 1.5rem;
}

.result-container h3 {
  font-size: 1.5rem;
  margin: 1.5rem 0 1.5rem;
}

.result-container h4 {
  font-size: 1.3rem;
  margin: 1.5rem 0 1.5rem;
}

.result-container h5 {
  font-size: 1.2rem;
  margin: 1.5rem 0 1.5rem;
}

.result-container p, .result-container pre, .result-container ol, .result-container ul {
  margin: 1.5rem 0 1.5rem;
}

.result-container pre {
  font-size: 16px;
  /* This makes text wrap inside <pre> */
  white-space: pre-wrap;
  background-color: #f7f7f7;
}

.result-container pre code.hljs {
  background-color: #f7f7f7;
}

.result-container ol {
  list-style-type: decimal;
  margin-left: 1rem;
}

.result-container ol li {
  margin-bottom: 0.5rem;
}

.result-container img {
  margin: 0;
}

/* Form Builder */

.formsettings-container {
  font-family: var(--formbuilder-font-family);
  color: var(--formbuilder-color);
  font-size: var(--formbuilder-font-size);
  line-height: var(--formbuilder-line-height);
}

.formsettings-container input, .formsettings-container textarea, .formsettings-container select {
  font-size: var(--formbuilder-input-font-size);
  line-height: var(--formbuilder-input-line-height);
  background-color: var(--formbuilder-input-background-color);
  transition: all 250ms ease-in-out;
}

.formsettings-container .inner-container {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0.5rem;
  margin-bottom: 0.75rem;
  width: 100%;
  max-width: 460px;
}

.formsettings-container .settings-title {
  font-size: 1.25rem;
  font-weight: 500;
  margin-bottom: 1rem;
}

.formsettings-container .field-label {
  font-size: 1rem;
  font-weight: 400;
  cursor: pointer;
}

.formsettings-container .inp-base {
  width: 100%;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  outline: none;
  transition: border-color 250ms ease-in-out, box-shadow 250ms ease-in-out;
  border-radius: 0.25rem;
}

.formsettings-container .inp-base:focus {
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formgenerator-container {
  font-family: var(--formbuilder-font-family);
  color: var(--formbuilder-color);
  font-size: var(--formbuilder-font-size);
  line-height: var(--formbuilder-line-height);
  /* animate spin */
}

.formgenerator-container input, .formgenerator-container textarea, .formgenerator-container select {
  font-size: var(--formbuilder-input-font-size);
  line-height: var(--formbuilder-input-line-height);
  background-color: var(--formbuilder-input-background-color);
  transition: all 250ms ease-in-out;
}

.formgenerator-container .inner-container {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0.5rem;
  margin-bottom: 0.75rem;
  width: 100%;
  max-width: 550px;
}

.formgenerator-container .settings-title {
  font-size: 1.25rem;
  font-weight: 500;
  margin-bottom: 1rem;
}

.formgenerator-container .field-label {
  font-size: 1rem;
  font-weight: 400;
  cursor: pointer;
}

.formgenerator-container textarea {
  height: 140px;
}

.formgenerator-container select {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none;
}

.formgenerator-container .select-arrow {
  pointer-events: none;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  display: flex;
  align-items: center;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  color: #6b7280;
  /* Tailwind's gray-500 */
  height: 100%;
}

.formgenerator-container .select-arrow svg {
  width: 1.25rem;
  height: 1.25rem;
}

.formgenerator-container .inp-base {
  width: 100%;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  outline: none;
  transition: border-color 250ms ease-in-out, box-shadow 250ms ease-in-out;
  border-radius: 0.25rem;
  /*  rounded */
}

.formgenerator-container .inp-base:focus {
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formgenerator-container button {
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 0.25rem;
  padding-left: 1rem;
  padding-right: 1rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  font-size: 1rem;
  background-color: #ececec;
  transition: background-color 0.3s;
}

.formgenerator-container button:hover {
  background-color: #e7e7e7;
}

.formgenerator-container button:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formgenerator-container .btn-generate-form {
  width: 100%;
  max-width: 550px;
  min-width: 296px;
}

.formgenerator-container .loading-icon {
  display: flex;
  align-items: center;
}

.formgenerator-container .animate-spin {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

.dark .formgenerator-container button {
  background-color: #2c2c2c;
  color: #d1d5db;
}

.dark .formgenerator-container button:hover {
  background-color: #333;
}

.formdesigner-container {
  font-family: var(--formbuilder-font-family);
  color: var(--formbuilder-color);
  font-size: var(--formbuilder-font-size);
  line-height: var(--formbuilder-line-height);
}

.formdesigner-container input {
  font-size: var(--formbuilder-input-font-size);
  line-height: var(--formbuilder-input-line-height);
  background-color: var(--formbuilder-input-background-color);
  transition: all 250ms ease-in-out;
}

.formdesigner-container .inner-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
  margin-top: 0.5rem;
  margin-bottom: 0.75rem;
  width: 100%;
  max-width: 650px;
  padding-left: 2px;
}

.formdesigner-container .inner-container .settings-title {
  font-size: 1.25rem;
  font-weight: 500;
  margin-bottom: 0;
}

.formdesigner-container .inner-container .inner-header {
  font-size: 1rem;
  font-weight: 600;
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.formdesigner-container .inner-container .btn-theme-reset {
  font-size: 0.875rem;
  font-weight: 400;
  text-decoration: underline;
}

.formdesigner-container .inner-container .items-group {
  font-size: 1rem;
  font-weight: 600;
  width: 100%;
  border-top: 1px solid #d1d5db;
  padding-top: 1.5625rem;
}

.formdesigner-container .inner-container .item-setting {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  width: 12rem;
}

.formdesigner-container .inner-container .width-setting {
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  outline: none;
  width: 4.375rem;
  height: 2.1875rem;
  border-radius: 0.375rem;
}

.formdesigner-container .inner-container .width-setting:focus-visible {
  border: transparent;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.dark .formdesigner-container .items-group {
  border-top: 1px solid rgba(145, 145, 145, 0.5019607843);
}

.formworkflow-container {
  font-family: var(--formbuilder-font-family);
  color: var(--formbuilder-color);
  font-size: var(--formbuilder-font-size);
  line-height: var(--formbuilder-line-height);
  /* animate spin */
}

.formworkflow-container .inner-container {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0.5rem;
  margin-bottom: 0.75rem;
  width: 100%;
}

.formworkflow-container .workflow-title {
  font-size: 1.25rem;
  font-weight: 600;
}

.formworkflow-container .workflow-tagline {
  font-size: 0.875rem;
  opacity: 0.7;
}

.formworkflow-container .steps-container {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.formworkflow-container .btn-addstep {
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 0.25rem;
  padding-left: 1rem;
  padding-right: 1rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  font-size: 1rem;
  background-color: #ececec;
  transition: background-color 0.3s;
  margin-top: 0.5rem;
  gap: 0.25rem;
}

.formworkflow-container .btn-addstep:hover {
  background-color: #e7e7e7;
}

.formworkflow-container .btn-addstep:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formworkflow-container .btn-addstep * {
  pointer-events: none;
}

.formworkflow-container .loading-icon {
  display: flex;
  align-items: center;
}

.formworkflow-container .animate-spin {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

.dark .formworkflow-container .btn-addstep {
  background-color: #2c2c2c;
  color: #d1d5db;
}

.dark .formworkflow-container .btn-addstep:hover {
  background-color: #333;
}

.formbuilder-container {
  font-family: var(--formbuilder-font-family);
  color: var(--formbuilder-color);
  font-size: var(--formbuilder-font-size);
  line-height: var(--formbuilder-line-height);
  /* field list item */
  /* add fields popup */
  /* add option for input select */
  /* field settings */
  /* sortable */
  /* others */
}

.formbuilder-container input, .formbuilder-container textarea, .formbuilder-container select {
  font-size: var(--formbuilder-input-font-size);
  line-height: var(--formbuilder-input-line-height);
  background-color: var(--formbuilder-input-background-color);
  transition: all 250ms ease-in-out;
}

.formbuilder-container [contentEditable] {
  transition: all 250ms ease-in-out;
}

.formbuilder-container .inp-base {
  width: 100%;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  outline: none;
  transition: border-color 250ms ease-in-out, box-shadow 250ms ease-in-out;
  border-radius: 0.25rem;
}

.formbuilder-container .inp-base:focus {
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .inp-placeholder-text,
.formbuilder-container .inp-default-value {
  max-width: 300px;
}

.formbuilder-container .fields-container {
  margin-bottom: 1rem;
  max-width: 460px;
  min-width: 296px;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.formbuilder-container .form-header {
  display: flex;
  flex-direction: column;
  margin-bottom: 1.5rem;
  padding-left: 2px;
}

.formbuilder-container .form-title {
  font-weight: 600;
  font-size: 2.25rem;
  line-height: 2.5rem;
  margin-bottom: 0.54rem;
}

.formbuilder-container .form-title > span {
  padding-left: 2px;
  padding-right: 0.5rem;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  outline: none;
  border-radius: 0.25rem;
  display: flex;
}

.formbuilder-container .form-title > span:focus {
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .form-desc {
  margin-bottom: 1rem;
}

.formbuilder-container .form-desc > span {
  padding-left: 2px;
  padding-right: 0.5rem;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  outline: none;
  border-radius: 0.25rem;
  display: flex;
}

.formbuilder-container .form-desc > span:focus {
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .div-field-label {
  position: absolute;
  top: -13px;
  padding-left: 0.25rem;
  padding-right: 0.25rem;
  background-color: white;
  color: #9ca3af;
  /* Equivalent to text-gray-400 */
  font-size: 0.75rem;
  line-height: 1.25;
}

.formbuilder-container .div-field-title > svg {
  color: black;
}

.formbuilder-container .inp-field-title {
  display: inline-flex;
  font-size: 0.95rem;
  line-height: 1.5rem;
  padding-left: 0.25rem;
  padding-right: 0.75rem;
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  outline: none;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  border-radius: 0.25rem;
}

.formbuilder-container .inp-field-title:focus {
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .popup-fields {
  position: absolute;
  margin-top: 0.5rem;
  background-color: white;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  padding-left: 1.5rem;
  padding-right: 1.5rem;
  padding-top: 1.25rem;
  padding-bottom: 1.5rem;
  max-width: 460px;
  z-index: 50;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s ease-in-out;
}

.formbuilder-container .btn-selectfield {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 6rem;
  font-size: 0.75rem;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5625rem;
  padding-bottom: 0.5625rem;
  border-radius: 0.25rem;
  transition: background-color 0.3s;
}

.formbuilder-container .btn-selectfield:hover {
  background-color: #f3f3f3;
}

.formbuilder-container .btn-selectfield:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .btn-addfield {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  gap: 0.25rem;
  border-radius: 0.25rem;
  padding-left: 1rem;
  padding-right: 1rem;
  padding-top: 0.8rem;
  padding-bottom: 0.8rem;
  font-size: 0.95rem;
  background-color: #ececec;
  transition: background-color 0.3s;
  max-width: 460px;
  min-width: 296px;
}

.formbuilder-container .btn-addfield:hover {
  background-color: #e7e7e7;
}

.formbuilder-container .btn-addfield:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .btn-addfield * {
  pointer-events: none;
}

.formbuilder-container .btn-addoption {
  max-width: 350px;
  margin: 0.25rem;
  border-radius: 0.25rem;
  padding-left: 1rem;
  padding-right: 1rem;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  font-size: 0.875rem;
  background-color: #ececec;
  transition: background-color 0.3s;
}

.formbuilder-container .btn-addoption:hover {
  background-color: #e7e7e7;
}

.formbuilder-container .btn-addoption:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .options-container {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.formbuilder-container .select-item {
  max-width: 350px;
  margin-left: 0.25rem;
  margin-right: 0.25rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: white;
  border: 2px solid #e5e7eb;
  padding-left: 0.75rem;
  padding-right: 0;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
}

.formbuilder-container .select-item .inp-option,
.formbuilder-container .select-item .inp-other-option {
  max-width: 220px;
  padding-left: 0.25rem;
  padding-right: 0.5rem;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  outline: none;
  border-radius: 0.25rem;
  border-color: transparent;
  background-color: transparent;
}

.formbuilder-container .select-item .inp-option:focus,
.formbuilder-container .select-item .inp-other-option:focus {
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .select-item .btn-other {
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  padding-left: 0.75rem;
  padding-right: 0.75rem;
}

.formbuilder-container .select-item .btn-other:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .field-item {
  display: flex;
  align-items: flex-start;
  flex-direction: column;
  justify-content: space-between;
  background-color: white;
  border: 2px solid #e5e7eb;
  padding-left: 1rem;
  padding-right: 0;
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
}

.formbuilder-container .field-settings {
  height: 0;
  overflow: hidden;
  transition: height 0.2s ease-in-out;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  min-width: 260px;
  margin-bottom: 1rem;
}

.formbuilder-container .field-settings.expanded {
  height: auto;
}

.formbuilder-container .btn-toggle-settings {
  width: 36px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  transform: rotate(360deg);
  transform-origin: center;
  transition: transform 0.2s ease-in-out;
}

.formbuilder-container .btn-toggle-settings.expanded {
  transform: rotate(180deg);
}

.formbuilder-container .btn-toggle-settings:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .btn-delfield {
  width: 36px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.formbuilder-container .btn-delfield:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .field-item .handle {
  width: 36px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.45;
}

.formbuilder-container .field-item .handle:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.formbuilder-container .field-label {
  font-size: 0.875rem;
  color: #999;
  cursor: pointer;
}

.formbuilder-container .field-label-normal {
  font-size: 0.875rem;
  color: #999;
}

.formbuilder-container .chk-required {
  width: 1rem;
  height: 1rem;
  cursor: pointer;
}

.formbuilder-container .sortable-ghost {
  opacity: 0.4;
}

.formbuilder-container .sortable-drag {
  background-image: none !important;
  background-color: transparent !important;
  outline: none !important;
}

.formbuilder-container .sortable-drag * {
  opacity: 0;
}

.formbuilder-container .sortable-drag::before {
  content: " ";
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  background: rgba(0, 0, 0, 0.03);
  transform-origin: top left;
}

.formbuilder-container .handle {
  cursor: move;
}

.formbuilder-container svg {
  overflow: hidden;
  vertical-align: middle;
  pointer-events: none;
}

.dark .formbuilder-container .field-item {
  background-color: transparent;
  border-color: #444;
  color: #d1d5db;
}

.dark .formbuilder-container .div-field-label {
  background-color: black;
}

.dark .formbuilder-container .div-field-title > svg {
  color: #d1d5db;
}

.dark .formbuilder-container .popup-fields {
  background-color: #232323;
  border-color: #4b5563;
  color: #d1d5db;
}

.dark .formbuilder-container .btn-selectfield:hover {
  background-color: #333;
}

.dark .formbuilder-container .btn-selectfield {
  color: #d1d5db;
}

.dark .formbuilder-container .select-item {
  background-color: transparent;
  border-color: #444;
}

.dark .formbuilder-container .btn-addoption {
  background-color: #2c2c2c;
  color: #d1d5db;
}

.dark .formbuilder-container .btn-addoption:hover {
  background-color: #333;
}

.dark .formbuilder-container .btn-addfield {
  background-color: #2c2c2c;
  color: #d1d5db;
}

.dark .formbuilder-container .btn-addfield:hover {
  background-color: #333;
}

/* ColorPicker */

.is-btn-color {
  width: 35px;
  height: 35px;
  padding: 0;
  background: rgba(255, 255, 255, 0.2);
  border: rgba(0, 0, 0, 0.27) 1px solid;
}

.is-pop {
  display: none;
  z-index: 10003;
  position: absolute;
  top: 0;
  left: 0;
  background: #fff;
  border: #eee;
  box-shadow: 4px 17px 20px 0px rgba(0, 0, 0, 0.08);
  outline: none;
  border-radius: 7px;
  overflow: hidden;
}

.is-pop:hover {
  z-index: 10003;
}

.dark .is-pop {
  background: #464646;
}

/* PromptEditor */

/* Wrapper for editable area and placeholder */

.editor-wrapper {
  position: relative;
}

.step-container {
  border-width: var(--formbuilder-primary-border-width);
  border-color: var(--formbuilder-secondary-color);
  outline: none;
  transition: border-color 250ms ease-in-out, box-shadow 250ms ease-in-out;
  border-radius: 0.25rem;
}

.step-container:focus-within {
  border-color: transparent;
  box-shadow: 0 0 0 2px var(--formbuilder-primary-color);
}

.step-label {
  padding: 0;
  font-size: 14px;
}

.step-label label {
  width: 40px;
  height: 40px;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0.7;
}

.step-label .btn-delstep {
  width: 40px;
  height: 40px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.step-label .btn-runstep {
  width: 40px;
  height: 40px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.prompt-editor {
  height: 140px;
  overflow-y: auto;
  /*
  padding: 10px;
  font-size: 16px;
  line-height: 1.5;
  color: #333;
  background-color: rgba(249, 249, 249, 0.9); 
  border: 1px solid #ddd;
  border-radius: 4px;
  box-sizing: border-box;
  // outline: none;
  position: relative;
  */
  width: 100%;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  outline: none;
}

.prompt-editor .tag {
  background-color: #e0e0e0;
  padding: 1px 6px;
  border-radius: 4px;
  display: inline-block;
  margin: 0 2px;
}

.dark .prompt-editor {
  font-size: var(--formbuilder-input-font-size);
  line-height: var(--formbuilder-input-line-height);
  background-color: var(--formbuilder-input-background-color);
  color: var(--formbuilder-color);
}

.dark .prompt-editor .tag {
  background-color: #a4a4a4;
  color: #1f1f1f;
}

/* Placeholder styling */

.placeholder-text {
  position: absolute;
  top: 0;
  left: 0;
  color: #aaa;
  /* Prevent interaction */
  font-size: 16px;
  line-height: 1.5;
  transition: opacity 0.3s ease;
  opacity: 1;
  pointer-events: none;
  padding: 12px 0 0 12px;
}

/* When contenteditable area has text, hide placeholder */

.placeholder-text.hidden {
  opacity: 0;
}

/* Dropdown container */

.tag-selector {
  position: absolute;
  background-color: #fff;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  border-radius: 16px;
  width: 200px;
  max-height: 250px;
  overflow-y: auto;
  z-index: 1000;
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease, visibility 0.2s ease;
  display: none;
  padding: 8px;
}

/* Show dropdown */

.tag-selector[aria-hidden=false] {
  visibility: visible;
  opacity: 1;
  display: block;
}

/* Dropdown item */

.tag-selector button {
  background: transparent;
  border: none;
  width: 100%;
  padding: 10px;
  text-align: left;
  font-size: 16px;
  color: #333;
  cursor: pointer;
  display: block;
  border-radius: 12px;
}

/* Hover effect */

.tag-selector button:hover {
  background-color: #3b82f6;
  color: #fff;
}

/* Focused item */

.tag-selector button:focus {
  outline: none;
  background-color: #eee;
  /* color: #0078d4; */
}

/* Dropdown item selected */

.tag-selector button.selected {
  background-color: #eee;
}

.tag-selector button.selected:hover {
  background-color: #3b82f6;
  color: #fff;
}

/* new colorpicker */

.pickr {
  position: relative;
  overflow: visible;
  transform: translateY(0);
}

.pickr * {
  box-sizing: border-box;
  outline: none;
  border: none;
  -webkit-appearance: none;
}

.pickr .pcr-button {
  position: relative;
  height: 2em;
  width: 2em;
  padding: 0.5em;
  cursor: pointer;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
  border-radius: 0.15em;
  background: url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" stroke="%2342445A" stroke-width="5px" stroke-linecap="round"><path d="M45,45L5,5"></path><path d="M45,5L5,45"></path></svg>') no-repeat center;
  background-size: 0;
  transition: all 0.3s;
}

.pickr .pcr-button::before {
  position: absolute;
  content: "";
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');
  background-size: 0.5em;
  border-radius: 0.15em;
  z-index: -1;
  z-index: initial;
}

.pickr .pcr-button::after {
  position: absolute;
  content: "";
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  transition: background 0.3s;
  background: var(--pcr-color);
  border-radius: 0.15em;
}

.pickr .pcr-button.clear {
  background-size: 70%;
}

.pickr .pcr-button.clear::before {
  opacity: 0;
}

.pickr .pcr-button.clear:focus {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.85), 0 0 0 3px var(--pcr-color);
}

.pickr .pcr-button.disabled {
  cursor: not-allowed;
}

.pickr *,
.pcr-app * {
  box-sizing: border-box;
  outline: none;
  border: none;
  -webkit-appearance: none;
}

.pickr input:focus, .pickr input.pcr-active,
.pickr button:focus,
.pickr button.pcr-active,
.pcr-app input:focus,
.pcr-app input.pcr-active,
.pcr-app button:focus,
.pcr-app button.pcr-active {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.85), 0 0 0 3px var(--pcr-color);
}

.pickr .pcr-palette,
.pickr .pcr-slider,
.pcr-app .pcr-palette,
.pcr-app .pcr-slider {
  transition: box-shadow 0.3s;
}

.pickr .pcr-palette:focus,
.pickr .pcr-slider:focus,
.pcr-app .pcr-palette:focus,
.pcr-app .pcr-slider:focus {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.85), 0 0 0 3px rgba(0, 0, 0, 0.25);
}

.pcr-app {
  position: fixed;
  display: flex;
  flex-direction: column;
  z-index: 10000;
  border-radius: 0.1em;
  background: #fff;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s, visibility 0s 0.3s;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
  box-shadow: 0 0.15em 1.5em 0 rgba(0, 0, 0, 0.1), 0 0 1em 0 rgba(0, 0, 0, 0.03);
  left: 0;
  top: 0;
}

.pcr-app.visible {
  transition: opacity 0.3s;
  visibility: visible;
  opacity: 1;
}

.pcr-app .pcr-swatches {
  display: flex;
  flex-wrap: wrap;
  margin-top: 0.75em;
}

.pcr-app .pcr-swatches.pcr-last {
  margin: 0;
}

@supports (display: grid) {
  .pcr-app .pcr-swatches {
    display: grid;
    align-items: center;
    grid-template-columns: repeat(auto-fit, 1.75em);
  }
}

.pcr-app .pcr-swatches > button {
  font-size: 1em;
  position: relative;
  width: calc(1.75em - 5px);
  height: calc(1.75em - 5px);
  border-radius: 0.15em;
  cursor: pointer;
  margin: 2.5px;
  flex-shrink: 0;
  justify-self: center;
  transition: all 0.15s;
  overflow: hidden;
  background: transparent;
  z-index: 1;
}

.pcr-app .pcr-swatches > button::before {
  position: absolute;
  content: "";
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');
  background-size: 6px;
  border-radius: 0.15em;
  z-index: -1;
}

.pcr-app .pcr-swatches > button::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--pcr-color);
  border: 1px solid rgba(0, 0, 0, 0.05);
  border-radius: 0.15em;
  box-sizing: border-box;
}

.pcr-app .pcr-swatches > button:hover {
  filter: brightness(1.05);
}

.pcr-app .pcr-swatches > button:not(.pcr-active) {
  box-shadow: none;
}

.pcr-app .pcr-interaction {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  margin: 0 -0.2em 0 -0.2em;
}

.pcr-app .pcr-interaction > * {
  margin: 0 0.2em;
}

.pcr-app .pcr-interaction input {
  letter-spacing: 0.07em;
  font-size: 0.75em;
  text-align: center;
  cursor: pointer;
  color: #75797e;
  background: #f1f3f4;
  border-radius: 0.15em;
  transition: all 0.15s;
  padding: 0.45em 0.5em;
  margin-top: 0.75em;
}

.pcr-app .pcr-interaction input:hover {
  filter: brightness(0.975);
}

.pcr-app .pcr-interaction input:focus {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.85), 0 0 0 3px rgba(66, 133, 244, 0.75);
}

.pcr-app .pcr-interaction .pcr-result {
  color: #75797e;
  text-align: left;
  flex: 1 1 8em;
  min-width: 8em;
  transition: all 0.2s;
  border-radius: 0.15em;
  background: #f1f3f4;
  cursor: text;
}

.pcr-app .pcr-interaction .pcr-result::-moz-selection {
  background: #4285f4;
  color: #fff;
}

.pcr-app .pcr-interaction .pcr-result::selection {
  background: #4285f4;
  color: #fff;
}

.pcr-app .pcr-interaction .pcr-type.active {
  color: #fff;
  background: #4285f4;
}

.pcr-app .pcr-interaction .pcr-save,
.pcr-app .pcr-interaction .pcr-cancel,
.pcr-app .pcr-interaction .pcr-clear {
  width: auto;
  color: #fff;
}

.pcr-app .pcr-interaction .pcr-save:hover,
.pcr-app .pcr-interaction .pcr-cancel:hover,
.pcr-app .pcr-interaction .pcr-clear:hover {
  filter: brightness(0.925);
}

.pcr-app .pcr-interaction .pcr-save {
  background: #4285f4;
}

.pcr-app .pcr-interaction .pcr-clear,
.pcr-app .pcr-interaction .pcr-cancel {
  background: #f44250;
}

.pcr-app .pcr-interaction .pcr-clear:focus,
.pcr-app .pcr-interaction .pcr-cancel:focus {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.85), 0 0 0 3px rgba(244, 66, 80, 0.75);
}

.pcr-app .pcr-selection .pcr-picker {
  position: absolute;
  height: 18px;
  width: 18px;
  border: 2px solid #fff;
  border-radius: 100%;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
}

.pcr-app .pcr-selection .pcr-color-palette,
.pcr-app .pcr-selection .pcr-color-chooser,
.pcr-app .pcr-selection .pcr-color-opacity {
  position: relative;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  display: flex;
  flex-direction: column;
  cursor: grab;
  cursor: -webkit-grab;
}

.pcr-app .pcr-selection .pcr-color-palette:active,
.pcr-app .pcr-selection .pcr-color-chooser:active,
.pcr-app .pcr-selection .pcr-color-opacity:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.pcr-app[data-theme=nano] {
  width: 14.25em;
  max-width: 95vw;
}

.pcr-app[data-theme=nano] .pcr-swatches {
  margin-top: 0.6em;
  padding: 0 0.6em;
}

.pcr-app[data-theme=nano] .pcr-interaction {
  padding: 0 0.6em 0.6em 0.6em;
}

.pcr-app[data-theme=nano] .pcr-selection {
  display: grid;
  grid-gap: 0.6em;
  grid-template-columns: 1fr 4fr;
  grid-template-rows: 5fr auto auto;
  align-items: center;
  height: 10.5em;
  width: 100%;
  align-self: flex-start;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-preview {
  grid-area: 2/1/4/1;
  height: 100%;
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: center;
  margin-left: 0.6em;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-preview .pcr-last-color {
  display: none;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-preview .pcr-current-color {
  position: relative;
  background: var(--pcr-color);
  width: 2em;
  height: 2em;
  border-radius: 50em;
  overflow: hidden;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-preview .pcr-current-color::before {
  position: absolute;
  content: "";
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');
  background-size: 0.5em;
  border-radius: 0.15em;
  z-index: -1;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-palette {
  grid-area: 1/1/2/3;
  width: 100%;
  height: 100%;
  z-index: 1;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-palette .pcr-palette {
  border-radius: 0.15em;
  width: 100%;
  height: 100%;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-palette .pcr-palette::before {
  position: absolute;
  content: "";
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');
  background-size: 0.5em;
  border-radius: 0.15em;
  z-index: -1;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-chooser {
  grid-area: 2/2/2/2;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-opacity {
  grid-area: 3/2/3/2;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-chooser,
.pcr-app[data-theme=nano] .pcr-selection .pcr-color-opacity {
  height: 0.5em;
  margin: 0 0.6em;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-chooser .pcr-picker,
.pcr-app[data-theme=nano] .pcr-selection .pcr-color-opacity .pcr-picker {
  top: 50%;
  transform: translateY(-50%);
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-chooser .pcr-slider,
.pcr-app[data-theme=nano] .pcr-selection .pcr-color-opacity .pcr-slider {
  flex-grow: 1;
  border-radius: 50em;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-chooser .pcr-slider {
  background: linear-gradient(to right, hsl(0, 100%, 50%), hsl(60, 100%, 50%), hsl(120, 100%, 50%), hsl(180, 100%, 50%), hsl(240, 100%, 50%), hsl(300, 100%, 50%), hsl(0, 100%, 50%));
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-opacity .pcr-slider {
  background: linear-gradient(to right, transparent, black), url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');
  background-size: 100%, 0.25em;
}

.pop-picker {
  z-index: 10050 !important;
  width: 240px;
  height: 362px;
  padding: 10px;
  box-sizing: border-box;
}

._pop-colpick_container {
  position: relative;
  width: 100%;
}

._pop-colpick {
  display: none !important;
}

.pcr-app {
  box-shadow: none;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  background: transparent !important;
}

.pcr-app[data-theme=nano] .pcr-interaction {
  padding: 0;
}

.pcr-app[data-theme=nano] .pcr-swatches {
  display: flex;
  padding: 0;
  margin-top: 12px !important;
}

.pcr-app .pcr-interaction .pcr-result {
  width: 100%;
  flex: none;
  height: 36px !important;
  margin-top: 8px !important;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif !important;
  font-weight: 300 !important;
  transition: none !important;
}

.pcr-app .pcr-swatches > button {
  font-size: 1em !important;
  position: relative !important;
  width: 30.7px !important;
  height: 30px !important;
  border-radius: 0px !important;
  cursor: pointer;
  margin: 0 !important;
  flex-shrink: 0;
  justify-self: center;
  transition: all 0.15s;
  overflow: hidden;
  background: rgba(0, 0, 0, 0) !important;
  z-index: 1;
}

.pcr-app .pcr-swatches > button::before,
.pcr-app .pcr-swatches > button::after {
  border-radius: 0px !important;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-preview .pcr-last-color {
  display: none !important;
}

.pcr-app[data-theme=nano] .pcr-selection {
  grid-gap: 1em !important;
  height: 160px !important;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-chooser, .pcr-app[data-theme=nano] .pcr-selection .pcr-color-opacity {
  height: 0.8em;
  margin: 0 0.6em;
}

.pcr-app[data-theme=nano] .pcr-selection .pcr-color-preview .pcr-current-color {
  width: 2.5em;
  height: 2.5em;
}

.pcr-app .pcr-interaction .pcr-clear, .pcr-app .pcr-interaction .pcr-cancel {
  line-height: 1;
  width: 74px;
  height: 24px;
  font-size: 0.9em;
  background: rgba(207, 207, 207, 0.4);
  color: #111;
  outline: none;
}

.pcr-app .pcr-interaction input {
  margin: 0.75em 0 0 0;
}

.pcr-app .pcr-interaction {
  justify-content: flex-end;
  width: 100%;
}

.pcr-app .pcr-interaction .pcr-clear:focus,
.pcr-app .pcr-interaction .pcr-cancel:focus {
  box-shadow: none !important;
}

.dark .pcr-app .pcr-interaction .pcr-clear,
.dark .pcr-app .pcr-interaction .pcr-cancel {
  color: rgb(255, 255, 255) !important;
}

.dark .pcr-app .pcr-interaction input {
  background-color: var(--formbuilder-input-background-color);
  color: var(--form-text-color);
  box-shadow: none;
}

/* new */

.pcr-app .pcr-interaction .pcr-result {
  color: #000;
}

.pickr input:focus, .pickr input.pcr-active, .pickr button:focus, .pickr button.pcr-active, .pcr-app input:focus, .pcr-app input.pcr-active, .pcr-app button:focus, .pcr-app button.pcr-active {
  box-shadow: none;
}




/* ---------- */



html { height:100%; }
body { 
    margin: 0;
    height:100%;
    font-family:system-ui, sans-serif;
    font-size:0.95rem;font-weight:400;line-height:1.4; 
    overflow-x: hidden;
}

.formbuilder-wrapper {
    display: flex;
    flex-direction: column;
    padding: 0 40px;
}
.form-editor, .form-designer, .form-generator, .form-settings-custom {
    padding: 30px 40px 15px 2px;
}
.form-settings-custom {
    max-width: 500px;
}
.form-settings {
    padding: 0 40px 15px 0;
}
.form-preview {
    padding: 33px 30px 15px 40px;
}
.form-editor, .form-designer {
    max-height: calc(100vh - 43px);
    overflow-y: auto;
}
.form-workflow,
.workflow-result {
    margin-top: 20px;
    margin-bottom: 20px;
}
.workflow-result {
    padding: 0 30px 15px 40px;
}


/* Tabs */

button {
    background-color: transparent;
    font-family: inherit;
    font-size: 100%;
    line-height: inherit;
    letter-spacing: inherit;
}
:root {
    --tabs-text-color: #323232;
    --tabs-border-color: #c2c8d2;
}
.dark {
    --tabs-text-color: #eaeaea;
    --tabs-border-color: #7e7e7e;
}
.tabs {
    display: flex;
    padding: 0 0 0 2px;
    list-style: none;
    width: 100%;
}
.tabs > div {
    width: 100%;
    border-bottom: 1px solid var(--tabs-border-color);
}
.tabs > .tab {
    padding: 9px 30px;
    /* margin-right: 5px; */
    border: 1px solid transparent;
    border-radius: 4px 4px 0 0;
    color: var(--tabs-text-color);
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
}
/* Active tab */
.tab[aria-selected="true"] {
    border-color: var(--tabs-border-color);
    border-bottom-color: transparent;
    white-space: nowrap;
}
/* Inactive tab */
.tab[aria-selected="false"] {
    border-bottom-color: var(--tabs-border-color);
}

/* Tab panel */
.tabpanels {
    display: flex;
}
.tabpanels > div {
    width:100%
}
.tab-panel {
    display: none;
}
/* Display tab panel when selected */
.tab-panel[aria-hidden="false"] {
    display: block;
}
.tab:focus-visible {
    outline: 2px solid #007bff;
}


.panel-preview {
    max-height: calc(100vh - 43px);
    overflow-y: auto;
}
.field {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}
@media (max-width: 970px) {
    .formbuilder-wrapper {
        padding: 0 20px;
    }
    .panel-preview {
        display: none;
    }
}


select {
    height: 42px;
}
input[disabled] {
    opacity: 0.6;
}

/* Adjustments */
.formsettings-container .inner-container {
    margin-top: 0;
}
.formsettings-container .settings-title {
    display: none;
}
:root {
    --formbuilder-color: #000;
}
</style>

</head>
<body class="m-6">

<div class="formbuilder-wrapper fb-ui">

    <div role="tablist" aria-label="Sample Tabs" class="tabs">
        <button role="tab" class="tab" aria-selected="true" aria-controls="tab1" id="tab1-button" tabindex="0">Edit Form</button>
        <button role="tab" class="tab" aria-selected="false" aria-controls="tab2" id="tab2-button" tabindex="-1">Design</button>
        <button role="tab" class="tab" aria-selected="false" aria-controls="tab3" id="tab3-button" tabindex="-1">Settings</button>
        <button role="tab" class="tab tab-generate" style="display:none" aria-selected="false" aria-controls="tab4" id="tab4-button" tabindex="-1">Generate</button>
        <div></div>
    </div>

    <div class="tabpanels">

        <div role="tabpanel" id="tab1" class="tab-panel" aria-hidden="false">

            <div class="form-editor"></div>
            <div class="form-workflow"></div>

        </div>

        <div role="tabpanel" id="tab2" class="tab-panel" aria-hidden="true">
        
            <div class="form-designer"></div>

        </div>

        <div role="tabpanel" id="tab3" class="tab-panel" aria-hidden="true">
        
            <div class="form-settings-custom flex flex-col gap-4">
                <div style="font-size: 1.25rem;
                font-weight: 500;
                margin-bottom: 0.5rem;
                margin-top: 0.35rem;" data-lang>Form Settings</div>

                <label class="field">
                    <span data-lang>Form Action:</span>
                    <input id="inpFormAction" class="inp-base" type="text" value="">
                </label>
                <label class="field">
                    <span data-lang>Submission Type:</span>
                    <select id="inpSubmissionType" class="inp-base">
                        <option value="" data-lang>JSON Submission</option>
                        <option value="standard" data-lang>Standard Form Submission</option>
                    </select>
                </label>
                <label class="field">
                    <span data-lang>Thank You Message:</span>
                    <input id="inpThankYouMessage" class="inp-base" type="text" value="">
                </label>
                <label class="field">
                    <span data-lang>Error Message:</span>
                    <input id="inpErrorMessage" class="inp-base" type="text" value="">
                </label>
                <label class="field">
                    <span data-lang>reCAPTCHA Site Key (v2):</span>
                    <input id="inpReCaptchaSiteKey" class="inp-base" type="text" value="">
                </label>
            </div>
            
            <div class="form-settings"></div>

        </div>

        <div role="tabpanel" id="tab4" class="tab-panel" aria-hidden="true">
        
            <div class="form-generator"></div>

        </div>

        <div class="panel-preview">
            <div class="form-preview"></div>
            <div class="workflow-result"></div>
        </div>

    </div>

</div>
<script>

var activeModule = parent._cb.activeCol;
var isBlock = activeModule?true:false;
if(!isBlock) {
    activeModule = parent._cb.doc.querySelector('.is-overlay-content[data-module-active]');
}

var builder;

var docReady = function (fn) {
    var stateCheck = setInterval(function () {
        if (document.readyState !== "complete") return;
        clearInterval(stateCheck);
        fn();
        // try { fn() } catch (e) { }
    }, 1);
};

docReady(function () {

    // Read settings (from data-settings attribute)
    var settings = getSettings();
    var jsonForm;
    var jsonTheme = {};
    if (settings != 'undefined') {
        var json = JSON.parse(settings);
        document.querySelector('#inpFormAction').value = json.formAction;
        document.querySelector('#inpReCaptchaSiteKey').value = json.siteKey || '';
        document.querySelector('#inpSubmissionType').value = json.submissionType || '';
        document.querySelector('#inpThankYouMessage').value = unescapeHTML(json.thankYouMessage);
        document.querySelector('#inpErrorMessage').value = unescapeHTML(json.errorMessage);

        jsonForm = json.json; 
        jsonTheme = json.jsonTheme || {}; 
    }

    let sendCommandUrl = (parent._cb && parent._cb.sendCommandUrl) || (parent.contentbox && parent.contentbox.sendCommandUrl) || '';
    if(sendCommandUrl) {
        const tabGenerate = document.querySelector('.tab-generate');
        tabGenerate.style.display = '';
    }
    builder = new FormBuilderAI({

        builderElement: document.querySelector('.form-editor'),

        onChange: (formData) => {
            
            builder.view(formData); // update view

        },
        // onThemeChange: (themeData) => { },
   
        onGenerate: (formData)=>{

            // reload
            builder.load(formData); // Show Editor
            builder.view(formData); // Show Form

            // // Set theme
            // let exampleTheme = {};
            // let initialTheme = JSON.stringify(exampleTheme);
            // let themeData = localStorage.getItem('myThemeData') || initialTheme; 
            // builder.setTheme(themeData); 

            // // Show Designer
            // builder.showDesigner();

        },
        onWorkflowChange: (workflowData) => {

            // localStorage.setItem('myWorkflowData', workflowData); // save workflow

        },
     
        designerElement: document.querySelector('.form-designer'),
        settingsElement: document.querySelector('.form-settings'),
        generatorElement: document.querySelector('.form-generator'),
        previewElement: document.querySelector('.form-preview'), // element for viewing the form

        submitText: 'Send',  // Default submit button text
        // onSubmit: async (e) =>{ 
        //     const formData = builder.getFormValues();
        //     console.log(formData);
        // },

        // form generator
        language:'English',
        languageSelection: true,
        sendCommandUrl, 

        // workflow
        workflowElement: document.querySelector('.form-workflow'),
        resultElement: document.querySelector('.workflow-result'),
        sendCommandStreamUrl: 'http://localhost:8083/getstream', 

        demo: false, 
    });

    let formData = JSON.stringify(jsonForm); 

    builder.load(formData); // Show Editor

    builder.view(formData); // Show Form

    // Set theme
    let initialTheme = JSON.stringify(jsonTheme);
    builder.setTheme(initialTheme); 

    // Show Designer
    builder.showDesigner();

    // Show Settings
    builder.showSettings();

    // Show Generator
    builder.showGenerator();

    // Load Workflow
    // const exampleWorkflow = {};
    // let initialWorkflowData = JSON.stringify(exampleWorkflow);
    // builder.loadWorkflow(initialWorkflowData);

    // Tabs
    const tabs = document.querySelectorAll('[role="tab"]');
    const tabPanels = document.querySelectorAll('[role="tabpanel"]');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            // Deactivate all tabs
            tabs.forEach(t => {
                t.setAttribute('aria-selected', 'false');
                t.setAttribute('tabindex', '-1');
            });
            
            // Hide all tab panels
            tabPanels.forEach(panel => {
                panel.setAttribute('aria-hidden', 'true');
            });

            // Activate clicked tab
            tab.setAttribute('aria-selected', 'true');
            tab.setAttribute('tabindex', '0');

            // Show corresponding panel
            const panelId = tab.getAttribute('aria-controls');
            document.getElementById(panelId).setAttribute('aria-hidden', 'false');
        });
    });

    // Keyboard navigation support
    tabs.forEach((tab, index) => {
        tab.addEventListener('keydown', (event) => {
        if (event.key === 'ArrowRight' || event.key === 'ArrowDown') {
            const nextTab = tabs[index + 1] || tabs[0];
            nextTab.focus();
        } else if (event.key === 'ArrowLeft' || event.key === 'ArrowUp') {
            const prevTab = tabs[index - 1] || tabs[tabs.length - 1];
            prevTab.focus();
        }
        });
    });
});

function escapeHTML(str) {
    if (typeof str !== "string") return str;
    return str
        .replace(/'/g, "&#39;")
        .replace(/`/g, "&#96;"); // Escape backtick
}
function unescapeHTML(str) {
    if (typeof str !== "string") return str;
    return str
        .replace(/&#39;/g, "'") // Unescape single quotes
        .replace(/&#96;/g, "`"); // Unescape backticks
}
function construct() {

    var formAction = document.querySelector('#inpFormAction').value;
    var thankYouMessage = escapeHTML(document.querySelector('#inpThankYouMessage').value);
    var errorMessage = escapeHTML(document.querySelector('#inpErrorMessage').value);
    var reCaptchaSiteKey = document.querySelector('#inpReCaptchaSiteKey').value;
    var submissionType = document.querySelector('#inpSubmissionType').value;

    var formData = builder.get();
    var themeData = builder.getTheme();

    var json = JSON.parse(formData);
    var jsonTheme = JSON.parse(themeData);

    var buttonText = json.submitText;

    var html = `
        <div id="_style_{id}" style="display:none">
            #{id} {
                transition: all 0.3s ease-out;
                height: auto;
            }
            #{id}.collapsed {
                overflow: hidden;
                height: 0;
            }
            #status_{id} {
                transition: all 0.3s ease-out;
                height: auto;
            }
            #status_{id}.collapsed {
                overflow: hidden;
                height: 0;
            }
        </div>
        <form id="form_{id}" method="POST" action="${formAction}" style="padding: 25px 0 20px">
            <div id="{id}"></div>

            <div id="status_{id}" class="collapsed"></div>
        </form>

        <scr` + `ipt>
            var css = document.querySelector('#_style_{id}').innerHTML;
            var head = document.getElementsByTagName('head')[0];
            var s = document.createElement('style');
            s.appendChild(document.createTextNode(css));
            head.appendChild(s);
            
            var docReady = function(fn) {
                var stateCheck = setInterval(function() {
                    if (document.readyState !== "complete") return;
                    clearInterval(stateCheck);
                    try {
                        fn()
                    } catch (e) {}
                }, 1);
            };
            var loadScriptByURL = function (id, url, callback) {
                var isScriptExist = document.getElementById(id);
                if (!isScriptExist) {
                    var script = document.createElement("script");
                    script.type = "text/javascript";
                    script.src = url;
                    script.id = id;
                    script.onload = function () {
                        if (callback) callback();
                    };
                    document.body.appendChild(script);
                }
                if (isScriptExist && callback) callback();
            }
            docReady(function() {

                var elm = document.getElementById('{id}');

                var reChaptchaSiteKey = '${reCaptchaSiteKey}';
                
                var viewer = new FormViewer(elm, {
                    captchaContainer: reChaptchaSiteKey?true:false,
                    captchaContainerClassName: 'captchaWidget'
                });

                var json = ${formData}; 
                var jsonTheme = ${themeData};
                
                viewer.setTheme(JSON.stringify(jsonTheme)); // Apply theme
                viewer.view(JSON.stringify(json)); // Render form

                var statusInfo = document.querySelector('#status_{id}');

                var form = document.querySelector('#form_{id}');
                
                var captchaWidget{id};
                if(reChaptchaSiteKey) {
                    loadScriptByURL('recaptcha-key', 'https://www.google.com/recaptcha/api.js', function () {
                        const interval = setInterval(() => {
                            if (window.grecaptcha) {
                                clearInterval(interval);
                                captchaWidget{id} = grecaptcha.render(form.querySelector('.captchaWidget'), {
                                    'sitekey' : reChaptchaSiteKey
                                });
                            }
                        }, 100); // Poll every 100ms to ensure grecaptcha is ready
                    });
                }

                async function handleSubmit(event) {
                    event.preventDefault();

                    if(reChaptchaSiteKey) {
                        var token = grecaptcha.getResponse(captchaWidget{id});
                        if(!token) return false;
                    }

                    var btnSend = form.querySelector('.btn-submitform');

                    btnSend.innerHTML = '<span class="loading-icon"><svg class="animate-spin" style="margin-right:7px;width:20px;height:20px" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>${buttonText}';

                    var data = new FormData(form);

                    // for (var pair of data.entries()) {
                    //     console.log(pair[0] + ': ' + pair[1]);
                    // }

                    fetch(form.action, {
                        method: form.method,
                        body: data,
                        headers: {
                            'Accept': 'application/json'
                        }
                    })
                    .then(response=>response.json())
                    .then(data=>{
                        if(!data.error) {
                            statusInfo.innerHTML = '<div class="text-center pt-4 pb-4"><i class="bi bi-send-check size-64"></i>' +
                            '</div><div class="leading-14 text-center size-38 pb-4">${thankYouMessage}</div>';
                            form.reset();

                            elm.classList.add('collapsed');
                            setTimeout(function(){
                                statusInfo.classList.remove('collapsed');
                            },300);

                        } else {
                            statusInfo.innerHTML = '<div class="leading-14 text-center size-38 pt-4 pb-4">${errorMessage}</div>';
                        
                            // elm.classList.toggle('collapsed');
                            setTimeout(function(){
                                // statusInfo.innerHTML = data.error;
                                statusInfo.classList.remove('collapsed');
                            },300);
                        }

                        if(reChaptchaSiteKey) {
                            grecaptcha.reset(captchaWidget{id}); // Reset reCAPTCHA widget
                        }

                        btnSend.innerHTML = '${buttonText}';
                    });
                }

                function handleSubmitStandard(event) {
                    event.preventDefault();

                    if(reChaptchaSiteKey) {
                        var token = grecaptcha.getResponse(captchaWidget{id});
                        if(!token) return false;
                    }

                    event.target.submit();
                }

                var submissionType = '${submissionType}';
                if(submissionType==='standard') {
                    form.addEventListener('submit', handleSubmitStandard);
                } else {
                    form.addEventListener('submit', handleSubmit);
                }
                // viewer.settings.onSubmit = handleSubmit;
            });
        </scr` + `ipt>`;

    // Render module
    if(isBlock) {
        parent._cb.setModuleHtml(html); 
    } else {
        setHtml(html);
    }

    var settings = {};
    settings.formAction = formAction;
    settings.thankYouMessage = thankYouMessage;
    settings.errorMessage = errorMessage;
    settings.siteKey = reCaptchaSiteKey;
    settings.submissionType = submissionType;
    settings.json = json;
    settings.jsonTheme = jsonTheme;

    // Save settings
    if(isBlock) {
        parent._cb.setModuleSettings(JSON.stringify(settings));
    } else {
        setSettings(JSON.stringify(settings));
    }
}

function getSettings() {
    var activeModule = parent._cb.activeCol;
    var isBlock = activeModule?true:false;
    if(!isBlock) {
        activeModule = parent._cb.doc.querySelector('.is-overlay-content[data-module-active]');
    }
    return decodeURIComponent(activeModule.getAttribute('data-settings'));
}

function setHtml(html) {
    parent.document.querySelector('#hidModuleCode').value = html;
}

function setSettings(settings) {
    parent.document.querySelector('#hidModuleSettings').value = settings;
}

// Language file stuff
function applyLang() {
    let elms = document.querySelectorAll('[data-lang]');
    elms.forEach(function(elm){
        elm.innerHTML = parent._cb.out(elm.innerHTML);
    });

    elms = document.querySelectorAll('[data-lang-title]');
    elms.forEach(function(elm){
        elm.setAttribute('title', parent._cb.out(elm.getAttribute('title')));
    });
}
applyLang();

// --------- Form Builder ------------

var FormBuilderAI=function(){"use strict";
/**!
   * Sortable 1.15.3
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   */function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){s(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},o.apply(this,arguments)}function i(e,t){if(null==e)return{};var n,s,o=function(e,t){if(null==e)return{};var n,s,o={},i=Object.keys(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function r(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var l=r(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),a=r(/Edge/i),c=r(/firefox/i),d=r(/safari/i)&&!r(/chrome/i)&&!r(/android/i),h=r(/iP(ad|od|hone)/i),u=r(/chrome/i)&&r(/android/i),p={capture:!1,passive:!1};function m(e,t,n){e.addEventListener(t,n,!l&&p)}function g(e,t,n){e.removeEventListener(t,n,!l&&p)}function f(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function b(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function v(e,t,n,s){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&f(e,t):f(e,t))||s&&e===n)return e;if(e===n)break}while(e=b(e))}return null}var w,y=/\s+/g;function k(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var s=(" "+e.className+" ").replace(y," ").replace(" "+t+" "," ");e.className=(s+(n?" "+t:"")).replace(y," ")}}function x(e,t,n){var s=e&&e.style;if(s){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in s||-1!==t.indexOf("webkit")||(t="-webkit-"+t),s[t]=n+("string"==typeof n?"":"px")}}function C(e,t){var n="";if("string"==typeof e)n=e;else do{var s=x(e,"transform");s&&"none"!==s&&(n=s+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function E(e,t,n){if(e){var s=e.getElementsByTagName(t),o=0,i=s.length;if(n)for(;o<i;o++)n(s[o],o);return s}return[]}function _(){var e=document.scrollingElement;return e||document.documentElement}function S(e,t,n,s,o){if(e.getBoundingClientRect||e===window){var i,r,a,c,d,h,u;if(e!==window&&e.parentNode&&e!==_()?(r=(i=e.getBoundingClientRect()).top,a=i.left,c=i.bottom,d=i.right,h=i.height,u=i.width):(r=0,a=0,c=window.innerHeight,d=window.innerWidth,h=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!l))do{if(o&&o.getBoundingClientRect&&("none"!==x(o,"transform")||n&&"static"!==x(o,"position"))){var p=o.getBoundingClientRect();r-=p.top+parseInt(x(o,"border-top-width")),a-=p.left+parseInt(x(o,"border-left-width")),c=r+i.height,d=a+i.width;break}}while(o=o.parentNode);if(s&&e!==window){var m=C(o||e),g=m&&m.a,f=m&&m.d;m&&(c=(r/=f)+(h/=f),d=(a/=g)+(u/=g))}return{top:r,left:a,bottom:c,right:d,width:u,height:h}}}function T(e,t,n){for(var s=q(e,!0),o=S(e)[t];s;){var i=S(s)[n];if(!("top"===n||"left"===n?o>=i:o<=i))return s;if(s===_())break;s=q(s,!1)}return!1}function $(e,t,n,s){for(var o=0,i=0,r=e.children;i<r.length;){if("none"!==r[i].style.display&&r[i]!==De.ghost&&(s||r[i]!==De.dragged)&&v(r[i],n.draggable,e,!1)){if(o===t)return r[i];o++}i++}return null}function A(e,t){for(var n=e.lastElementChild;n&&(n===De.ghost||"none"===x(n,"display")||t&&!f(n,t));)n=n.previousElementSibling;return n||null}function L(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===De.clone||t&&!f(e,t)||n++;return n}function M(e){var t=0,n=0,s=_();if(e)do{var o=C(e),i=o.a,r=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*r}while(e!==s&&(e=e.parentNode));return[t,n]}function q(e,t){if(!e||!e.getBoundingClientRect)return _();var n=e,s=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=x(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return _();if(s||t)return n;s=!0}}}while(n=n.parentNode);return _()}function N(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function P(e,t){return function(){if(!w){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),w=setTimeout((function(){w=void 0}),t)}}}function R(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function D(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function z(e,t,n){var s={};return Array.from(e.children).forEach((function(o){var i,r,l,a;if(v(o,t.draggable,e,!1)&&!o.animated&&o!==n){var c=S(o);s.left=Math.min(null!==(i=s.left)&&void 0!==i?i:1/0,c.left),s.top=Math.min(null!==(r=s.top)&&void 0!==r?r:1/0,c.top),s.right=Math.max(null!==(l=s.right)&&void 0!==l?l:-1/0,c.right),s.bottom=Math.max(null!==(a=s.bottom)&&void 0!==a?a:-1/0,c.bottom)}})),s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}var O="Sortable"+(new Date).getTime();function H(){var e,n=[];return{captureAnimationState:function(){(n=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==x(e,"display")&&e!==De.ghost){n.push({target:e,rect:S(e)});var s=t({},n[n.length-1].rect);if(e.thisAnimationDuration){var o=C(e,!0);o&&(s.top-=o.f,s.left-=o.e)}e.fromRect=s}}))},addAnimationState:function(e){n.push(e)},removeAnimationState:function(e){n.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var s in t)if(t.hasOwnProperty(s)&&t[s]===e[n][s])return Number(n);return-1}(n,{target:e}),1)},animateAll:function(t){var s=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof t&&t());var o=!1,i=0;n.forEach((function(e){var t=0,n=e.target,r=n.fromRect,l=S(n),a=n.prevFromRect,c=n.prevToRect,d=e.rect,h=C(n,!0);h&&(l.top-=h.f,l.left-=h.e),n.toRect=l,n.thisAnimationDuration&&N(a,l)&&!N(r,l)&&(d.top-l.top)/(d.left-l.left)==(r.top-l.top)/(r.left-l.left)&&(t=function(e,t,n,s){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*s.animation}(d,a,c,s.options)),N(l,r)||(n.prevFromRect=r,n.prevToRect=l,t||(t=s.options.animation),s.animate(n,d,l,t)),t&&(o=!0,i=Math.max(i,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),o?e=setTimeout((function(){"function"==typeof t&&t()}),i):"function"==typeof t&&t(),n=[]},animate:function(e,t,n,s){if(s){x(e,"transition",""),x(e,"transform","");var o=C(this.el),i=o&&o.a,r=o&&o.d,l=(t.left-n.left)/(i||1),a=(t.top-n.top)/(r||1);e.animatingX=!!l,e.animatingY=!!a,x(e,"transform","translate3d("+l+"px,"+a+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),x(e,"transition","transform "+s+"ms"+(this.options.easing?" "+this.options.easing:"")),x(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){x(e,"transition",""),x(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),s)}}}}var B=[],I={initializeByDefault:!0},j={mount:function(e){for(var t in I)I.hasOwnProperty(t)&&!(t in e)&&(e[t]=I[t]);B.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),B.push(e)},pluginEvent:function(e,n,s){var o=this;this.eventCanceled=!1,s.cancel=function(){o.eventCanceled=!0};var i=e+"Global";B.forEach((function(o){n[o.pluginName]&&(n[o.pluginName][i]&&n[o.pluginName][i](t({sortable:n},s)),n.options[o.pluginName]&&n[o.pluginName][e]&&n[o.pluginName][e](t({sortable:n},s)))}))},initializePlugins:function(e,t,n,s){for(var i in B.forEach((function(s){var i=s.pluginName;if(e.options[i]||s.initializeByDefault){var r=new s(e,t,e.options);r.sortable=e,r.options=e.options,e[i]=r,o(n,r.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var r=this.modifyOption(e,i,e.options[i]);void 0!==r&&(e.options[i]=r)}},getEventProperties:function(e,t){var n={};return B.forEach((function(s){"function"==typeof s.eventProperties&&o(n,s.eventProperties.call(t[s.pluginName],e))})),n},modifyOption:function(e,t,n){var s;return B.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(s=o.optionListeners[t].call(e[o.pluginName],n))})),s}};var F=["evt"],U=function(e,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.evt,r=i(s,F);j.pluginEvent.bind(De)(e,n,t({dragEl:W,parentEl:V,ghostEl:X,rootEl:G,nextEl:Z,lastDownEl:J,cloneEl:K,cloneHidden:Q,dragStarted:ue,putSortable:ie,activeSortable:De.active,originalEvent:o,oldIndex:ee,oldDraggableIndex:ne,newIndex:te,newDraggableIndex:se,hideGhostForTarget:qe,unhideGhostForTarget:Ne,cloneNowHidden:function(){Q=!0},cloneNowShown:function(){Q=!1},dispatchSortableEvent:function(e){Y({sortable:n,name:e,originalEvent:o})}},r))};function Y(e){!function(e){var n=e.sortable,s=e.rootEl,o=e.name,i=e.targetEl,r=e.cloneEl,c=e.toEl,d=e.fromEl,h=e.oldIndex,u=e.newIndex,p=e.oldDraggableIndex,m=e.newDraggableIndex,g=e.originalEvent,f=e.putSortable,b=e.extraEventProperties;if(n=n||s&&s[O]){var v,w=n.options,y="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||l||a?(v=document.createEvent("Event")).initEvent(o,!0,!0):v=new CustomEvent(o,{bubbles:!0,cancelable:!0}),v.to=c||s,v.from=d||s,v.item=i||s,v.clone=r,v.oldIndex=h,v.newIndex=u,v.oldDraggableIndex=p,v.newDraggableIndex=m,v.originalEvent=g,v.pullMode=f?f.lastPutMode:void 0;var k=t(t({},b),j.getEventProperties(o,n));for(var x in k)v[x]=k[x];s&&s.dispatchEvent(v),w[y]&&w[y].call(n,v)}}(t({putSortable:ie,cloneEl:K,targetEl:W,rootEl:G,oldIndex:ee,oldDraggableIndex:ne,newIndex:te,newDraggableIndex:se},e))}var W,V,X,G,Z,J,K,Q,ee,te,ne,se,oe,ie,re,le,ae,ce,de,he,ue,pe,me,ge,fe,be=!1,ve=!1,we=[],ye=!1,ke=!1,xe=[],Ce=!1,Ee=[],_e="undefined"!=typeof document,Se=h,Te=a||l?"cssFloat":"float",$e=_e&&!u&&!h&&"draggable"in document.createElement("div"),Ae=function(){if(_e){if(l)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Le=function(e,t){var n=x(e),s=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=$(e,0,t),i=$(e,1,t),r=o&&x(o),l=i&&x(i),a=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+S(o).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+S(i).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&r.float&&"none"!==r.float){var d="left"===r.float?"left":"right";return!i||"both"!==l.clear&&l.clear!==d?"horizontal":"vertical"}return o&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||a>=s&&"none"===n[Te]||i&&"none"===n[Te]&&a+c>s)?"vertical":"horizontal"},Me=function(e){function t(e,n){return function(s,o,i,r){var l=s.options.group.name&&o.options.group.name&&s.options.group.name===o.options.group.name;if(null==e&&(n||l))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(s,o,i,r),n)(s,o,i,r);var a=(n?s:o).options.group.name;return!0===e||"string"==typeof e&&e===a||e.join&&e.indexOf(a)>-1}}var s={},o=e.group;o&&"object"==n(o)||(o={name:o}),s.name=o.name,s.checkPull=t(o.pull,!0),s.checkPut=t(o.put),s.revertClone=o.revertClone,e.group=s},qe=function(){!Ae&&X&&x(X,"display","none")},Ne=function(){!Ae&&X&&x(X,"display","")};_e&&!u&&document.addEventListener("click",(function(e){if(ve)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ve=!1,!1}),!0);var Pe=function(e){if(W){e=e.touches?e.touches[0]:e;var t=(o=e.clientX,i=e.clientY,we.some((function(e){var t=e[O].options.emptyInsertThreshold;if(t&&!A(e)){var n=S(e),s=o>=n.left-t&&o<=n.right+t,l=i>=n.top-t&&i<=n.bottom+t;return s&&l?r=e:void 0}})),r);if(t){var n={};for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[O]._onDragOver(n)}}var o,i,r},Re=function(e){W&&W.parentNode[O]._isOutsideThisEl(e.target)};function De(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=o({},t),e[O]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Le(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==De.supportPointer&&"PointerEvent"in window&&!d,emptyInsertThreshold:5};for(var s in j.initializePlugins(this,e,n),n)!(s in t)&&(t[s]=n[s]);for(var i in Me(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&$e,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?m(e,"pointerdown",this._onTapStart):(m(e,"mousedown",this._onTapStart),m(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(m(e,"dragover",this),m(e,"dragenter",this)),we.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),o(this,H())}function ze(e,t,n,s,o,i,r,c){var d,h,u=e[O],p=u.options.onMove;return!window.CustomEvent||l||a?(d=document.createEvent("Event")).initEvent("move",!0,!0):d=new CustomEvent("move",{bubbles:!0,cancelable:!0}),d.to=t,d.from=e,d.dragged=n,d.draggedRect=s,d.related=o||t,d.relatedRect=i||S(t),d.willInsertAfter=c,d.originalEvent=r,e.dispatchEvent(d),p&&(h=p.call(u,d,r)),h}function Oe(e){e.draggable=!1}function He(){Ce=!1}function Be(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,s=0;n--;)s+=t.charCodeAt(n);return s.toString(36)}function Ie(e){return setTimeout(e,0)}function je(e){return clearTimeout(e)}De.prototype={constructor:De,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(pe=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,W):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,s=this.options,o=s.preventOnFilter,i=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(r||e).target,a=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=s.filter;if(function(e){Ee.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var s=t[n];s.checked&&Ee.push(s)}}(n),!W&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||s.disabled)&&!a.isContentEditable&&(this.nativeDraggable||!d||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=v(l,s.draggable,n,!1))&&l.animated||J===l)){if(ee=L(l),ne=L(l,s.draggable),"function"==typeof c){if(c.call(this,e,l,this))return Y({sortable:t,rootEl:a,name:"filter",targetEl:l,toEl:n,fromEl:n}),U("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(s){if(s=v(a,s.trim(),n,!1))return Y({sortable:t,rootEl:s,name:"filter",targetEl:l,fromEl:n,toEl:n}),U("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());s.handle&&!v(a,s.handle,n,!1)||this._prepareDragStart(e,r,l)}}},_prepareDragStart:function(e,t,n){var s,o=this,i=o.el,r=o.options,d=i.ownerDocument;if(n&&!W&&n.parentNode===i){var h=S(n);if(G=i,V=(W=n).parentNode,Z=W.nextSibling,J=n,oe=r.group,De.dragged=W,re={target:W,clientX:(t||e).clientX,clientY:(t||e).clientY},de=re.clientX-h.left,he=re.clientY-h.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,W.style["will-change"]="all",s=function(){U("delayEnded",o,{evt:e}),De.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!c&&o.nativeDraggable&&(W.draggable=!0),o._triggerDragStart(e,t),Y({sortable:o,name:"choose",originalEvent:e}),k(W,r.chosenClass,!0))},r.ignore.split(",").forEach((function(e){E(W,e.trim(),Oe)})),m(d,"dragover",Pe),m(d,"mousemove",Pe),m(d,"touchmove",Pe),m(d,"mouseup",o._onDrop),m(d,"touchend",o._onDrop),m(d,"touchcancel",o._onDrop),c&&this.nativeDraggable&&(this.options.touchStartThreshold=4,W.draggable=!0),U("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(a||l))s();else{if(De.eventCanceled)return void this._onDrop();m(d,"mouseup",o._disableDelayedDrag),m(d,"touchend",o._disableDelayedDrag),m(d,"touchcancel",o._disableDelayedDrag),m(d,"mousemove",o._delayedDragTouchMoveHandler),m(d,"touchmove",o._delayedDragTouchMoveHandler),r.supportPointer&&m(d,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(s,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){W&&Oe(W),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._disableDelayedDrag),g(e,"touchend",this._disableDelayedDrag),g(e,"touchcancel",this._disableDelayedDrag),g(e,"mousemove",this._delayedDragTouchMoveHandler),g(e,"touchmove",this._delayedDragTouchMoveHandler),g(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?m(document,"pointermove",this._onTouchMove):m(document,t?"touchmove":"mousemove",this._onTouchMove):(m(W,"dragend",this),m(G,"dragstart",this._onDragStart));try{document.selection?Ie((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(be=!1,G&&W){U("dragStarted",this,{evt:t}),this.nativeDraggable&&m(document,"dragover",Re);var n=this.options;!e&&k(W,n.dragClass,!1),k(W,n.ghostClass,!0),De.active=this,e&&this._appendGhost(),Y({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(le){this._lastX=le.clientX,this._lastY=le.clientY,qe();for(var e=document.elementFromPoint(le.clientX,le.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(le.clientX,le.clientY))!==t;)t=e;if(W.parentNode[O]._isOutsideThisEl(e),t)do{if(t[O]){if(t[O]._onDragOver({clientX:le.clientX,clientY:le.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=b(t));Ne()}},_onTouchMove:function(e){if(re){var t=this.options,n=t.fallbackTolerance,s=t.fallbackOffset,o=e.touches?e.touches[0]:e,i=X&&C(X,!0),r=X&&i&&i.a,l=X&&i&&i.d,a=Se&&fe&&M(fe),c=(o.clientX-re.clientX+s.x)/(r||1)+(a?a[0]-xe[0]:0)/(r||1),d=(o.clientY-re.clientY+s.y)/(l||1)+(a?a[1]-xe[1]:0)/(l||1);if(!De.active&&!be){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(X){i?(i.e+=c-(ae||0),i.f+=d-(ce||0)):i={a:1,b:0,c:0,d:1,e:c,f:d};var h="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");x(X,"webkitTransform",h),x(X,"mozTransform",h),x(X,"msTransform",h),x(X,"transform",h),ae=c,ce=d,le=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!X){var e=this.options.fallbackOnBody?document.body:G,t=S(W,!0,Se,!0,e),n=this.options;if(Se){for(fe=e;"static"===x(fe,"position")&&"none"===x(fe,"transform")&&fe!==document;)fe=fe.parentNode;fe!==document.body&&fe!==document.documentElement?(fe===document&&(fe=_()),t.top+=fe.scrollTop,t.left+=fe.scrollLeft):fe=_(),xe=M(fe)}k(X=W.cloneNode(!0),n.ghostClass,!1),k(X,n.fallbackClass,!0),k(X,n.dragClass,!0),x(X,"transition",""),x(X,"transform",""),x(X,"box-sizing","border-box"),x(X,"margin",0),x(X,"top",t.top),x(X,"left",t.left),x(X,"width",t.width),x(X,"height",t.height),x(X,"opacity","0.8"),x(X,"position",Se?"absolute":"fixed"),x(X,"zIndex","100000"),x(X,"pointerEvents","none"),De.ghost=X,e.appendChild(X),x(X,"transform-origin",de/parseInt(X.style.width)*100+"% "+he/parseInt(X.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,s=e.dataTransfer,o=n.options;U("dragStart",this,{evt:e}),De.eventCanceled?this._onDrop():(U("setupClone",this),De.eventCanceled||((K=D(W)).removeAttribute("id"),K.draggable=!1,K.style["will-change"]="",this._hideClone(),k(K,this.options.chosenClass,!1),De.clone=K),n.cloneId=Ie((function(){U("clone",n),De.eventCanceled||(n.options.removeCloneOnHide||G.insertBefore(K,W),n._hideClone(),Y({sortable:n,name:"clone"}))})),!t&&k(W,o.dragClass,!0),t?(ve=!0,n._loopId=setInterval(n._emulateDragOver,50)):(g(document,"mouseup",n._onDrop),g(document,"touchend",n._onDrop),g(document,"touchcancel",n._onDrop),s&&(s.effectAllowed="move",o.setData&&o.setData.call(n,s,W)),m(document,"drop",n),x(W,"transform","translateZ(0)")),be=!0,n._dragStartId=Ie(n._dragStarted.bind(n,t,e)),m(document,"selectstart",n),ue=!0,d&&x(document.body,"user-select","none"))},_onDragOver:function(e){var n,s,o,i,r=this.el,l=e.target,a=this.options,c=a.group,d=De.active,h=oe===c,u=a.sort,p=ie||d,m=this,g=!1;if(!Ce){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),l=v(l,a.draggable,r,!0),I("dragOver"),De.eventCanceled)return g;if(W.contains(e.target)||l.animated&&l.animatingX&&l.animatingY||m._ignoreWhileAnimating===l)return F(!1);if(ve=!1,d&&!a.disabled&&(h?u||(o=V!==G):ie===this||(this.lastPutMode=oe.checkPull(this,d,W,e))&&c.checkPut(this,d,W,e))){if(i="vertical"===this._getDirection(e,l),n=S(W),I("dragOverValid"),De.eventCanceled)return g;if(o)return V=G,j(),this._hideClone(),I("revert"),De.eventCanceled||(Z?G.insertBefore(W,Z):G.appendChild(W)),F(!0);var f=A(r,a.draggable);if(!f||function(e,t,n){var s=S(A(n.el,n.options.draggable)),o=z(n.el,n.options,X),i=10;return t?e.clientX>o.right+i||e.clientY>s.bottom&&e.clientX>s.left:e.clientY>o.bottom+i||e.clientX>s.right&&e.clientY>s.top}(e,i,this)&&!f.animated){if(f===W)return F(!1);if(f&&r===e.target&&(l=f),l&&(s=S(l)),!1!==ze(G,r,W,n,l,s,e,!!l))return j(),f&&f.nextSibling?r.insertBefore(W,f.nextSibling):r.appendChild(W),V=r,J(),F(!0)}else if(f&&function(e,t,n){var s=S($(n.el,0,n.options,!0)),o=z(n.el,n.options,X),i=10;return t?e.clientX<o.left-i||e.clientY<s.top&&e.clientX<s.right:e.clientY<o.top-i||e.clientY<s.bottom&&e.clientX<s.left}(e,i,this)){var b=$(r,0,a,!0);if(b===W)return F(!1);if(s=S(l=b),!1!==ze(G,r,W,n,l,s,e,!1))return j(),r.insertBefore(W,b),V=r,J(),F(!0)}else if(l.parentNode===r){s=S(l);var w,y,C,E=W.parentNode!==r,_=!function(e,t,n){var s=n?e.left:e.top,o=n?e.right:e.bottom,i=n?e.width:e.height,r=n?t.left:t.top,l=n?t.right:t.bottom,a=n?t.width:t.height;return s===r||o===l||s+i/2===r+a/2}(W.animated&&W.toRect||n,l.animated&&l.toRect||s,i),M=i?"top":"left",q=T(l,"top","top")||T(W,"top","top"),N=q?q.scrollTop:void 0;if(pe!==l&&(y=s[M],ye=!1,ke=!_&&a.invertSwap||E),w=function(e,t,n,s,o,i,r,l){var a=s?e.clientY:e.clientX,c=s?n.height:n.width,d=s?n.top:n.left,h=s?n.bottom:n.right,u=!1;if(!r)if(l&&ge<c*o){if(!ye&&(1===me?a>d+c*i/2:a<h-c*i/2)&&(ye=!0),ye)u=!0;else if(1===me?a<d+ge:a>h-ge)return-me}else if(a>d+c*(1-o)/2&&a<h-c*(1-o)/2)return function(e){return L(W)<L(e)?1:-1}(t);if((u=u||r)&&(a<d+c*i/2||a>h-c*i/2))return a>d+c/2?1:-1;return 0}(e,l,s,i,_?1:a.swapThreshold,null==a.invertedSwapThreshold?a.swapThreshold:a.invertedSwapThreshold,ke,pe===l),0!==w){var P=L(W);do{P-=w,C=V.children[P]}while(C&&("none"===x(C,"display")||C===X))}if(0===w||C===l)return F(!1);pe=l,me=w;var D=l.nextElementSibling,H=!1,B=ze(G,r,W,n,l,s,e,H=1===w);if(!1!==B)return 1!==B&&-1!==B||(H=1===B),Ce=!0,setTimeout(He,30),j(),H&&!D?r.appendChild(W):l.parentNode.insertBefore(W,H?D:l),q&&R(q,0,N-q.scrollTop),V=W.parentNode,void 0===y||ke||(ge=Math.abs(y-S(l)[M])),J(),F(!0)}if(r.contains(W))return F(!1)}return!1}function I(a,c){U(a,m,t({evt:e,isOwner:h,axis:i?"vertical":"horizontal",revert:o,dragRect:n,targetRect:s,canSort:u,fromSortable:p,target:l,completed:F,onMove:function(t,s){return ze(G,r,W,n,t,S(t),e,s)},changed:J},c))}function j(){I("dragOverAnimationCapture"),m.captureAnimationState(),m!==p&&p.captureAnimationState()}function F(t){return I("dragOverCompleted",{insertion:t}),t&&(h?d._hideClone():d._showClone(m),m!==p&&(k(W,ie?ie.options.ghostClass:d.options.ghostClass,!1),k(W,a.ghostClass,!0)),ie!==m&&m!==De.active?ie=m:m===De.active&&ie&&(ie=null),p===m&&(m._ignoreWhileAnimating=l),m.animateAll((function(){I("dragOverAnimationComplete"),m._ignoreWhileAnimating=null})),m!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(l===W&&!W.animated||l===r&&!l.animated)&&(pe=null),a.dragoverBubble||e.rootEl||l===document||(W.parentNode[O]._isOutsideThisEl(e.target),!t&&Pe(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function J(){te=L(W),se=L(W,a.draggable),Y({sortable:m,name:"change",toEl:r,newIndex:te,newDraggableIndex:se,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){g(document,"mousemove",this._onTouchMove),g(document,"touchmove",this._onTouchMove),g(document,"pointermove",this._onTouchMove),g(document,"dragover",Pe),g(document,"mousemove",Pe),g(document,"touchmove",Pe)},_offUpEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._onDrop),g(e,"touchend",this._onDrop),g(e,"pointerup",this._onDrop),g(e,"touchcancel",this._onDrop),g(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;te=L(W),se=L(W,n.draggable),U("drop",this,{evt:e}),V=W&&W.parentNode,te=L(W),se=L(W,n.draggable),De.eventCanceled||(be=!1,ke=!1,ye=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),je(this.cloneId),je(this._dragStartId),this.nativeDraggable&&(g(document,"drop",this),g(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),d&&x(document.body,"user-select",""),x(W,"transform",""),e&&(ue&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),X&&X.parentNode&&X.parentNode.removeChild(X),(G===V||ie&&"clone"!==ie.lastPutMode)&&K&&K.parentNode&&K.parentNode.removeChild(K),W&&(this.nativeDraggable&&g(W,"dragend",this),Oe(W),W.style["will-change"]="",ue&&!be&&k(W,ie?ie.options.ghostClass:this.options.ghostClass,!1),k(W,this.options.chosenClass,!1),Y({sortable:this,name:"unchoose",toEl:V,newIndex:null,newDraggableIndex:null,originalEvent:e}),G!==V?(te>=0&&(Y({rootEl:V,name:"add",toEl:V,fromEl:G,originalEvent:e}),Y({sortable:this,name:"remove",toEl:V,originalEvent:e}),Y({rootEl:V,name:"sort",toEl:V,fromEl:G,originalEvent:e}),Y({sortable:this,name:"sort",toEl:V,originalEvent:e})),ie&&ie.save()):te!==ee&&te>=0&&(Y({sortable:this,name:"update",toEl:V,originalEvent:e}),Y({sortable:this,name:"sort",toEl:V,originalEvent:e})),De.active&&(null!=te&&-1!==te||(te=ee,se=ne),Y({sortable:this,name:"end",toEl:V,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){U("nulling",this),G=W=V=X=Z=K=J=Q=re=le=ue=te=se=ee=ne=pe=me=ie=oe=De.dragged=De.ghost=De.clone=De.active=null,Ee.forEach((function(e){e.checked=!0})),Ee.length=ae=ce=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":W&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,s=0,o=n.length,i=this.options;s<o;s++)v(e=n[s],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||Be(e));return t},sort:function(e,t){var n={},s=this.el;this.toArray().forEach((function(e,t){var o=s.children[t];v(o,this.options.draggable,s,!1)&&(n[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(s.removeChild(n[e]),s.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return v(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var s=j.modifyOption(this,e,t);n[e]=void 0!==s?s:t,"group"===e&&Me(n)},destroy:function(){U("destroy",this);var e=this.el;e[O]=null,g(e,"mousedown",this._onTapStart),g(e,"touchstart",this._onTapStart),g(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(g(e,"dragover",this),g(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),we.splice(we.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Q){if(U("hideClone",this),De.eventCanceled)return;x(K,"display","none"),this.options.removeCloneOnHide&&K.parentNode&&K.parentNode.removeChild(K),Q=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Q){if(U("showClone",this),De.eventCanceled)return;W.parentNode!=G||this.options.group.revertClone?Z?G.insertBefore(K,Z):G.appendChild(K):G.insertBefore(K,W),this.options.group.revertClone&&this.animate(W,K),x(K,"display",""),Q=!1}}else this._hideClone()}},_e&&m(document,"touchmove",(function(e){(De.active||be)&&e.cancelable&&e.preventDefault()})),De.utils={on:m,off:g,css:x,find:E,is:function(e,t){return!!v(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:P,closest:v,toggleClass:k,clone:D,index:L,nextTick:Ie,cancelNextTick:je,detectDirection:Le,getChild:$,expando:O},De.get=function(e){return e[O]},De.mount=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];n[0].constructor===Array&&(n=n[0]),n.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(De.utils=t(t({},De.utils),e.utils)),j.mount(e)}))},De.create=function(e,t){return new De(e,t)},De.version="1.15.3";var Fe,Ue,Ye,We,Ve,Xe,Ge=[],Ze=!1;function Je(){Ge.forEach((function(e){clearInterval(e.pid)})),Ge=[]}function Ke(){clearInterval(Xe)}var Qe=P((function(e,t,n,s){if(t.scroll){var o,i=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,l=t.scrollSensitivity,a=t.scrollSpeed,c=_(),d=!1;Ue!==n&&(Ue=n,Je(),Fe=t.scroll,o=t.scrollFn,!0===Fe&&(Fe=q(n,!0)));var h=0,u=Fe;do{var p=u,m=S(p),g=m.top,f=m.bottom,b=m.left,v=m.right,w=m.width,y=m.height,k=void 0,C=void 0,E=p.scrollWidth,T=p.scrollHeight,$=x(p),A=p.scrollLeft,L=p.scrollTop;p===c?(k=w<E&&("auto"===$.overflowX||"scroll"===$.overflowX||"visible"===$.overflowX),C=y<T&&("auto"===$.overflowY||"scroll"===$.overflowY||"visible"===$.overflowY)):(k=w<E&&("auto"===$.overflowX||"scroll"===$.overflowX),C=y<T&&("auto"===$.overflowY||"scroll"===$.overflowY));var M=k&&(Math.abs(v-i)<=l&&A+w<E)-(Math.abs(b-i)<=l&&!!A),N=C&&(Math.abs(f-r)<=l&&L+y<T)-(Math.abs(g-r)<=l&&!!L);if(!Ge[h])for(var P=0;P<=h;P++)Ge[P]||(Ge[P]={});Ge[h].vx==M&&Ge[h].vy==N&&Ge[h].el===p||(Ge[h].el=p,Ge[h].vx=M,Ge[h].vy=N,clearInterval(Ge[h].pid),0==M&&0==N||(d=!0,Ge[h].pid=setInterval(function(){s&&0===this.layer&&De.active._onTouchMove(Ve);var t=Ge[this.layer].vy?Ge[this.layer].vy*a:0,n=Ge[this.layer].vx?Ge[this.layer].vx*a:0;"function"==typeof o&&"continue"!==o.call(De.dragged.parentNode[O],n,t,e,Ve,Ge[this.layer].el)||R(Ge[this.layer].el,n,t)}.bind({layer:h}),24))),h++}while(t.bubbleScroll&&u!==c&&(u=q(u,!1)));Ze=d}}),30),et=function(e){var t=e.originalEvent,n=e.putSortable,s=e.dragEl,o=e.activeSortable,i=e.dispatchSortableEvent,r=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var a=n||o;r();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);l(),a&&!a.el.contains(d)&&(i("spill"),this.onSpill({dragEl:s,putSortable:n}))}};function tt(){}function nt(){}function st(e,t,n,s,o={}){t instanceof HTMLCollection||t instanceof NodeList?t=Array.from(t):Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);for(const i of t)for(const t of n)i[e](t,s,{capture:!1,...o});return Array.prototype.slice.call(arguments,1)}tt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var s=$(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(t,s):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:et},o(tt,{pluginName:"revertOnSpill"}),nt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:et},o(nt,{pluginName:"removeOnSpill"}),De.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?m(document,"dragover",this._handleAutoScroll):this.options.supportPointer?m(document,"pointermove",this._handleFallbackAutoScroll):t.touches?m(document,"touchmove",this._handleFallbackAutoScroll):m(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):(g(document,"pointermove",this._handleFallbackAutoScroll),g(document,"touchmove",this._handleFallbackAutoScroll),g(document,"mousemove",this._handleFallbackAutoScroll)),Ke(),Je(),clearTimeout(w),w=void 0},nulling:function(){Ve=Ue=Fe=Ze=Xe=Ye=We=null,Ge.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,s=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(s,o);if(Ve=e,t||this.options.forceAutoScrollFallback||a||l||d){Qe(e,this.options,i,t);var r=q(i,!0);!Ze||Xe&&s===Ye&&o===We||(Xe&&Ke(),Xe=setInterval((function(){var i=q(document.elementFromPoint(s,o),!0);i!==r&&(r=i,Je()),Qe(e,n.options,i,t)}),10),Ye=s,We=o)}else{if(!this.options.bubbleScroll||q(i,!0)===_())return void Je();Qe(e,this.options,q(i,!1),!1)}}},o(e,{pluginName:"scroll",initializeByDefault:!0})}),De.mount(nt,tt);const ot=st.bind(null,"addEventListener"),it=st.bind(null,"removeEventListener");function rt(e){const t=document.createElement("div");return t.innerHTML=e.trim(),t.firstElementChild}function lt(e){const t=(e,t)=>{const n=e.getAttribute(t);return e.removeAttribute(t),n},n=(e,s={})=>{const o=t(e,":obj"),i=t(e,":ref"),r=o?s[o]={}:s;i&&(s[i]=e);for(const s of Array.from(e.children)){const e=t(s,":arr"),o=n(s,e?{}:r);e&&(r[e]||(r[e]=[])).push(Object.keys(o).length?o:s)}return s};return n(rt(e))}function at(e){let t=e.path||e.composedPath&&e.composedPath();if(t)return t;let n=e.target.parentElement;for(t=[e.target,n];n=n.parentElement;)t.push(n);return t.push(document,window),t}function ct(e){return e instanceof Element?e:"string"==typeof e?e.split(/>>/g).reduce(((e,t,n,s)=>(e=e.querySelector(t),n<s.length-1?e.shadowRoot:e)),document):null}function dt(e,t=e=>e){function n(n){const s=[.001,.01,.1][Number(n.shiftKey||2*n.ctrlKey)]*(n.deltaY<0?1:-1);let o=0,i=e.selectionStart;e.value=e.value.replace(/[\d.]+/g,((e,n)=>n<=i&&n+e.length>=i?(i=n,t(Number(e),s,o)):(o++,e))),e.focus(),e.setSelectionRange(i,i),n.preventDefault(),e.dispatchEvent(new Event("input"))}ot(e,"focus",(()=>ot(window,"wheel",n,{passive:!1}))),ot(e,"blur",(()=>it(window,"wheel",n)))}var ht=Object.freeze({__proto__:null,adjustableInputNumbers:dt,createElementFromString:rt,createFromTemplate:lt,eventPath:at,off:it,on:ot,resolveElement:ct});const{min:ut,max:pt,floor:mt,round:gt}=Math;function ft(e,t,n){t/=100,n/=100;const s=mt(e=e/360*6),o=e-s,i=n*(1-t),r=n*(1-o*t),l=n*(1-(1-o)*t),a=s%6;return[255*[n,r,i,i,l,n][a],255*[l,n,n,r,i,i][a],255*[i,i,l,n,n,r][a]]}function bt(e,t,n){const s=(2-(t/=100))*(n/=100)/2;return 0!==s&&(t=1===s?0:s<.5?t*n/(2*s):t*n/(2-2*s)),[e,100*t,100*s]}function vt(e,t,n){const s=ut(e/=255,t/=255,n/=255),o=pt(e,t,n),i=o-s;let r,l;if(0===i)r=l=0;else{l=i/o;const s=((o-e)/6+i/2)/i,a=((o-t)/6+i/2)/i,c=((o-n)/6+i/2)/i;e===o?r=c-a:t===o?r=1/3+s-c:n===o&&(r=2/3+a-s),r<0?r+=1:r>1&&(r-=1)}return[360*r,100*l,100*o]}function wt(e,t,n,s){t/=100,n/=100;return[...vt(255*(1-ut(1,(e/=100)*(1-(s/=100))+s)),255*(1-ut(1,t*(1-s)+s)),255*(1-ut(1,n*(1-s)+s)))]}function yt(e,t,n){t/=100;const s=2*(t*=(n/=100)<.5?n:1-n)/(n+t)*100,o=100*(n+t);return[e,isNaN(s)?0:s,o]}function kt(e){return vt(...e.match(/.{2}/g).map((e=>parseInt(e,16))))}function xt(e){e=e.match(/^[a-zA-Z]+$/)?function(e){if("black"===e.toLowerCase())return"#000";const t=document.createElement("canvas").getContext("2d");return t.fillStyle=e,"#000"===t.fillStyle?null:t.fillStyle}(e):e;const t={cmyk:/^cmyk\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)/i,rgba:/^rgba?\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D*?(([\d.]+)(%?)|$)/i,hsla:/^hsla?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hsva:/^hsva?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},n=e=>e.map((e=>/^(|\d+)\.\d+|\d+$/.test(e)?Number(e):void 0));let s;e:for(const o in t)if(s=t[o].exec(e))switch(o){case"cmyk":{const[,e,t,i,r]=n(s);if(e>100||t>100||i>100||r>100)break e;return{values:wt(e,t,i,r),type:o}}case"rgba":{let[,e,,t,,i,,,r]=n(s);if(e="%"===s[2]?e/100*255:e,t="%"===s[4]?t/100*255:t,i="%"===s[6]?i/100*255:i,r="%"===s[9]?r/100:r,e>255||t>255||i>255||r<0||r>1)break e;return{values:[...vt(e,t,i),r],a:r,type:o}}case"hexa":{let[,e]=s;4!==e.length&&3!==e.length||(e=e.split("").map((e=>e+e)).join(""));const t=e.substring(0,6);let n=e.substring(6);return n=n?parseInt(n,16)/255:void 0,{values:[...kt(t),n],a:n,type:o}}case"hsla":{let[,e,t,i,,r]=n(s);if(r="%"===s[6]?r/100:r,e>360||t>100||i>100||r<0||r>1)break e;return{values:[...yt(e,t,i),r],a:r,type:o}}case"hsva":{let[,e,t,i,,r]=n(s);if(r="%"===s[6]?r/100:r,e>360||t>100||i>100||r<0||r>1)break e;return{values:[e,t,i,r],a:r,type:o}}}return{values:null,type:null}}function Ct(e=0,t=0,n=0,s=1){const o=(e,t)=>(n=-1)=>t(~n?e.map((e=>Number(e.toFixed(n)))):e),i={h:e,s:t,v:n,a:s,toHSVA(){const e=[i.h,i.s,i.v,i.a];return e.toString=o(e,(e=>`hsva(${e[0]}, ${e[1]}%, ${e[2]}%, ${i.a})`)),e},toHSLA(){const e=[...bt(i.h,i.s,i.v),i.a];return e.toString=o(e,(e=>`hsla(${e[0]}, ${e[1]}%, ${e[2]}%, ${i.a})`)),e},toRGBA(){const e=[...ft(i.h,i.s,i.v),i.a];return e.toString=o(e,(e=>`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${i.a})`)),e},toCMYK(){const e=function(e,t,n){const s=ft(e,t,n),o=s[0]/255,i=s[1]/255,r=s[2]/255,l=ut(1-o,1-i,1-r);return[100*(1===l?0:(1-o-l)/(1-l)),100*(1===l?0:(1-i-l)/(1-l)),100*(1===l?0:(1-r-l)/(1-l)),100*l]}(i.h,i.s,i.v);return e.toString=o(e,(e=>`cmyk(${e[0]}%, ${e[1]}%, ${e[2]}%, ${e[3]}%)`)),e},toHEXA(){const e=function(e,t,n){return ft(e,t,n).map((e=>gt(e).toString(16).padStart(2,"0")))}(i.h,i.s,i.v),t=i.a>=1?"":Number((255*i.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return t&&e.push(t),e.toString=()=>`#${e.join("").toUpperCase()}`,e},clone:()=>Ct(i.h,i.s,i.v,i.a)};return i}const Et=e=>Math.max(Math.min(e,1),0);function _t(e){const t={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},e),_keyboard(e){const{options:n}=t,{type:s,key:o}=e;if(document.activeElement===n.wrapper){const{lock:n}=t.options,i="ArrowUp"===o,r="ArrowRight"===o,l="ArrowDown"===o,a="ArrowLeft"===o;if("keydown"===s&&(i||r||l||a)){let s=0,o=0;"v"===n?s=i||r?1:-1:"h"===n?s=i||r?-1:1:(o=i?-1:l?1:0,s=a?-1:r?1:0),t.update(Et(t.cache.x+.01*s),Et(t.cache.y+.01*o)),e.preventDefault()}else o.startsWith("Arrow")&&(t.options.onstop(),e.preventDefault())}},_tapstart(e){ot(document,["mouseup","touchend","touchcancel"],t._tapstop),ot(document,["mousemove","touchmove"],t._tapmove),e.cancelable&&e.preventDefault(),t._tapmove(e)},_tapmove(e){const{options:n,cache:s}=t,{lock:o,element:i,wrapper:r}=n,l=r.getBoundingClientRect();let a=0,c=0;if(e){const t=e&&e.touches&&e.touches[0];a=e?(t||e).clientX:0,c=e?(t||e).clientY:0,a<l.left?a=l.left:a>l.left+l.width&&(a=l.left+l.width),c<l.top?c=l.top:c>l.top+l.height&&(c=l.top+l.height),a-=l.left,c-=l.top}else s&&(a=s.x*l.width,c=s.y*l.height);"h"!==o&&(i.style.left=`calc(${a/l.width*100}% - ${i.offsetWidth/2}px)`),"v"!==o&&(i.style.top=`calc(${c/l.height*100}% - ${i.offsetHeight/2}px)`),t.cache={x:a/l.width,y:c/l.height};const d=Et(a/l.width),h=Et(c/l.height);switch(o){case"v":return n.onchange(d);case"h":return n.onchange(h);default:return n.onchange(d,h)}},_tapstop(){t.options.onstop(),it(document,["mouseup","touchend","touchcancel"],t._tapstop),it(document,["mousemove","touchmove"],t._tapmove)},trigger(){t._tapmove()},update(e=0,n=0){const{left:s,top:o,width:i,height:r}=t.options.wrapper.getBoundingClientRect();"h"===t.options.lock&&(n=e),t._tapmove({clientX:s+i*e,clientY:o+r*n})},destroy(){const{options:e,_tapstart:n,_keyboard:s}=t;it(document,["keydown","keyup"],s),it([e.wrapper,e.element],"mousedown",n),it([e.wrapper,e.element],"touchstart",n,{passive:!1})}},{options:n,_tapstart:s,_keyboard:o}=t;return ot([n.wrapper,n.element],"mousedown",s),ot([n.wrapper,n.element],"touchstart",s,{passive:!1}),ot(document,["keydown","keyup"],o),t}function St(e={}){e=Object.assign({onchange:()=>0,className:"",elements:[]},e);const t=ot(e.elements,"click",(t=>{e.elements.forEach((n=>n.classList[t.target===n?"add":"remove"](e.className))),e.onchange(t),t.stopPropagation()}));return{destroy:()=>it(...t)}}
/*! NanoPop 2.4.2 MIT | https://github.com/Simonwep/nanopop */
const Tt={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},$t=(e,t,n)=>{const s="object"!=typeof e||e instanceof HTMLElement?{reference:e,popper:t,...n}:e;return{update(e=s){const{reference:t,popper:n}=Object.assign(s,e);if(!n||!t)throw new Error("Popper- or reference-element missing.");return((e,t,n)=>{const{container:s,arrow:o,margin:i,padding:r,position:l,variantFlipOrder:a,positionFlipOrder:c}={container:document.documentElement.getBoundingClientRect(),...Tt,...n},{left:d,top:h}=t.style;t.style.left="0",t.style.top="0";const u=e.getBoundingClientRect(),p=t.getBoundingClientRect(),m={t:u.top-p.height-i,b:u.bottom+i,r:u.right+i,l:u.left-p.width-i},g={vs:u.left,vm:u.left+u.width/2-p.width/2,ve:u.left+u.width-p.width,hs:u.top,hm:u.bottom-u.height/2-p.height/2,he:u.bottom-p.height},[f,b="middle"]=l.split("-"),v=c[f],w=a[b],{top:y,left:k,bottom:x,right:C}=s;for(const e of v){const n="t"===e||"b"===e;let s=m[e];const[i,l]=n?["top","left"]:["left","top"],[a,c]=n?[p.height,p.width]:[p.width,p.height],[d,h]=n?[x,C]:[C,x],[f,b]=n?[y,k]:[k,y];if(!(s<f||s+a+r>d))for(const d of w){let m=g[(n?"v":"h")+d];if(!(m<b||m+c+r>h)){if(m-=p[l],s-=p[i],t.style[l]=`${m}px`,t.style[i]=`${s}px`,o){const t=n?u.width/2:u.height/2,r=c/2,h=t>r,p=m+{s:h?r:t,m:r,e:h?r:c-t}[d],g=s+{t:a,b:0,r:0,l:a}[e];o.style[l]=`${p}px`,o.style[i]=`${g}px`}return e+d}}}return t.style.left=d,t.style.top=h,null})(t,n,s)}}};
/*! Pickr 1.9.0 MIT | https://github.com/Simonwep/pickr */class At{static utils=ht;static I18N_DEFAULTS={"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"};static DEFAULT_OPTIONS={appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"};_initializingActive=!0;_recalc=!0;_nanopop=null;_root=null;_color=Ct();_lastColor=Ct();_swatchColors=[];_setupAnimationFrame=null;_eventListener={init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]};constructor(e){this.options=e=Object.assign({...At.DEFAULT_OPTIONS},e);const{swatches:t,components:n,theme:s,sliders:o,lockOpacity:i,padding:r}=e;["nano","monolith"].includes(s)&&!o&&(e.sliders="h"),n.interaction||(n.interaction={});const{preview:l,opacity:a,hue:c,palette:d}=n;n.opacity=!i&&a,n.palette=d||l||a||c,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),t&&t.length&&t.forEach((e=>this.addSwatch(e)));const{button:h,app:u}=this._root;this._nanopop=$t(h,u,{margin:r}),h.setAttribute("role","button"),h.setAttribute("aria-label",this._t("btn:toggle"));const p=this;this._setupAnimationFrame=requestAnimationFrame((function t(){if(!u.offsetWidth)return requestAnimationFrame(t);new Promise((t=>{p.setColor(e.default),p._rePositioningPicker(),e.defaultRepresentation&&(p._representation=e.defaultRepresentation,p.setColorRepresentation(p._representation)),e.showAlways&&p.show(),t()})).then((()=>{p._initializingActive=!1,p._emit("init")}))}))}static create=e=>new At(e);_preBuild(){const{options:e}=this;for(const t of["el","container"])e[t]=ct(e[t]);this._root=(e=>{const{components:t,useAsButton:n,inline:s,appClass:o,theme:i,lockOpacity:r}=e.options,l=e=>e?"":'style="display:none" hidden',a=t=>e._t(t),c=lt(`\n      <div :ref="root" class="pickr">\n\n        ${n?"":'<button type="button" :ref="button" class="pcr-button"></button>'}\n\n        <div :ref="app" class="pcr-app ${o||""}" data-theme="${i}" ${s?'style="position: unset"':""} aria-label="${a("ui:dialog")}" role="window">\n          <div class="pcr-selection" ${l(t.palette)}>\n            <div :obj="preview" class="pcr-color-preview" ${l(t.preview)}>\n              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${a("btn:last-color")}"></button>\n              <div :ref="currentColor" class="pcr-current-color"></div>\n            </div>\n\n            <div :obj="palette" class="pcr-color-palette">\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${a("aria:palette")}" role="listbox"></div>\n            </div>\n\n            <div :obj="hue" class="pcr-color-chooser" ${l(t.hue)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${a("aria:hue")}" role="slider"></div>\n            </div>\n\n            <div :obj="opacity" class="pcr-color-opacity" ${l(t.opacity)}>\n              <div :ref="picker" class="pcr-picker"></div>\n              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${a("aria:opacity")}" role="slider"></div>\n            </div>\n          </div>\n\n          <div class="pcr-swatches ${t.palette?"":"pcr-last"}" :ref="swatches"></div>\n\n          <div :obj="interaction" class="pcr-interaction" ${l(Object.keys(t.interaction).length)}>\n            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${l(t.interaction.input)} aria-label="${a("aria:input")}">\n\n            <input :arr="options" class="pcr-type" data-type="HEXA" value="${r?"HEX":"HEXA"}" type="button" ${l(t.interaction.hex)}>\n            <input :arr="options" class="pcr-type" data-type="RGBA" value="${r?"RGB":"RGBA"}" type="button" ${l(t.interaction.rgba)}>\n            <input :arr="options" class="pcr-type" data-type="HSLA" value="${r?"HSL":"HSLA"}" type="button" ${l(t.interaction.hsla)}>\n            <input :arr="options" class="pcr-type" data-type="HSVA" value="${r?"HSV":"HSVA"}" type="button" ${l(t.interaction.hsva)}>\n            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${l(t.interaction.cmyk)}>\n\n            <input :ref="save" class="pcr-save" value="${a("btn:save")}" type="button" ${l(t.interaction.save)} aria-label="${a("aria:btn:save")}">\n            <input :ref="cancel" class="pcr-cancel" value="${a("btn:cancel")}" type="button" ${l(t.interaction.cancel)} aria-label="${a("aria:btn:cancel")}">\n            <input :ref="clear" class="pcr-clear" value="${a("btn:clear")}" type="button" ${l(t.interaction.clear)} aria-label="${a("aria:btn:clear")}">\n          </div>\n        </div>\n      </div>\n    `),d=c.interaction;return d.options.find((e=>!e.hidden&&!e.classList.add("active"))),d.type=()=>d.options.find((e=>e.classList.contains("active"))),c})(this),e.useAsButton&&(this._root.button=e.el),e.container.appendChild(this._root.root)}_finalBuild(){const e=this.options,t=this._root;if(e.container.removeChild(t.root),e.inline){const n=e.el.parentElement;e.el.nextSibling?n.insertBefore(t.app,e.el.nextSibling):n.appendChild(t.app)}else e.container.appendChild(t.app);e.useAsButton?e.inline&&e.el.remove():e.el.parentNode.replaceChild(t.root,e.el),e.disabled&&this.disable(),e.comparison||(t.button.style.transition="none",e.useAsButton||(t.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const e=this,t=this.options.components,n=(e.options.sliders||"v").repeat(2),[s,o]=n.match(/^[vh]+$/g)?n:[],i=()=>this._color||(this._color=this._lastColor.clone()),r={palette:_t({element:e._root.palette.picker,wrapper:e._root.palette.palette,onstop:()=>e._emit("changestop","slider",e),onchange(n,s){if(!t.palette)return;const o=i(),{_root:r,options:l}=e,{lastColor:a,currentColor:c}=r.preview;e._recalc&&(o.s=100*n,o.v=100-100*s,o.v<0&&(o.v=0),e._updateOutput("slider"));const d=o.toRGBA().toString(0);this.element.style.background=d,this.wrapper.style.background=`\n                        linear-gradient(to top, rgba(0, 0, 0, ${o.a}), transparent),\n                        linear-gradient(to left, hsla(${o.h}, 100%, 50%, ${o.a}), rgba(255, 255, 255, ${o.a}))\n                    `,l.comparison?l.useAsButton||e._lastColor||a.style.setProperty("--pcr-color",d):(r.button.style.setProperty("--pcr-color",d),r.button.classList.remove("clear"));const h=o.toHEXA().toString();for(const{el:t,color:n}of e._swatchColors)t.classList[h===n.toHEXA().toString()?"add":"remove"]("pcr-active");c.style.setProperty("--pcr-color",d)}}),hue:_t({lock:"v"===o?"h":"v",element:e._root.hue.picker,wrapper:e._root.hue.slider,onstop:()=>e._emit("changestop","slider",e),onchange(n){if(!t.hue||!t.palette)return;const s=i();e._recalc&&(s.h=360*n),this.element.style.backgroundColor=`hsl(${s.h}, 100%, 50%)`,r.palette.trigger()}}),opacity:_t({lock:"v"===s?"h":"v",element:e._root.opacity.picker,wrapper:e._root.opacity.slider,onstop:()=>e._emit("changestop","slider",e),onchange(n){if(!t.opacity||!t.palette)return;const s=i();e._recalc&&(s.a=Math.round(100*n)/100),this.element.style.background=`rgba(0, 0, 0, ${s.a})`,r.palette.trigger()}}),selectable:St({elements:e._root.interaction.options,className:"active",onchange(t){e._representation=t.target.getAttribute("data-type").toUpperCase(),e._recalc&&e._updateOutput("swatch")}})};this._components=r}_bindEvents(){const{_root:e,options:t}=this,n=[ot(e.interaction.clear,"click",(()=>this._clearColor())),ot([e.interaction.cancel,e.preview.lastColor],"click",(()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")})),ot(e.interaction.save,"click",(()=>{!this.applyColor()&&!t.showAlways&&this.hide()})),ot(e.interaction.result,["keyup","input"],(e=>{"Enter"===e.key&&(this.setColor(e.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),e.stopImmediatePropagation())})),ot(e.interaction.result,["focus","blur"],(t=>{""!==e.interaction.result.value&&(this._recalc="blur"===t.type,this._recalc&&this._updateOutput(null))})),ot([e.palette.palette,e.palette.picker,e.hue.slider,e.hue.picker,e.opacity.slider,e.opacity.picker],["mousedown","touchstart"],(()=>this._recalc=!0),{passive:!0})];if(!t.showAlways){const s=t.closeWithKey;n.push(ot(e.button,"click",(()=>this.isOpen()?this.hide():this.show())),ot(document,"keyup",(e=>this.isOpen()&&(e.key===s||e.code===s)&&this.hide())),ot(document,["touchstart","mousedown"],(t=>{this.isOpen()&&!at(t).some((t=>t===e.app||t===e.button))&&this.hide()}),{capture:!0}))}if(t.adjustableNumbers){const t={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};dt(e.interaction.result,((e,n,s)=>{const o=t[this.getColorRepresentation().toLowerCase()];if(o){const t=o[s],i=e+(t>=100?1e3*n:n);return i<=0?0:Number((i<t?i:t).toPrecision(3))}return e}))}if(t.autoReposition&&!t.inline){let e=null;const s=this;n.push(ot(window,["scroll","resize"],(()=>{s.isOpen()&&(t.closeOnScroll&&s.hide(),null===e?(e=setTimeout((()=>e=null),100),requestAnimationFrame((function t(){s._rePositioningPicker(),null!==e&&requestAnimationFrame(t)}))):(clearTimeout(e),e=setTimeout((()=>e=null),100)))}),{capture:!0}))}this._eventBindings=n}_rePositioningPicker(){const{options:e}=this;if(!e.inline){if(!this._nanopop.update({container:document.body.getBoundingClientRect(),position:e.position})){const e=this._root.app,t=e.getBoundingClientRect();e.style.top=(window.innerHeight-t.height)/2+"px",e.style.left=(window.innerWidth-t.width)/2+"px"}}}_updateOutput(e){const{_root:t,_color:n,options:s}=this;if(t.interaction.type()){const e=`to${t.interaction.type().getAttribute("data-type")}`;t.interaction.result.value="function"==typeof n[e]?n[e]().toString(s.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",n,e,this)}_clearColor(e=!1){const{_root:t,options:n}=this;n.useAsButton||t.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),t.button.classList.add("clear"),n.showAlways||this.hide(),this._lastColor=null,this._initializingActive||e||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(e){const{values:t,type:n,a:s}=xt(e),{lockOpacity:o}=this.options,i=void 0!==s&&1!==s;return t&&3===t.length&&(t[3]=void 0),{values:!t||o&&i?null:t,type:n}}_t(e){return this.options.i18n[e]||At.I18N_DEFAULTS[e]}_emit(e,...t){this._eventListener[e].forEach((e=>e(...t,this)))}on(e,t){return this._eventListener[e].push(t),this}off(e,t){const n=this._eventListener[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this}addSwatch(e){const{values:t}=this._parseLocalColor(e);if(t){const{_swatchColors:e,_root:n}=this,s=Ct(...t),o=rt(`<button type="button" style="--pcr-color: ${s.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return n.swatches.appendChild(o),e.push({el:o,color:s}),this._eventBindings.push(ot(o,"click",(()=>{this.setHSVA(...s.toHSVA(),!0),this._emit("swatchselect",s),this._emit("change",s,"swatch",this)}))),!0}return!1}removeSwatch(e){const t=this._swatchColors[e];if(t){const{el:n}=t;return this._root.swatches.removeChild(n),this._swatchColors.splice(e,1),!0}return!1}applyColor(e=!1){const{preview:t,button:n}=this._root,s=this._color.toRGBA().toString(0);return t.lastColor.style.setProperty("--pcr-color",s),this.options.useAsButton||n.style.setProperty("--pcr-color",s),n.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||e||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach((e=>it(...e))),Object.keys(this._components).forEach((e=>this._components[e].destroy()))}destroyAndRemove(){this.destroy();const{root:e,app:t}=this._root;e.parentElement&&e.parentElement.removeChild(e),t.parentElement.removeChild(t),Object.keys(this).forEach((e=>this[e]=null))}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(e=360,t=0,n=0,s=1,o=!1){const i=this._recalc;if(this._recalc=!1,e<0||e>360||t<0||t>100||n<0||n>100||s<0||s>1)return!1;this._color=Ct(e,t,n,s);const{hue:r,opacity:l,palette:a}=this._components;return r.update(e/360),l.update(s),a.update(t/100,1-n/100),o||this.applyColor(),i&&this._updateOutput(),this._recalc=i,!0}setColor(e,t=!1){if(null===e)return this._clearColor(t),!0;const{values:n,type:s}=this._parseLocalColor(e);if(n){const e=s.toUpperCase(),{options:o}=this._root.interaction,i=o.find((t=>t.getAttribute("data-type")===e));if(i&&!i.hidden)for(const e of o)e.classList[e===i?"add":"remove"]("active");return!!this.setHSVA(...n,t)&&this.setColorRepresentation(e)}return!1}setColorRepresentation(e){return e=e.toUpperCase(),!!this._root.interaction.options.find((t=>t.getAttribute("data-type").startsWith(e)&&!t.click()))}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}}class Lt{constructor(e={},t){this.builder=t,this.opts=Object.assign(this,{onPick:function(){},color:"",colors:["#ff9f01","#f57c00","#e64918","#d32f2f","#5d4038","#37474f","#353535","#fbc02c","#b0b42a","#689f39","#c21f5b","#7b21a2","#522da8","#616161","#01b8c9","#009688","#388d3c","#0388d0","#1465c0","#2f3f9e","#9e9e9e"],renderOn:"",animateModal:!1,elementToAnimate:"",stuffPlacement:"#_cbhtml",lang:[]},e);let n=document.querySelector(this.opts.stuffPlacement);n||(n=document.createElement("div"),n.id="_cbhtml",n.className="is-ui",document.body.appendChild(n)),this.builderStuff=n,n.insertAdjacentHTML("beforeend",'\n        <div class="is-pop pop-picker" style="z-index:10003;" tabindex="-1" role="dialog" aria-modal="true" aria-hidden="true">\n        \n            <input type="text" class="_pop-colpick" />\n            <div class="_pop-colpick_container"></div>\n        </div>\n        ');const s=n.querySelector(".pop-picker");s.style.display="flex",s.style.opacity=0,this.opts.colors.length<=21?s.style.height="360px":this.opts.colors.length>21&&this.opts.colors.length<=28?s.style.height="390px":this.opts.colors.length>28&&(s.style.height="420px");const o=At.create({el:"._pop-colpick",theme:"nano",container:"._pop-colpick_container",showAlways:!0,swatches:this.opts.colors,useAsButton:!0,defaultRepresentation:"RGBA",components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!1,rgba:!1,hsla:!1,hsva:!1,cmyk:!1,input:!0,clear:!0,save:!1}},i18n:{"btn:clear":this.out("Clear"),"aria:btn:clear":this.out("Clear")}});o.on("change",(e=>{if("flex"!==s.style.display)return;let t=e.toRGBA().toString(0);this.noCallback||this.opts.onPick(t),this.noCallback=!1})).on("clear",(()=>{this.opts.onPick(""),s.querySelector(".pcr-result").value=""})),this.pickr=o,setTimeout((()=>{s.style.display="",s.style.opacity=""}),1)}makeId(){let e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let n=0;n<2;n++)e+=t.charAt(Math.floor(52*Math.random()));let n="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let e=0;e<5;e++)n+=s.charAt(Math.floor(62*Math.random()));return e+n}out(e){if(this.opts.lang){let t=this.opts.lang[e];return t||e}return e}open(e,t,n,s,o=!1){if(!s){const e=document.getElementsByTagName("iframe");for(let t=0;t<e.length;t++)try{let n=e[t].contentDocument.activeElement;"body"!==n.tagName.toLocaleLowerCase()&&(s=n)}catch(e){}s||(s=document.activeElement)}let i=document.querySelector(".pop-picker");this.builder.showPop(i,!1,s,o);const r=i.offsetWidth,l=i.offsetHeight,a=this.getElementPosition(s);let c=a.top,d=a.left,h=0,u=2;s.closest(".is-controlpanel")&&(h=5,u=7);const p=window.innerWidth,m=window.innerHeight;m-(c+u+s.offsetHeight)>l?i.style.top=c+u+s.offsetHeight+window.pageYOffset+"px":(i.style.top=c-u-l-4+window.pageYOffset+"px",c<l&&(i.style.top=(m-l)/2+window.pageYOffset+"px")),i.style.left=p-d>r?d-h+"px":d+h-r+s.offsetWidth+"px";const g=this.findParentIframeOfActiveElement(s);if(g){let e=parseInt(window.getComputedStyle(g,null).getPropertyValue("border-top-width"));isNaN(e)&&(e=0);const t=this.getElementPosition(g);c+=t.top,d+=t.left,m-(c+u+s.offsetHeight+e)>l?i.style.top=c+u+s.offsetHeight+e+window.pageYOffset+"px":i.style.top=c-u-l+e+window.pageYOffset+"px",i.style.left=p-d>r?d+"px":d-r+s.offsetWidth+"px";const n=g.contentDocument,o=e=>{if(!i.contains(e.target)&&!s.contains(e.target)){if(e.target.classList.contains("is-btn-color")&&s.classList.contains("is-btn-color")&&e.target!==s)return;this.builder.util.hidePop(i),n.removeEventListener("click",o)}};n.addEventListener("click",o)}if(e&&(this.opts.onPick=e),"transparent"===t||""===t){this.setColor("",!0);document.querySelector(".pop-picker").querySelector(".pcr-result").value=""}else this.opts.color=t,this.setColor(t,!0);this.noCallback=!1}openByTab(e){if("transparent"===e||""===e){this.pickrRte.setColor(""),document.querySelector(this.opts.renderOn).querySelector(".pcr-result").value=""}else this.opts.color=e,this.pickrRte.setColor(e)}setColorRte(e){this.pickrRte.setColor(e)}setColor(e,t){t&&(this.noCallback=!0),this.pickr.setColor(e)}getElementPosition(e){return{top:e.getBoundingClientRect().top,left:e.getBoundingClientRect().left}}findParentIframeOfActiveElement(e){const t=document.getElementsByTagName("iframe");for(let n=0;n<t.length;n++)try{if(t[n].contentDocument===e.ownerDocument)return t[n]}catch(e){}return null}}class Mt{constructor(e,t={}){this.settings=Object.assign({},{ariaLabel:"Editable content",placeholderText:'Press "/" to insert a reference.',tags:[{title:"Insert tag1",name:"tag1"},{title:"Insert tag2",name:"tag2"},{title:"Insert tag3",name:"tag3"}],value:""},t),this.element=e,this.init()}getValue(){return this.editor.innerHTML}init(){const e=this.element,t=document.createElement("div");t.className="editor-wrapper",e.appendChild(t);const n=document.createElement("div");n.className="prompt-editor",n.setAttribute("contenteditable",!0),n.setAttribute("role","textbox"),n.setAttribute("ria-multiline",!0),n.setAttribute("aria-label",this.settings.ariaLabel),t.appendChild(n),this.editor=n;let s=this.settings.value;n.innerHTML=s;const o=document.createElement("div");o.className="placeholder-text",o.innerText=this.settings.placeholderText,t.appendChild(o);const i=document.createElement("div");i.className="tag-selector",i.setAttribute("role","listbox"),i.setAttribute("aria-hidden",!0),e.appendChild(i);const r=()=>{i.innerHTML="",this.settings.tags.forEach((e=>{const t=document.createElement("button");t.setAttribute("role","option"),t.setAttribute("tabindex","-1"),t.setAttribute("data-tag",e.name),t.innerText=e.title,i.appendChild(t)}));let t=Array.from(e.querySelectorAll("button"));t.forEach((e=>{e.addEventListener("click",(()=>{h(e.dataset.tag)})),e.addEventListener("mouseover",(()=>{t.forEach((e=>e.classList.remove("selected"))),e.classList.add("selected")}))}))};r(),this.renderDropdown=r;let l=!1;this.handleNavigateDrodown=t=>{let n=Array.from(e.querySelectorAll("button"));if(l){const s=n.indexOf(e.querySelector(".tag-selector button.selected"));if("ArrowDown"===t.key){const e=(s+1)%n.length;n[s].classList.remove("selected"),n[e].classList.add("selected"),t.preventDefault()}else if("ArrowUp"===t.key){const e=(s-1+n.length)%n.length;n[s].classList.remove("selected"),n[e].classList.add("selected"),t.preventDefault()}else"Enter"===t.key||" "===t.key?(e.querySelector(".tag-selector button.selected").click(),t.preventDefault()):"Escape"===t.key&&(a(!1),t.preventDefault())}};const a=t=>{if(l=t,i.setAttribute("aria-hidden",!t),t){let t=Array.from(e.querySelectorAll("button"));t.forEach((e=>e.classList.remove("selected"))),t[0].classList.add("selected"),d(),document.addEventListener("keydown",this.handleNavigateDrodown),document.addEventListener("click",c)}else document.removeEventListener("click",c),document.removeEventListener("keydown",this.handleNavigateDrodown)},c=e=>{i.contains(e.target)||a(!1)},d=()=>{const e=window.getSelection().getRangeAt(0).getBoundingClientRect();i.style.left=`${e.left+window.scrollX}px`,i.style.top=`${e.bottom+window.scrollY}px`},h=e=>{let t=window.getSelection(),s=t.getRangeAt(0);const o=document.createElement("span");if(o.textContent=e,o.setAttribute("contentEditable",!1),o.setAttribute("data-name",e),o.className="tag",s.collapsed){const e=s.startOffset,t=s.startContainer;t.nodeType===Node.TEXT_NODE&&e>0&&t.deleteData(e-1,1)}s.deleteContents(),s.insertNode(o),s.setStartAfter(o),s.setEndAfter(o),t.removeAllRanges(),t.addRange(s),a(!1),n.focus();let i=n.innerHTML;this.settings.onChange&&this.settings.onChange(i)};let u;function p(){""===n.innerText.trim()?o.classList.remove("hidden"):o.classList.add("hidden")}n.addEventListener("input",(()=>{const e=window.getSelection();if(!e.rangeCount)return;const t=e.getRangeAt(0);t.startContainer.textContent.slice(0,t.startOffset).endsWith("/")?a(!0):a(!1),clearTimeout(u),u=setTimeout((()=>{let e=n.innerHTML;this.settings.onChange&&this.settings.onChange(e)}),300)})),n.addEventListener("paste",(e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");if(document.queryCommandSupported("insertText"))document.execCommand("insertText",!1,t);else{const e=window.getSelection(),n=e.getRangeAt(0),s=document.createTextNode(t);n.deleteContents(),n.insertNode(s),n.setStartAfter(s),n.setEndAfter(s),e.removeAllRanges(),e.addRange(n)}})),n.addEventListener("keydown",(e=>{!e.metaKey&&!e.ctrlKey||"b"!==e.key&&"i"!==e.key&&"u"!==e.key||e.preventDefault()})),n.addEventListener("keydown",(e=>{"Escape"===e.key&&l&&(a(!1),e.preventDefault())})),i.addEventListener("keydown",(e=>{"ArrowDown"===e.key||"ArrowUp"===e.key||("Enter"===e.key||" "===e.key?(document.activeElement.click(),e.preventDefault()):"Escape"===e.key&&(a(!1),e.preventDefault())),(e.metaKey||e.ctrlKey)&&(a(!1),e.preventDefault())})),n.addEventListener("input",(()=>{p()})),p()}}function qt(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Nt={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function Pt(e){Nt=e}const Rt={exec:()=>null};function Dt(e,t=""){let n="string"==typeof e?e:e.source;const s={replace:(e,t)=>{let o="string"==typeof t?t:t.source;return o=o.replace(zt.caret,"$1"),n=n.replace(e,o),s},getRegex:()=>new RegExp(n,t)};return s}const zt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Ot=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ht=/(?:[*+-]|\d{1,9}[.)])/,Bt=Dt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Ht).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),It=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,jt=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Ft=Dt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",jt).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Ut=Dt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ht).getRegex(),Yt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Wt=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Vt=Dt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",Wt).replace("tag",Yt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Xt=Dt(It).replace("hr",Ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Yt).getRegex(),Gt={blockquote:Dt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Xt).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:Ft,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:Ot,html:Vt,lheading:Bt,list:Ut,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:Xt,table:Rt,text:/^[^\n]+/},Zt=Dt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Yt).getRegex(),Jt={...Gt,table:Zt,paragraph:Dt(It).replace("hr",Ot).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Zt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Yt).getRegex()},Kt={...Gt,html:Dt("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Wt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Rt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Dt(It).replace("hr",Ot).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Bt).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Qt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,en=/^( {2,}|\\)\n(?!\s*$)/,tn=/[\p{P}\p{S}]/u,nn=/[\s\p{P}\p{S}]/u,sn=/[^\s\p{P}\p{S}]/u,on=Dt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,nn).getRegex(),rn=Dt(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,tn).getRegex(),ln=Dt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)","gu").replace(/notPunctSpace/g,sn).replace(/punctSpace/g,nn).replace(/punct/g,tn).getRegex(),an=Dt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,sn).replace(/punctSpace/g,nn).replace(/punct/g,tn).getRegex(),cn=Dt(/\\(punct)/,"gu").replace(/punct/g,tn).getRegex(),dn=Dt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),hn=Dt(Wt).replace("(?:--\x3e|$)","--\x3e").getRegex(),un=Dt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",hn).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),pn=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,mn=Dt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",pn).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),gn=Dt(/^!?\[(label)\]\[(ref)\]/).replace("label",pn).replace("ref",jt).getRegex(),fn=Dt(/^!?\[(ref)\](?:\[\])?/).replace("ref",jt).getRegex(),bn={_backpedal:Rt,anyPunctuation:cn,autolink:dn,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:en,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:Rt,emStrongLDelim:rn,emStrongRDelimAst:ln,emStrongRDelimUnd:an,escape:Qt,link:mn,nolink:fn,punctuation:on,reflink:gn,reflinkSearch:Dt("reflink|nolink(?!\\()","g").replace("reflink",gn).replace("nolink",fn).getRegex(),tag:un,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:Rt},vn={...bn,link:Dt(/^!?\[(label)\]\((.*?)\)/).replace("label",pn).getRegex(),reflink:Dt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pn).getRegex()},wn={...bn,escape:Dt(Qt).replace("])","~|])").getRegex(),url:Dt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},yn={...wn,br:Dt(en).replace("{2,}","*").getRegex(),text:Dt(wn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},kn={normal:Gt,gfm:Jt,pedantic:Kt},xn={normal:bn,gfm:wn,breaks:yn,pedantic:vn},Cn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},En=e=>Cn[e];function _n(e,t){if(t){if(zt.escapeTest.test(e))return e.replace(zt.escapeReplace,En)}else if(zt.escapeTestNoEncode.test(e))return e.replace(zt.escapeReplaceNoEncode,En);return e}function Sn(e){try{e=encodeURI(e).replace(zt.percentDecode,"%")}catch{return null}return e}function Tn(e,t){const n=e.replace(zt.findPipe,((e,t,n)=>{let s=!1,o=t;for(;--o>=0&&"\\"===n[o];)s=!s;return s?"|":" |"})).split(zt.splitPipe);let s=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(zt.slashPipe,"|");return n}function $n(e,t,n){const s=e.length;if(0===s)return"";let o=0;for(;o<s;){const i=e.charAt(s-o-1);if(i!==t||n){if(i===t||!n)break;o++}else o++}return e.slice(0,s-o)}function An(e,t,n,s,o){const i=t.href,r=t.title||null,l=e[1].replace(o.other.outputLinkReplace,"$1");if("!"!==e[0].charAt(0)){s.state.inLink=!0;const e={type:"link",raw:n,href:i,title:r,text:l,tokens:s.inlineTokens(l)};return s.state.inLink=!1,e}return{type:"image",raw:n,href:i,title:r,text:l}}class Ln{options;rules;lexer;constructor(e){this.options=e||Nt}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:$n(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t,n){const s=e.match(n.other.indentCodeCompensation);if(null===s)return t;const o=s[1];return t.split("\n").map((e=>{const t=e.match(n.other.beginningSpace);if(null===t)return e;const[s]=t;return s.length>=o.length?e.slice(o.length):e})).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=$n(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:$n(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=$n(t[0],"\n").split("\n"),n="",s="";const o=[];for(;e.length>0;){let t=!1;const i=[];let r;for(r=0;r<e.length;r++)if(this.rules.other.blockquoteStart.test(e[r]))i.push(e[r]),t=!0;else{if(t)break;i.push(e[r])}e=e.slice(r);const l=i.join("\n"),a=l.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${l}`:l,s=s?`${s}\n${a}`:a;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(a,o,!0),this.lexer.state.top=c,0===e.length)break;const d=o.at(-1);if("code"===d?.type)break;if("blockquote"===d?.type){const t=d,i=t.raw+"\n"+e.join("\n"),r=this.blockquote(i);o[o.length-1]=r,n=n.substring(0,n.length-t.raw.length)+r.raw,s=s.substring(0,s.length-t.text.length)+r.text;break}if("list"!==d?.type);else{const t=d,i=t.raw+"\n"+e.join("\n"),r=this.list(i);o[o.length-1]=r,n=n.substring(0,n.length-d.raw.length)+r.raw,s=s.substring(0,s.length-t.raw.length)+r.raw,e=i.substring(o.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:n,tokens:o,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const s=n.length>1,o={type:"list",raw:"",ordered:s,start:s?+n.slice(0,-1):"",loose:!1,items:[]};n=s?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=s?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let r=!1;for(;e;){let n=!1,s="",l="";if(!(t=i.exec(e)))break;if(this.rules.block.hr.test(e))break;s=t[0],e=e.substring(s.length);let a=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),c=e.split("\n",1)[0],d=!a.trim(),h=0;if(this.options.pedantic?(h=2,l=a.trimStart()):d?h=t[1].length+1:(h=t[2].search(this.rules.other.nonSpaceChar),h=h>4?1:h,l=a.slice(h),h+=t[1].length),d&&this.rules.other.blankLine.test(c)&&(s+=c+"\n",e=e.substring(c.length+1),n=!0),!n){const t=this.rules.other.nextBulletRegex(h),n=this.rules.other.hrRegex(h),o=this.rules.other.fencesBeginRegex(h),i=this.rules.other.headingBeginRegex(h),r=this.rules.other.htmlBeginRegex(h);for(;e;){const u=e.split("\n",1)[0];let p;if(c=u,this.options.pedantic?(c=c.replace(this.rules.other.listReplaceNesting,"  "),p=c):p=c.replace(this.rules.other.tabCharGlobal,"    "),o.test(c))break;if(i.test(c))break;if(r.test(c))break;if(t.test(c))break;if(n.test(c))break;if(p.search(this.rules.other.nonSpaceChar)>=h||!c.trim())l+="\n"+p.slice(h);else{if(d)break;if(a.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(o.test(a))break;if(i.test(a))break;if(n.test(a))break;l+="\n"+c}d||c.trim()||(d=!0),s+=u+"\n",e=e.substring(u.length+1),a=p.slice(h)}}o.loose||(r?o.loose=!0:this.rules.other.doubleBlankLine.test(s)&&(r=!0));let u,p=null;this.options.gfm&&(p=this.rules.other.listIsTask.exec(l),p&&(u="[ ] "!==p[0],l=l.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:s,task:!!p,checked:u,loose:!1,text:l,tokens:[]}),o.raw+=s}const l=o.items.at(-1);l&&(l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd()),o.raw=o.raw.trimEnd();for(let e=0;e<o.items.length;e++)if(this.lexer.state.top=!1,o.items[e].tokens=this.lexer.blockTokens(o.items[e].text,[]),!o.loose){const t=o.items[e].tokens.filter((e=>"space"===e.type)),n=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));o.loose=n}if(o.loose)for(let e=0;e<o.items.length;e++)o.items[e].loose=!0;return o}}html(e){const t=this.rules.block.html.exec(e);if(t){return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const n=Tn(t[1]),s=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===s.length){for(const e of s)this.rules.other.tableAlignRight.test(e)?i.align.push("right"):this.rules.other.tableAlignCenter.test(e)?i.align.push("center"):this.rules.other.tableAlignLeft.test(e)?i.align.push("left"):i.align.push(null);for(let e=0;e<n.length;e++)i.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:i.align[e]});for(const e of o)i.rows.push(Tn(e,i.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:i.align[t]}))));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=$n(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let s=0;s<e.length;s++)if("\\"===e[s])s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],s="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],s=e[3])}else s=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),An(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return An(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s)return;if(s[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(s[1]||s[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const n=[...s[0]].length-1;let o,i,r=n,l=0;const a="*"===s[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(a.lastIndex=0,t=t.slice(-1*e.length+n);null!=(s=a.exec(t));){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(i=[...o].length,s[3]||s[4]){r+=i;continue}if((s[5]||s[6])&&n%3&&!((n+i)%3)){l+=i;continue}if(r-=i,r>0)continue;i=Math.min(i,i+r+l);const t=[...s[0]][0].length,a=e.slice(0,n+s.index+t+i);if(Math.min(n,i)%2){const e=a.slice(1,-1);return{type:"em",raw:a,text:e,tokens:this.lexer.inlineTokens(e)}}const c=a.slice(2,-2);return{type:"strong",raw:a,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(e),s=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&s&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let s;do{s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(s!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}}class Mn{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Nt,this.options.tokenizer=this.options.tokenizer||new Ln,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:zt,block:kn.normal,inline:xn.normal};this.options.pedantic?(t.block=kn.pedantic,t.inline=xn.pedantic):this.options.gfm&&(t.block=kn.gfm,this.options.breaks?t.inline=xn.breaks:t.inline=xn.gfm),this.tokenizer.rules=t}static get rules(){return{block:kn,inline:xn}}static lex(e,t){return new Mn(t).lex(e)}static lexInline(e,t){return new Mn(t).inlineTokens(e)}lex(e){e=e.replace(zt.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(zt.tabCharGlobal,"    ").replace(zt.spaceLine,""));e;){let s;if(this.options.extensions?.block?.some((n=>!!(s=n.call({lexer:this},e,t))&&(e=e.substring(s.raw.length),t.push(s),!0))))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const n=t.at(-1);1===s.raw.length&&void 0!==n?n.raw+="\n":t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+s.raw,n.text+="\n"+s.text,this.inlineQueue.at(-1).src=n.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+s.raw,n.text+="\n"+s.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let o=e;if(this.options.extensions?.startBlock){let t=1/0;const n=e.slice(1);let s;this.options.extensions.startBlock.forEach((e=>{s=e.call({lexer:this},n),"number"==typeof s&&s>=0&&(t=Math.min(t,s))})),t<1/0&&t>=0&&(o=e.substring(0,t+1))}if(this.state.top&&(s=this.tokenizer.paragraph(o))){const i=t.at(-1);n&&"paragraph"===i?.type?(i.raw+="\n"+s.raw,i.text+="\n"+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):t.push(s),n=o.length!==e.length,e=e.substring(s.raw.length)}else if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const n=t.at(-1);"text"===n?.type?(n.raw+="\n"+s.raw,n.text+="\n"+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(s)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,s=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(n));)e.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(n));)n=n.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.anyPunctuation.exec(n));)n=n.slice(0,s.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o=!1,i="";for(;e;){let s;if(o||(i=""),o=!1,this.options.extensions?.inline?.some((n=>!!(s=n.call({lexer:this},e,t))&&(e=e.substring(s.raw.length),t.push(s),!0))))continue;if(s=this.tokenizer.escape(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.tag(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.link(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(s.raw.length);const n=t.at(-1);"text"===s.type&&"text"===n?.type?(n.raw+=s.raw,n.text+=s.text):t.push(s);continue}if(s=this.tokenizer.emStrong(e,n,i)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.codespan(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.br(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.del(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.autolink(e)){e=e.substring(s.raw.length),t.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(e))){e=e.substring(s.raw.length),t.push(s);continue}let r=e;if(this.options.extensions?.startInline){let t=1/0;const n=e.slice(1);let s;this.options.extensions.startInline.forEach((e=>{s=e.call({lexer:this},n),"number"==typeof s&&s>=0&&(t=Math.min(t,s))})),t<1/0&&t>=0&&(r=e.substring(0,t+1))}if(s=this.tokenizer.inlineText(r)){e=e.substring(s.raw.length),"_"!==s.raw.slice(-1)&&(i=s.raw.slice(-1)),o=!0;const n=t.at(-1);"text"===n?.type?(n.raw+=s.raw,n.text+=s.text):t.push(s)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}}class qn{options;parser;constructor(e){this.options=e||Nt}space(e){return""}code({text:e,lang:t,escaped:n}){const s=(t||"").match(zt.notSpaceStart)?.[0],o=e.replace(zt.endingNewline,"")+"\n";return s?'<pre><code class="language-'+_n(s)+'">'+(n?o:_n(o,!0))+"</code></pre>\n":"<pre><code>"+(n?o:_n(o,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,n=e.start;let s="";for(let t=0;t<e.items.length;t++){const n=e.items[t];s+=this.listitem(n)}const o=t?"ol":"ul";return"<"+o+(t&&1!==n?' start="'+n+'"':"")+">\n"+s+"</"+o+">\n"}listitem(e){let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+_n(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let s="";for(let t=0;t<e.rows.length;t++){const o=e.rows[t];n="";for(let e=0;e<o.length;e++)n+=this.tablecell(o[e]);s+=this.tablerow({text:n})}return s&&(s=`<tbody>${s}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+s+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${_n(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const s=this.parser.parseInline(n),o=Sn(e);if(null===o)return s;let i='<a href="'+(e=o)+'"';return t&&(i+=' title="'+_n(t)+'"'),i+=">"+s+"</a>",i}image({href:e,title:t,text:n}){const s=Sn(e);if(null===s)return _n(n);let o=`<img src="${e=s}" alt="${n}"`;return t&&(o+=` title="${_n(t)}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:_n(e.text)}}class Nn{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Pn{options;renderer;textRenderer;constructor(e){this.options=e||Nt,this.options.renderer=this.options.renderer||new qn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Nn}static parse(e,t){return new Pn(t).parse(e)}static parseInline(e,t){return new Pn(t).parseInline(e)}parse(e,t=!0){let n="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions?.renderers?.[o.type]){const e=o,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}const i=o;switch(i.type){case"space":n+=this.renderer.space(i);continue;case"hr":n+=this.renderer.hr(i);continue;case"heading":n+=this.renderer.heading(i);continue;case"code":n+=this.renderer.code(i);continue;case"table":n+=this.renderer.table(i);continue;case"blockquote":n+=this.renderer.blockquote(i);continue;case"list":n+=this.renderer.list(i);continue;case"html":n+=this.renderer.html(i);continue;case"paragraph":n+=this.renderer.paragraph(i);continue;case"text":{let o=i,r=this.renderer.text(o);for(;s+1<e.length&&"text"===e[s+1].type;)o=e[++s],r+="\n"+this.renderer.text(o);n+=t?this.renderer.paragraph({type:"paragraph",raw:r,text:r,tokens:[{type:"text",raw:r,text:r,escaped:!0}]}):r;continue}default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t=this.renderer){let n="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions?.renderers?.[o.type]){const e=this.options.extensions.renderers[o.type].call({parser:this},o);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){n+=e||"";continue}}const i=o;switch(i.type){case"escape":case"text":n+=t.text(i);break;case"html":n+=t.html(i);break;case"link":n+=t.link(i);break;case"image":n+=t.image(i);break;case"strong":n+=t.strong(i);break;case"em":n+=t.em(i);break;case"codespan":n+=t.codespan(i);break;case"br":n+=t.br(i);break;case"del":n+=t.del(i);break;default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class Rn{options;block;constructor(e){this.options=e||Nt}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Mn.lex:Mn.lexInline}provideParser(){return this.block?Pn.parse:Pn.parseInline}}const Dn=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Pn;Renderer=qn;TextRenderer=Nn;Lexer=Mn;Tokenizer=Ln;Hooks=Rn;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const s of e)switch(n=n.concat(t.call(this,s)),s.type){case"table":{const e=s;for(const s of e.header)n=n.concat(this.walkTokens(s.tokens,t));for(const s of e.rows)for(const e of s)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=s;n=n.concat(this.walkTokens(e.items,t));break}default:{const e=s;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((s=>{const o=e[s].flat(1/0);n=n.concat(this.walkTokens(o,t))})):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let s=e.renderer.apply(this,t);return!1===s&&(s=n.apply(this,t)),s}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer){const t=this.defaults.renderer||new qn(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const s=n,o=e.renderer[s],i=t[s];t[s]=(...e)=>{let n=o.apply(t,e);return!1===n&&(n=i.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new Ln(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const s=n,o=e.tokenizer[s],i=t[s];t[s]=(...e)=>{let n=o.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new Rn;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;const s=n,o=e.hooks[s],i=t[s];Rn.passThroughHooks.has(n)?t[s]=e=>{if(this.defaults.async)return Promise.resolve(o.call(t,e)).then((e=>i.call(t,e)));const n=o.call(t,e);return i.call(t,n)}:t[s]=(...e)=>{let n=o.apply(t,e);return!1===n&&(n=i.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,s=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(s.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Mn.lex(e,t??this.defaults)}parser(e,t){return Pn.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{const s={...n},o={...this.defaults,...s},i=this.onError(!!o.silent,!!o.async);if(!0===this.defaults.async&&!1===s.async)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return i(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=e);const r=o.hooks?o.hooks.provideLexer():e?Mn.lex:Mn.lexInline,l=o.hooks?o.hooks.provideParser():e?Pn.parse:Pn.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(t):t).then((e=>r(e,o))).then((e=>o.hooks?o.hooks.processAllTokens(e):e)).then((e=>o.walkTokens?Promise.all(this.walkTokens(e,o.walkTokens)).then((()=>e)):e)).then((e=>l(e,o))).then((e=>o.hooks?o.hooks.postprocess(e):e)).catch(i);try{o.hooks&&(t=o.hooks.preprocess(t));let e=r(t,o);o.hooks&&(e=o.hooks.processAllTokens(e)),o.walkTokens&&this.walkTokens(e,o.walkTokens);let n=l(e,o);return o.hooks&&(n=o.hooks.postprocess(n)),n}catch(e){return i(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+_n(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function zn(e,t){return Dn.parse(e,t)}zn.options=zn.setOptions=function(e){return Dn.setOptions(e),zn.defaults=Dn.defaults,Pt(zn.defaults),zn},zn.getDefaults=qt,zn.defaults=Nt,zn.use=function(...e){return Dn.use(...e),zn.defaults=Dn.defaults,Pt(zn.defaults),zn},zn.walkTokens=function(e,t){return Dn.walkTokens(e,t)},zn.parseInline=Dn.parseInline,zn.Parser=Pn,zn.parser=Pn.parse,zn.Renderer=qn,zn.TextRenderer=Nn,zn.Lexer=Mn,zn.lexer=Mn.lex,zn.Tokenizer=Ln,zn.Hooks=Rn,zn.parse=zn,zn.options,zn.setOptions,zn.use,zn.walkTokens,zn.parseInline,Pn.parse,Mn.lex;return class{constructor(e={}){this.settings=Object.assign({},{lang:[],fieldTypes:["short-text","long-text","number","switch","select","multi-select","dropdown","file","date","datetime","time","phone","email","url","color","hidden"],fileUploadText:"Drag and drop your file here, or click to select.",model:"gpt-4o-mini",language:"English",languageSelection:!1,sendCommandUrl:"/sendcommand",consoleLog:!1,demo:!0,colors:["#ff9f01","#f57c00","#e64918","#d32f2f","#5d4038","#37474f","#353535","#fbc02c","#b0b42a","#689f39","#c21f5b","#7b21a2","#522da8","#616161","#01b8c9","#009688","#388d3c","#0388d0","#1465c0","#2f3f9e","#9e9e9e"],useSubmitButton:!0,submitText:"Submit",scrapeLimit:3,scrapeExclude:["youtube.com","reddit.com"]},e),window._txt&&(this.settings.lang=window._txt),this.steps=[];let t=this.settings.onChange;this.settings.onChange=e=>{t&&t.call(this,e),this.view(e)},this.colorPicker=new Lt({lang:this.settings.lang,colors:this.settings.colors},this),this.element=this.settings.builderElement,this.element&&this.element.classList.add("fb-ui"),this.popupVisible=!1}renderCheckbox({parentNode:e,name:t,className:n,value:s,text:o}){if(!e)return;if(!o)return;let i=this.getId();const r=document.createElement("label");r.setAttribute("for",`${i}`),r.className="input-checkbox",e.appendChild(r);const l=document.createElement("input");l.type="checkbox",l.className="peer",n&&l.classList.add(n),l.id=`${i}`,t&&(l.name=t),s&&(l.value=s),r.appendChild(l);const a=document.createElement("span");a.className="peer-span-square",r.appendChild(a);a.innerHTML='<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="4"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" />\n        </svg>';const c=document.createElement("span");return c.innerText=this.out(o),r.appendChild(c),l}initializeEventListeners(e){const t=e.querySelector(".btn-addfield"),n=e.querySelector(".popup-fields"),s=e.querySelector(".fields-container"),o=n.querySelectorAll(".btn-selectfield");let i;e.querySelectorAll('[contentEditable="true"]').forEach((e=>{e.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text");document.execCommand("insertText",!1,t)}))})),e.querySelectorAll('[contentEditable="true"]').forEach((e=>{e.addEventListener("keyup",(t=>{if(t.key&&["Control","Meta","Alt","Shift","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Escape","CapsLock","Tab","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(t.key))return;if(t.ctrlKey||t.metaKey||t.altKey)return;const n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)})),e.addEventListener("input",(()=>{clearTimeout(i),i=setTimeout((()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)}))})),new De(s,{animation:150,handle:".handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",onEnd:()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}});const r=()=>{const e=t.getBoundingClientRect(),s=n.offsetHeight,o=window.innerHeight,i=window.scrollY;e.bottom+s>o?(n.style.top=e.top-s+i-17+"px",n.style.left=`${e.left}px`):(n.style.top=`${e.bottom+i}px`,n.style.left=`${e.left}px`)};window.addEventListener("resize",(()=>{this.popupVisible&&r()}));const l=()=>{n.classList.remove("hidden"),n.classList.add("block"),t.setAttribute("aria-expanded","true"),n.setAttribute("aria-hidden","false"),this.popupVisible=!0,r();const e=n.querySelector("button");e&&e.focus()},a=()=>{n.classList.remove("block"),n.classList.add("hidden"),t.setAttribute("aria-expanded","false"),n.setAttribute("aria-hidden","true"),this.popupVisible=!1},c=()=>{document.activeElement&&document.activeElement.blur(),this.popupVisible?a():l()},d=e=>{n.contains(e.target)||e.target===t||a()},h=e=>{"Escape"===e.key&&this.popupVisible&&a()},u=e=>{const t=e.target.closest("button").getAttribute("data-type");if(t){p(t);const e=this.get();this.settings.onChange&&this.settings.onChange(e),a()}},p=(e,t)=>{const n=document.createElement("div");n.className="field-item",n.setAttribute("data-type",e),n.setAttribute("data-name","");let o="",i="",r=this.out("Question..");switch(e){case"short-text":o=this.out("Short Text"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mt-1">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M4 6l16 0" />\n                        <path d="M4 12l10 0" />\n                    </svg>\n                ';break;case"long-text":o=this.out("Long Text"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />\n                    </svg>\n                ';break;case"number":o=this.out("Number"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7" stroke="currentColor" class="size-5" style="transform:scale(0.8)">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5-3.9 19.5m-2.1-19.5-3.9 19.5" />\n                    </svg>\n                ';break;case"select":o=this.out("Select"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M9 12l2 2l4 -4" />\n                    </svg>\n                ';break;case"multi-select":o=this.out("Multi Select"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path stroke="none" d="M0 0h24v24H0z" /><path d="M7 9.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2 2 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /><path d="M11 14l2 2l4 -4" />\n                    </svg>\n                ';break;case"switch":o=this.out("Switch"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M2 6m0 6a6 6 0 0 1 6 -6h8a6 6 0 0 1 6 6v0a6 6 0 0 1 -6 6h-8a6 6 0 0 1 -6 -6z" />\n                    </svg>\n                ';break;case"date":o=this.out("Date"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.1"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5" style="transform:scale(1.04)">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" />\n                    </svg>\n                ',r=this.out("Date");break;case"time":o=this.out("Time"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 1a1 1 0 0 1 1 -1h14a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-14a1 1 0 0 1 -1 -1z" /><path d="M12 7v5l3 3" /><path d="M4 12h1" /><path d="M19 12h1" /><path d="M12 19v1" />\n                    </svg>\n                ',r=this.out("Time");break;case"datetime":o=this.out("Datetime"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.1"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5" style="transform:scale(1.04)">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" /><path d="M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M15 3v4" /><path d="M7 3v4" /><path d="M3 11h16" /><path d="M18 16.496v1.504l1 1" />\n                    </svg>\n                ',r=this.out("Date & Time");break;case"color2":o=this.out("Color"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 3.34a10 10 0 1 1 -15 8.66l.005 -.324a10 10 0 0 1 14.995 -8.336m-9 1.732a8 8 0 0 0 4.001 14.928l-.001 -16a8 8 0 0 0 -4 1.072" />\n                    </svg>\n                ',r=this.out("Color");break;case"color":o=this.out("Color"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" /><path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />\n                    </svg>\n                ',r=this.out("Color");break;case"file":o=this.out("File Upload"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5" style="transform:scale(0.9)">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13" />\n                    </svg>\n                ',r=this.out("Attach File");break;case"dropdown":o=this.out("Dropdown"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" />\n                    </svg>\n                ';break;case"email":o=this.out("Email"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />\n                    </svg>\n                ',r=this.out("Email");break;case"phone":o=this.out("Phone"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" />\n                    </svg>\n                ',r=this.out("Phone");break;case"url":o=this.out("URL"),i='\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244" />\n                    </svg>\n                ',r=this.out("URL");break;case"hidden":o=this.out("Hidden"),i='\n                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 8m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" />\n                    </svg>\n                '}const l=t||r;n.innerHTML="switch"===e||"color"===e?`\n                    <div class="relative flex justify-between w-full">\n\n                        <span class="div-field-label">${o}</span>\n\n                        <div class="div-field-title flex items-center gap-4">\n                            ${i}\n                            <span class="inp-field-title" contentEditable="true">${l}</span>\n                        </div>\n\n                        <div class="flex items-center gap-2">\n                            <button class="btn-delfield" aria-label="${this.out("Delete field")}">\n                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                                    <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />\n                                </svg>\n                            </button>\n                            <div class="handle">\n                                <svg class="size-4 text-[#aaa]" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round">\n                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />\n                                </svg>\n                            </div>\n                        </div>\n                    </div>\n                `:`\n                    <div class="relative flex justify-between items-center w-full">\n\n                        <span class="div-field-label">${o}</span>\n\n                        <div class="div-field-title flex items-center gap-4">\n                            ${i}\n                            <span class="inp-field-title" contentEditable="true">${l}</span>\n                        </div>\n\n                        <div class="flex items-center gap-2">\n                            <button class="btn-toggle-settings" aria-label="${this.out("Toggle settings")}">\n                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                                    <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />\n                                </svg>\n                            </button>\n                            <button class="btn-delfield" aria-label="${this.out("Delete field")}">\n                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" class="size-4">\n                                    <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />\n                                </svg>\n                            </button>\n                            <div class="handle">\n                                <svg class="size-4 text-[#aaa]" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round">\n                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />\n                                </svg>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="field-settings" tabindex="-1" role="dialog" aria-modal="true" aria-hidden="true" style="display:none"></div>\n                `,s.appendChild(n);const a=n.querySelector(".field-settings");let c,d,h=this.getId();switch("short-text"!==e&&"long-text"!==e&&"number"!==e&&"select"!==e&&"dropdown"!==e&&"date"!==e&&"time"!==e&&"datetime"!==e&&"color"!==e&&"file"!==e&&"email"!==e&&"phone"!==e&&"url"!==e||(c=this.renderCheckbox({parentNode:a,className:"chk-required",text:this.out("Required")})),"dropdown"!==e&&"email"!==e&&"phone"!==e&&"url"!==e||(d="dropdown"===e?`\n                    <div class="flex flex-col gap-2 mt-3 p-1">\n                        <label for="${h}_placeholder_text" class="field-label">${this.out("Placeholder text")}:</label>\n                        <input id="${h}_placeholder_text" type="text" value="${this.out("Select..")}" class="inp-placeholder-text inp-base" />\n                    </div>`:`\n                    <div class="flex flex-col gap-2 mt-3 p-1">\n                        <label for="${h}_placeholder_text" class="field-label">${this.out("Placeholder text")}:</label>\n                        <input id="${h}_placeholder_text" type="text" value="" class="inp-placeholder-text inp-base" />\n                    </div>`,this.appendHtml(a,d)),"short-text"!==e&&"long-text"!==e&&"number"!==e||(d=`\n                <div class="flex flex-col gap-2 mt-3 p-1">\n                    <label for="${h}_placeholder_text" class="field-label">${this.out("Placeholder text")}:</label>\n                    <input id="${h}_placeholder_text" type="text" value="" class="inp-placeholder-text inp-base" />\n                </div>\n                <div class="flex flex-col gap-2 p-1">\n                    <label for="${h}_default_value" class="field-label">${this.out("Default Value")}:</label>\n                    <input id="${h}_default_value" ${"number"===e?'type="number"':'type="text"'} value="" class="inp-default-value inp-base" />\n                </div>`,this.appendHtml(a,d)),"hidden"===e&&(d=`\n                <div class="flex flex-col gap-2 mt-3 p-1">\n                    <label for="${h}_default_value" class="field-label">${this.out("Value")}:</label>\n                    <input id="${h}_default_value" type="text" value="" class="inp-default-value inp-base" />\n                </div>`,this.appendHtml(a,d)),e){case"short-text":case"long-text":case"number":case"switch":break;case"select":case"multi-select":case"dropdown":{let t=this.out("Other (describe):");"dropdown"===e&&(t=this.out("Other (describe)")),d=`\n                    <div class="options-container ${"multi-select"===e?"mt-4":""}"></div>\n\n                    <button class="btn-addoption">\n                        ${this.out("Add Option")}\n                    </button>\n\n                    <div class="select-item mb-1">\n                        <input class="inp-other-option" value="${t}" />\n                    \n                        <button class="btn-other">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />\n                            </svg>\n                        </button>\n                    </div>\n                    \n                    \n                    `,this.appendHtml(a,d);const n=a.querySelector(".options-container"),s=a.querySelector(".btn-addoption");this.addSelectItem(n,!0),this.addSelectItem(n,!0),s.addEventListener("click",(()=>{this.addSelectItem(n,!1)})),new De(n,{animation:150,handle:".handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",onEnd:()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}});let o;a.querySelector(".inp-other-option").addEventListener("input",(()=>{clearTimeout(o),o=setTimeout((()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)}));const i=a.querySelector(".btn-other");i.addEventListener("click",(()=>{i.classList.toggle("active"),i.classList.contains("active")?i.innerHTML='\n                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />\n                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />\n                        </svg>\n                        ':i.innerHTML='\n                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />\n                        </svg>\n                        ';const e=this.get();this.settings.onChange&&this.settings.onChange(e)}))}break;case"date":case"time":case"datetime":case"color":this.appendHtml(a,d);break;case"file":{d=`\n                    <div class="flex flex-col mt-3">\n                        <div class="field-label-normal ml-1">\n                            ${this.out("Allowed File Types")}:\n                        </div>\n                        <div class="file-options-container flex flex-col">\n                        </div>\n                    </div>\n                    `,this.appendHtml(a,d);let e=a.querySelector(".file-options-container");this.renderCheckbox({parentNode:e,name:"file-category",value:"images",text:this.out("Images")}),this.renderCheckbox({parentNode:e,name:"file-category",value:"videos",text:this.out("Videos")}),this.renderCheckbox({parentNode:e,name:"file-category",value:"documents",text:this.out("Documents")}),this.renderCheckbox({parentNode:e,name:"file-category",value:"others",text:this.out("Others (zip & rar)")})}}const u=n.querySelector(".btn-toggle-settings"),p=n.querySelector(".field-settings");u&&u.addEventListener("click",(()=>{p.classList.contains("expanded")?(p.style.height=`${p.scrollHeight}px`,requestAnimationFrame((()=>{p.style.height="0"})),p.classList.remove("expanded"),u.classList.remove("expanded"),document.activeElement.blur(),p.setAttribute("aria-hidden",!0),p.addEventListener("transitionend",(()=>{p.style.display="none",p.style.height=""}),{once:!0})):(p.style.display="",p.style.height="0",requestAnimationFrame((()=>{p.style.height=`${p.scrollHeight}px`})),p.classList.add("expanded"),u.classList.add("expanded"),p.setAttribute("aria-hidden",!1),p.addEventListener("transitionend",(()=>{p.style.height="auto"}),{once:!0}))}));n.querySelector(".btn-delfield").addEventListener("click",(()=>{n.remove();const e=this.get();this.settings.onChange&&this.settings.onChange(e)}));const m=n.querySelector(".inp-field-title");let g;m.addEventListener("paste",(e=>{e.preventDefault();const t=(e.clipboardData||window.clipboardData).getData("text");document.execCommand("insertText",!1,t)})),m.addEventListener("keyup",(e=>{if(e.key&&["Control","Meta","Alt","Shift","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Escape","CapsLock","Tab","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(e.key))return;if(e.ctrlKey||e.metaKey||e.altKey)return;const t=new Event("input",{bubbles:!0,cancelable:!0});m.dispatchEvent(t)})),m.addEventListener("input",(()=>{clearTimeout(g),g=setTimeout((()=>{n.setAttribute("data-name",this.textToId(m.innerText));const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)}));const f=n.querySelector(".inp-placeholder-text");f&&f.addEventListener("input",(()=>{clearTimeout(g),g=setTimeout((()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)}));const b=n.querySelector(".inp-default-value");b&&b.addEventListener("input",(()=>{clearTimeout(g),g=setTimeout((()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)})),c&&c.addEventListener("input",(()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}));n.querySelectorAll('input[name="file-category"]').forEach((e=>{e.addEventListener("input",(()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}))}))};this.addField=p,t.addEventListener("click",c),document.addEventListener("click",d),document.addEventListener("keydown",h),o.forEach((e=>{e.addEventListener("click",u)})),this.cleanup=()=>{t.removeEventListener("click",c),document.removeEventListener("click",d),document.removeEventListener("keydown",h),n.removeEventListener("click",u),o.forEach((e=>{e.removeEventListener("click",u)}))}}addSelectItem(e,t){const n=document.createElement("div");n.className="select-item";const s=document.createElement("input");let o;s.type="text",s.value=`Option ${e.children.length+1}`,s.className="inp-option",s.addEventListener("input",(()=>{clearTimeout(o),o=setTimeout((()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)}));const i=document.createElement("button");i.className="remove-option py-3 pl-3 pr-3 focus:outline-none focus-visible:ring-2 focus-visible:ring-builder-primary-color",i.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />\n            </svg>\n        ',i.addEventListener("click",(()=>{n.remove();const e=this.get();this.settings.onChange&&this.settings.onChange(e)})),n.appendChild(s);const r=document.createElement("div");r.className="flex flex-row",n.appendChild(r),r.appendChild(i);const l=document.createElement("div");if(l.className="handle w-[40px] h-[40px] flex items-center justify-center",l.innerHTML='\n            <svg class="size-4 text-[#aaa]" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round">\n                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />\n            </svg>\n        ',r.appendChild(l),e.appendChild(n),!t){const e=this.get();this.settings.onChange&&this.settings.onChange(e)}}view(e){let t;if(e)try{t=JSON.parse(e)}catch(e){t={}}else t={};const n=this.settings.previewElement;if(n){n.classList.remove("hidden"),n.classList.add("formview-container"),n.classList.add("fb-ui"),n.innerHTML="";if(!(t.hideHeader||!1)){const e=document.createElement("div");e.className="form-header",n.appendChild(e);const s=document.createElement("h1");s.className="form-title",s.innerText=t.title||this.out("Your Form Title Here"),e.appendChild(s);const o=document.createElement("p");o.className="form-desc",o.innerText=t.description||this.out("Your Description Here"),e.appendChild(o)}const e=document.createElement("form");e.className="form-wrapper",e.style.flexFlow="wrap",n.appendChild(e);let s=1;t.elements&&t.elements.forEach((t=>{const n=document.createElement("div");n.className="form-field","hidden"===t.type&&(n.className="hidden"),e.appendChild(n);const o=t.type;let i=t.name;if(e.querySelector(`[name="${i}"]`)&&(s++,i=i+"_"+s),"short-text"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`short_text_label_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`short_text_label_${e}`,o.type="text",o.name=i,o.value=t.value||"",o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("long-text"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`long_text_label_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("textarea");o.id=`long_text_label_${e}`,o.name=i,o.value=t.value||"",o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("number"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`number_label_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`number_label_${e}`,o.type="number",o.name=i,o.value=t.value||"",o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("select"===o){let e=this.getId();const s=document.createElement("div");s.id=`radio_group_label_${e}`,s.className="field-label-normal",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("div");if(o.setAttribute("aria-labelledby",`radio_group_label_${e}`),o.setAttribute("role","group"),o.className="div-options",n.appendChild(o),t.choices&&t.choices.forEach(((n,s)=>{const r=document.createElement("label");r.setAttribute("for",`${e}_${s}`),r.className="option-label",o.appendChild(r);const l=document.createElement("input");l.type="radio",l.className="peer",l.id=`${e}_${s}`,l.name=i,l.value=n,r.appendChild(l);const a=document.createElement("span");a.className="peer-span-rounded",r.appendChild(a);a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="size-5 flex-none"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 7a5 5 0 1 1 -4.995 5.217l-.005 -.217l.005 -.217a5 5 0 0 1 4.995 -4.783z"></path></svg>',0===s&&t.isRequired&&l.setAttribute("required","required");const c=document.createElement("span");c.innerText=n,r.appendChild(c)})),t.showOtherItem){const s=document.createElement("label");s.setAttribute("for",e+"_other"),s.className="option-label",o.appendChild(s);const r=document.createElement("input");r.type="radio",r.className="peer",r.id=e+"_other",r.name=i,r.value="other",s.appendChild(r);const l=document.createElement("span");l.className="peer-span-rounded",s.appendChild(l);const a='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="size-5 flex-none"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 7a5 5 0 1 1 -4.995 5.217l-.005 -.217l.005 -.217a5 5 0 0 1 4.995 -4.783z"></path></svg>';l.innerHTML=a;const c=document.createElement("span");c.innerText=t.otherText,s.appendChild(c);const d=document.createElement("div");n.appendChild(d);const h=document.createElement("input");h.type="text",h.name=i+"_other",h.className="inp-base",d.appendChild(h)}}if("multi-select"===o){let e=this.getId();const s=document.createElement("div");s.id=`checkbox_group_label_${e}`,s.className="field-label-normal",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("div");if(o.setAttribute("aria-labelledby",`checkbox_group_label_${e}`),o.setAttribute("role","group"),o.className="div-options",n.appendChild(o),t.choices&&t.choices.forEach(((t,n)=>{const s=document.createElement("label");s.setAttribute("for",`${e}_${n}`),s.className="option-label",o.appendChild(s);const r=document.createElement("input");r.type="checkbox",r.className="peer",r.id=`${e}_${n}`,r.name=i,r.value=t,s.appendChild(r);const l=document.createElement("span");l.className="peer-span-square",s.appendChild(l);l.innerHTML='<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="4"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" />\n                            </svg>';const a=document.createElement("span");a.innerText=t,s.appendChild(a)})),t.showOtherItem){const s=document.createElement("label");s.setAttribute("for",e+"_other"),s.className="option-label",o.appendChild(s);const r=document.createElement("input");r.type="checkbox",r.className="peer",r.id=e+"_other",r.name=i,r.value="other",s.appendChild(r);const l=document.createElement("span");l.className="peer-span-square",s.appendChild(l);const a='<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="4"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5">\n                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" />\n                        </svg>';l.innerHTML=a;const c=document.createElement("span");c.innerText=t.otherText,s.appendChild(c);const d=document.createElement("div");n.appendChild(d);const h=document.createElement("input");h.type="text",h.name=i+"_other",h.className="inp-base",d.appendChild(h)}}if("switch"===o){let e=this.getId();const s=document.createElement("label");s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),s.id=`switch_${e}`,n.appendChild(s);const o=document.createElement("div");o.className="switch",o.tabIndex=0,o.role="switch",o.setAttribute("aria-labelledby",`switch_${e}`),o.setAttribute("aria-checked","false"),o.setAttribute("data-checked","false"),n.appendChild(o);const r=document.createElement("div");r.className="switch-thumb",o.appendChild(r);const l=document.createElement("input");l.id=`switch_${e}`,l.type="hidden",l.name=i,l.value="false",n.appendChild(l),s.addEventListener("click",(()=>{o.focus()}));const a=()=>{const e="true"===o.getAttribute("aria-checked");o.setAttribute("aria-checked",!e),o.setAttribute("data-checked",!e),l.value=!e};o.addEventListener("keydown",(e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),a())})),o.addEventListener("click",(()=>{a()}))}if("dropdown"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`dropdown_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("div");o.className="relative",n.appendChild(o);const r=document.createElement("select");r.id=`dropdown_${e}`,r.name=i,t.isRequired&&r.setAttribute("required","required"),o.appendChild(r);const l=document.createElement("option");if(l.setAttribute("selected","selected"),l.setAttribute("disabled","disabled"),l.value="",l.innerText=t.placeholder,r.appendChild(l),t.choices&&t.choices.forEach((e=>{const t=document.createElement("option");t.value=e,t.innerText=e,r.appendChild(t)})),t.showOtherItem){const e=document.createElement("option");e.value="other",e.innerText=t.otherText,r.appendChild(e)}const a=document.createElement("div");a.className="select-arrow",o.appendChild(a),this.appendHtml(a,'\n                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />\n                        </svg>\n                        ');const c=document.createElement("input");c.type="text",c.id=`input_other_${e}`,c.name=i+"_other",c.className="input-other hidden inp-base",n.appendChild(c);const d=n.querySelector(`#dropdown_${e}`),h=n.querySelector(`#input_other_${e}`);d.addEventListener("change",(()=>{"other"===d.value?(h.classList.remove("hidden"),h.focus()):h.classList.add("hidden")}))}if("date"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`date_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`date_${e}`,o.type="date",o.name=i,o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("time"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`time_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`time_${e}`,o.type="time",o.name=i,o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("datetime"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`datetime_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`datetime_${e}`,o.type="datetime-local",o.name=i,o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("color"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`color_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`color_${e}`,o.type="color",o.name=i,o.className="input-color",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("file"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`file_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("div");o.className="file-input-wrapper",o.setAttribute("aria-label",this.out(this.settings.fileUploadText)),n.appendChild(o);const r=document.createElement("input");r.id=`file_${e}`,r.type="file",r.name=i,t.isRequired&&r.setAttribute("required","required"),r.className="peer",o.appendChild(r);const l=document.createElement("div");l.className="file-drop-area",o.appendChild(l);const a=document.createElement("div");a.className="file-drop-info",a.id=`drag_message_${e}`,a.innerText=this.out(this.settings.fileUploadText),o.appendChild(a);const c=document.createElement("div");c.className="file-drop-info-highlight",c.id=`file_name_${e}`,o.appendChild(c),o.addEventListener("click",(()=>{r.click()})),o.addEventListener("dragover",(e=>{e.preventDefault()})),o.addEventListener("drop",(e=>{e.preventDefault(),o.classList.remove("drag-over");const t=e.dataTransfer.files[0];m(t)})),r.addEventListener("change",(()=>{const e=r.files[0];e&&m(e)}));const d={images:[{type:"image/jpeg",extensions:".jpg, .jpeg"},{type:"image/png",extensions:".png"},{type:"image/gif",extensions:".gif"},{type:"image/webp",extensions:".webp"}],videos:[{type:"video/mp4",extensions:".mp4"},{type:"video/webm",extensions:".webm"},{type:"video/ogg",extensions:".ogg"},{type:"video/quicktime",extensions:".mov"}],documents:[{type:"application/pdf",extensions:".pdf"},{type:"text/plain",extensions:".txt"},{type:"text/csv",extensions:".csv"},{type:"application/msword",extensions:".doc"},{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extensions:".docx"},{type:"application/vnd.ms-excel",extensions:".xls"},{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extensions:".xlsx"}],others:[{type:"application/zip",extensions:".zip"},{type:"application/x-rar-compressed",extensions:".rar"}]};let h=[];(t.allowedFileTypes||["images","videos","documents","others"]).forEach((e=>{switch(e){case"images":h=h.concat(d.images);break;case"videos":h=h.concat(d.videos);break;case"documents":h=h.concat(d.documents);break;case"others":h=h.concat(d.others)}}));const u=h.map((e=>e.type)).join(",");r.setAttribute("accept",u);const p=()=>{const e=document.getElementById("img-preview");e&&e.remove()},m=e=>{if(e){if(!h.some((t=>t.type===e.type)))return alert(this.out("Invalid file type.")),void p();if(c.textContent=e.name,e.type.startsWith("image/")){const t=new FileReader;t.onload=function(e){let t=document.getElementById("img-preview");t||(t=document.createElement("img"),t.id="img-preview",t.style.maxWidth="100px",t.style.maxHeight="100px",t.style.marginTop="10px",o.appendChild(t)),t.src=e.target.result},t.readAsDataURL(e)}else p()}}}if("email"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`email_label_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`email_label_${e}`,o.type="email",o.name=i,o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("phone"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`phone_label_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`phone_label_${e}`,o.type="tel",o.name=i,o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("url"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`url_label_${e}`),s.className="field-label",s.innerHTML=t.title+(t.isRequired?' <span class="text-red-500">*</span>':""),n.appendChild(s);const o=document.createElement("input");o.id=`url_label_${e}`,o.type="url",o.name=i,o.className="inp-base",o.placeholder=t.placeholder,t.isRequired&&o.setAttribute("required","required"),n.appendChild(o)}if("hidden"===o){let e=this.getId();const s=document.createElement("label");s.setAttribute("for",`hidden_label_${e}`),s.className="field-label hidden",s.innerText=t.title,n.appendChild(s);const o=document.createElement("input");o.id=`hidden_label_${e}`,o.type="hidden",o.name=i,o.value=t.value,n.appendChild(o)}}));const o=document.createElement("button");o.className="btn-submitform";const i=t.submitText||this.settings.submitText;o.innerText=i,e.appendChild(o),e.addEventListener("submit",(async e=>{e.preventDefault(),this.steps&&this.steps.length>0?this.process(o,i):this.settings.onSubmit&&this.settings.onSubmit(e)}))}}async search(e){const t=this.settings.searchCommandUrl,n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})});if(!n.ok)throw new Error("Failed to fetch data");const s=await n.json();return(s&&s.organic_results?s.organic_results.map((e=>({title:e.title,link:e.link,snippet:e.snippet}))):[])||[]}async scrapeUrls(e){if(0===e.length)return"";this.settings.consoleLog&&console.log(e);const t=await fetch(this.settings.scrapeCommandUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:e})});if(!t.ok)throw new Error(`Error: ${t.statusText}`);let n="";const s=await t.json();return this.settings.consoleLog&&console.log(s),s.error?(this.settings.consoleLog&&console.log(s.error),""):(s.forEach((e=>{if(e.success){const t=e.metadata.title,s=e.markdown,o=e.metadata.url;n+=`\n\n\n## ${t}\n\nSource: ${o}\n                \n${s}\n\n\n----------------\n\n\n`}})),n)}async checkPrompt(e){let t=`This is user's request:\n\n${e}        \n        `,n=await this.send("\nCheck if the request requires scrape information on certain sources. If so, returns the source URLs to scrape.  \nAlso check if the request requires search to find answers by searching on the web to get the current relevant information.      \n",t,"You are an assistant",[{name:"check_request",description:"Check user request.",parameters:{type:"object",properties:{needscrape:{type:"boolean",description:"Check the if request requires search on the web or not."},url:{type:"string",description:"If scrape needed, return the url."},url2:{type:"string",description:"If scrape needed, return the url."},url3:{type:"string",description:"If scrape needed, return the url."},needsearch:{type:"boolean",description:"Check the if request requires search on the web or not."}},required:["needsearch","needscrape"]}}]);return!!n&&(this.settings.consoleLog&&console.log(n),JSON.parse(n))}async getRelevantInfo(e){if(!this.settings.searchCommandUrl&&!this.settings.scrapeCommandUrl)return"";let t="",n=await this.checkPrompt(e);if(n.needsearch&&this.settings.searchCommandUrl){let n=await this.search(e);const s=this.settings.scrapeLimit,o=this.settings.scrapeExclude,i=n.map((e=>e.link)).filter((e=>!o.some((t=>e.includes(t))))).slice(0,s);t+=await this.scrapeUrls(i)}else if(n.needscrape&&this.settings.scrapeCommandUrl){let e=[];n.url&&e.push(n.url),n.url2&&e.push(n.url2),n.url3&&e.push(n.url3),t+=await this.scrapeUrls(e)}return t}async process(e,t,n){let s=!1;null!=n&&(s=!0);const o=this.settings.resultElement;if(!o)return;if(this.isNormal&&!s)return this.abort(),e.innerHTML=t,void(this.isGenerating=!1);if(this.isNormal&&s)return;if(this.isSingle&&!s)return;if(this.isSingle&&s)return;this.isNormal=!1,this.isSingle=!1,s?(e.innerHTML='\n                <span class="loading-icon">\n                    <svg class="animate-spin" style="margin: 0;margin-right: 0.6rem;width: 1rem;height: 1rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                        <circle style="opacity: 0.25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                        <path style="opacity: 0.75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                    </svg>\n                </span>\n            ',this.isSingle=!0):(e.innerHTML=`\n                <span class="loading-icon">\n                    <svg class="animate-spin" style="margin: 0;margin-right: 0.6rem;width: 1.25rem;height: 1.25rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                        <circle style="opacity: 0.25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                        <path style="opacity: 0.75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                    </svg>\n                </span>\n                ${this.out("Abort")}\n            `,this.isNormal=!0),this.isGenerating=!0,o.innerHTML="";let i=JSON.parse(JSON.stringify(this.steps)),r=this.getFormValues();i.forEach((e=>{const t=(new DOMParser).parseFromString(e.prompt,"text/html"),n=t.querySelectorAll("span.tag");r.forEach((e=>{n.forEach((t=>{t.getAttribute("data-name").toLowerCase()===e.name&&(t.innerText=e.value)}))}));let s=t.body.innerHTML.replace(/&nbsp;/g," ");r.forEach((e=>{s=s.replaceAll(`{{${e.name}}}`,e.value)})),e.prompt=s}));const l=async(e,t,n,s)=>{const i=document.createElement("div");i.classList.add("result-container"),o.appendChild(i);let r="",l=await this.getRelevantInfo(e);if(""!==l&&(t+=`\nUse the following information to answer the request:\n\n${l}\n`),this.settings.sendCommandStreamUrl)await this.request(e,t,n,s,(async e=>{r+=e;const t=zn.parse(r);i.innerHTML=t,await new Promise((e=>setTimeout(e,50)))}));else{let o=await this.send(e,t,n,s);if(!o)return!1;const r=zn.parse(o);i.innerHTML=r}return r},a=async e=>{this.previousResults=[];for(let t=0;t<e.length;t++){if(!this.isGenerating)return;let{prompt:n,context:s,system:o,functs:i}=e[t];s=s||"",o=o||"You are an assistant",i=i||[];const r=(new DOMParser).parseFromString(n,"text/html"),a=r.querySelectorAll("span.tag");this.previousResults.forEach(((e,t)=>{const n=`output_step_${t+1}`;a.forEach((t=>{t.getAttribute("data-name").toLowerCase()===n&&(t.innerText=e)}))}));let c=r.body.innerHTML.replace(/&nbsp;/g," ");this.previousResults.forEach(((e,t)=>{const n=`{{output_step_${t+1}}}`;c=c.replace(new RegExp(n,"g"),e),c=c.replace(new RegExp(n.toUpperCase(),"g"),e)})),n=this.stripHtmlWithLineBreaks(c),this.settings.consoleLog&&console.log(n);let d=await l(n,s,o,i);this.previousResults.push(d)}};if(s||await a(i),s){0===n&&(this.previousResults=[]);const e=async(e,t)=>{if(!this.isGenerating)return;let{prompt:n,context:s,system:o,functs:i}=e[t];s=s||"",o=o||"You are an assistant",i=i||[];const r=(new DOMParser).parseFromString(n,"text/html"),a=r.querySelectorAll("span.tag");this.previousResults&&this.previousResults.forEach(((e,t)=>{const n=`output_step_${t+1}`;a.forEach((t=>{t.getAttribute("data-name").toLowerCase()===n&&(t.innerText=e)}))}));let c=r.body.innerHTML.replace(/&nbsp;/g," ");this.previousResults&&this.previousResults.forEach(((e,t)=>{const n=`{{output_step_${t+1}}}`;c=c.replace(new RegExp(n,"g"),e),c=c.replace(new RegExp(n.toUpperCase(),"g"),e)})),n=this.stripHtmlWithLineBreaks(c),this.settings.consoleLog&&console.log(n);let d=await l(n,s,o,i);this.previousResults&&(this.previousResults[t]=d)};await e(i,n)}e.innerHTML=t,this.isGenerating=!1,this.isNormal=!1,this.isSingle=!1}stripHtmlWithLineBreaks(e){return e?(e=(e=(e=e.replace(/<\/?(p|br|div|h[1-6]|li|ul|ol|blockquote|pre)[^>]*>/gi,"\n")).replace(/\n\s*\n/g,"\n")).replace(/<[^>]+>/g,"")).trim():""}render(){const e=this.element;if(!e.querySelector(".fields-container")){let t=this.getId(),n="";this.settings.fieldTypes.forEach((e=>{"short-text"===e&&(n+=`\n                        <button data-type="short-text" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n                                <path d="M4 6l16 0" />\n                                <path d="M4 12l10 0" />\n                            </svg>\n                            ${this.out("Short Text")}\n                        </button>\n                    `),"long-text"===e&&(n+=`\n                        <button data-type="long-text" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 mb-1 mt-1">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />\n                            </svg>\n                            ${this.out("Long Text")}\n                        </button>\n                    `),"number"===e&&(n+=`\n                        <button data-type="number" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7" stroke="currentColor" class="size-5 mb-1 mt-1" style="transform:scale(0.8)">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5-3.9 19.5m-2.1-19.5-3.9 19.5" />\n                            </svg>\n                            ${this.out("Number")}\n                        </button>\n                    `),"switch"===e&&(n+=`\n                        <button data-type="switch" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M2 6m0 6a6 6 0 0 1 6 -6h8a6 6 0 0 1 6 6v0a6 6 0 0 1 -6 6h-8a6 6 0 0 1 -6 -6z" />\n                            </svg>\n                            ${this.out("Switch")}\n                        </button>\n                    `),"select"===e&&(n+=`\n                        <button data-type="select" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M9 12l2 2l4 -4" />\n                            </svg>\n                            ${this.out("Select")}\n                        </button>\n                    `),"multi-select"===e&&(n+=`\n                        <button data-type="multi-select" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path stroke="none" d="M0 0h24v24H0z" /><path d="M7 9.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2 2 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /><path d="M11 14l2 2l4 -4" />\n                            </svg>\n                            ${this.out("Multi Select")}\n                        </button>\n                    `),"date"===e&&(n+=`\n                        <button data-type="date" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.1"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1" style="transform:scale(1.04)">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" />\n                            </svg>\n                            ${this.out("Date")}\n                        </button>\n                    `),"time"===e&&(n+=`\n                        <button data-type="time" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 1a1 1 0 0 1 1 -1h14a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-14a1 1 0 0 1 -1 -1z" /><path d="M12 7v5l3 3" /><path d="M4 12h1" /><path d="M19 12h1" /><path d="M12 19v1" />\n                            </svg>\n                            ${this.out("Time")}\n                        </button>\n                    `),"datetime"===e&&(n+=`\n                        <button data-type="datetime" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.1"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1" style="transform:scale(1.04)">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" /><path d="M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M15 3v4" /><path d="M7 3v4" /><path d="M3 11h16" /><path d="M18 16.496v1.504l1 1" />\n                            </svg>\n                            ${this.out("Datetime")}\n                        </button>\n                    `),"color2"===e&&(n+=`\n                        <button data-type="color" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 3.34a10 10 0 1 1 -15 8.66l.005 -.324a10 10 0 0 1 14.995 -8.336m-9 1.732a8 8 0 0 0 4.001 14.928l-.001 -16a8 8 0 0 0 -4 1.072" />\n                            </svg>\n                            ${this.out("Color")}\n                        </button>\n                    `),"color"===e&&(n+=`\n                        <button data-type="color" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" /><path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />\n                            </svg>\n                            ${this.out("Color")}\n                        </button>\n                    `),"file"===e&&(n+=`\n                        <button data-type="file" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 mb-1 mt-1" style="transform:scale(0.9)">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13" />\n                            </svg>\n                            ${this.out("File Upload")}\n                        </button>\n                    `),"dropdown"===e&&(n+=`\n                        <button data-type="dropdown" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 mb-1 mt-1">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" />\n                            </svg>\n                            ${this.out("Dropdown")}\n                        </button>\n                    `),"email"===e&&(n+=`\n                        <button data-type="email" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.4" stroke="currentColor" class="size-5 mb-1 mt-1">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />\n                            </svg>\n                            ${this.out("Email")}\n                        </button>\n\n                    `),"phone"===e&&(n+=`\n                        <button data-type="phone" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 mb-1 mt-1" style="transform:scale(0.9)">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" />\n                            </svg>\n                            ${this.out("Phone")}\n                        </button>\n                    `),"url"===e&&(n+=`\n                        <button data-type="url" class="btn-selectfield">\n                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 mb-1 mt-1" style="transform:scale(0.9)">\n                                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244" />\n                            </svg>\n                            ${this.out("URL")}\n                        </button>\n                    `),"hidden"===e&&(n+=`\n                        <button data-type="hidden" class="btn-selectfield">\n                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="1.5"  stroke-linecap="round"  stroke-linejoin="round"  class="size-5 mb-1 mt-1">\n                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 8m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" />\n                            </svg>\n                            ${this.out("Hidden")}\n                        </button>\n                    `)}));const s=`\n                <div class="form-header">\n                    <h1 class="form-title"><span contentEditable="true"></span></h1>\n                    <p class="form-desc"><span contentEditable="true"></span></p>\n                </div>\n            \n                <div class="fields-container"></div>\n\n                <button class="btn-addfield" aria-expanded="false" aria-controls="fieldTypePopup_${t}">\n                    \n                    <svg class="size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">\n                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />\n                    </svg>\n\n                    <span>${this.out("Add input field")}</span>\n\n                </button>\n\n                ${this.settings.demo?'\n                    <p class="demo-info">\n                        <b>License Info:</b> a developer license is required to use the library.\n                    </p>\n                ':""}\n\n                <div id="fieldTypePopup_${t}" class="popup-fields hidden" role="dialog" aria-hidden="true" aria-label="${this.out("Add input field")}">\n                    <div class="flex flex-wrap gap-2">\n                        ${n}\n                    </div>\n                </div>\n            `,o=document.createElement("div");o.classList.add("formbuilder-container"),o.classList.add("flex"),o.classList.add("flex-col"),o.insertAdjacentHTML("afterbegin",s),e.appendChild(o),this.initializeEventListeners(e)}}hideWorkflow(){let e=document.querySelector(".formworkflow-container");e&&e.classList.add("hidden")}loadWorkflow(e){const t=this.settings.workflowElement;if(t){if(t.classList.remove("hidden"),t.classList.add("formworkflow-container"),t.classList.add("fb-ui"),!t.querySelector(".btn-addstep")){let e=document.createElement("div");e.className="inner-container",t.appendChild(e);const n=document.createElement("div");n.className="flex flex-col gap-1 mb-4",e.appendChild(n);const s=document.createElement("div");s.className="workflow-title",s.innerText=this.out("Workflow"),n.appendChild(s);const i=document.createElement("div");i.className="workflow-tagline",i.innerText=this.out("Automate Your Form Processing with AI."),n.appendChild(i);const r=document.createElement("div");r.className="steps-container",e.appendChild(r);const l=document.createElement("button");l.className="btn-addstep",l.innerHTML=`\n                <svg class="size-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">\n                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"></path>\n                </svg>\n                <span>${this.out("Add Step")}</span>\n                `,e.appendChild(l),l.addEventListener("click",(()=>{const e={prompt:""};o(e,this.steps.length),this.steps.push(e);let t={steps:this.steps,sendCommandUrl:this.settings.sendCommandUrl?this.settings.sendCommandUrl:"",sendCommandStreamUrl:this.settings.sendCommandStreamUrl?this.settings.sendCommandStreamUrl:"",searchCommandUrl:this.settings.searchCommandUrl?this.settings.searchCommandUrl:"",scrapeCommandUrl:this.settings.scrapeCommandUrl?this.settings.scrapeCommandUrl:""};const n=JSON.stringify(t);this.settings.onWorkflowChange&&this.settings.onWorkflowChange(n)}))}const n=t.querySelector(".steps-container");n.innerHTML="";const s=JSON.parse(e).steps;this.editors=[];const o=(e,t)=>{const o=t+1,i=document.createElement("div");i.className="step-container flex flex-col gap-1",n.appendChild(i);const r=document.createElement("div");i.appendChild(r);const l=[],a=this.get(),c=JSON.parse(a).elements;c.forEach((e=>{let t=e.title;t=t.replace(/:/g,""),l.push({title:t,name:e.name.toUpperCase()})}));for(let e=1;e<o;e++)l.push({title:`Output from step ${e}`,name:`OUTPUT_STEP_${e}`});const d=document.createElement("div");d.className="step-label flex flex-row justify-between items-center",i.appendChild(d);const h=document.createElement("label");h.innerText=`${o}/${s.length}`,d.appendChild(h);const u=document.createElement("div");u.className="flex flex-row",d.appendChild(u);const p=document.createElement("button");p.setAttribute("aria-label",this.out("Remove Step")),p.className="btn-delstep w-[36px] h-[23px] flex items-center justify-center focus:outline-none focus-visible:ring-2 focus-visible:ring-builder-primary-color",p.innerHTML='\n                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                    <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />\n                </svg>\n                ',u.appendChild(p);const m=document.createElement("button");m.setAttribute("aria-label",this.out("Run Step")),m.className="btn-runstep w-[36px] h-[23px] flex items-center justify-center focus:outline-none focus-visible:ring-2 focus-visible:ring-builder-primary-color",m.innerHTML='\n                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="size-4">\n                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z" />\n                </svg>\n                ',u.appendChild(m);const g=e=>Array.prototype.indexOf.call(e.parentNode.children,e);p.addEventListener("click",(()=>{let e=p.closest(".step-container"),t=g(e);this.steps.splice(t,1);let n={steps:this.steps,sendCommandUrl:this.settings.sendCommandUrl?this.settings.sendCommandUrl:"",sendCommandStreamUrl:this.settings.sendCommandStreamUrl?this.settings.sendCommandStreamUrl:"",searchCommandUrl:this.settings.searchCommandUrl?this.settings.searchCommandUrl:"",scrapeCommandUrl:this.settings.scrapeCommandUrl?this.settings.scrapeCommandUrl:""};p.closest(".step-container").remove();const s=JSON.stringify(n);this.settings.onWorkflowChange&&this.settings.onWorkflowChange(s)})),m.addEventListener("click",(()=>{let e=p.closest(".step-container"),t=g(e);this.process(m,m.innerHTML,t)}));let f=e.prompt;if(!this.isHTML(f)){f=this.textToHTML(f),c.forEach((e=>{const t=e.name;let n=`<span class="tag" contentEditable="false" data-name="${t.toUpperCase()}">${t.toUpperCase()}</span>`;f=f.replaceAll(`{{${t}}}`,n),f=f.replaceAll(`{{${t.toUpperCase()}}}`,n)})),f=f.replace(/{{(\w+)}}/g,((e,t)=>`<span class="tag" contentEditable="false" data-name="${t}">${t}</span>`));for(let e=1;e<=s.length;e++){let t=`<span class="tag" contentEditable="false" data-name="OUTPUT_STEP_${e}">OUTPUT_STEP_${e}</span>`;f=f.replaceAll(`{{output_step_${e}}}`,t),f=f.replaceAll(`{{OUTPUT_STEP_${e}}}`,t)}}const b=new Mt(r,{ariaLabel:this.out("Step")+" "+o,placeholderText:this.out('Press "/" to insert a reference.'),tags:l,value:f,onChange:e=>{let n=JSON.parse(JSON.stringify(this.steps));n.forEach(((n,s)=>{t===s&&(n.prompt=e)}));const s={steps:n,sendCommandUrl:this.settings.sendCommandUrl?this.settings.sendCommandUrl:"",sendCommandStreamUrl:this.settings.sendCommandStreamUrl?this.settings.sendCommandStreamUrl:"",searchCommandUrl:this.settings.searchCommandUrl?this.settings.searchCommandUrl:"",scrapeCommandUrl:this.settings.scrapeCommandUrl?this.settings.scrapeCommandUrl:""};this.steps=n;const o=JSON.stringify(s);this.settings.onWorkflowChange&&this.settings.onWorkflowChange(o)}});this.editors.push(b)};s.forEach(((e,t)=>{o(e,t)})),this.steps=s}else{const t=JSON.parse(e).steps;this.steps=t}}isHTML(e){const t=document.createElement("div");return t.innerHTML=e.trim(),t.children.length>0||t.childNodes.length>1||t.innerHTML!==e.trim()}textToHTML(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")}getWorkflow(){const e=this.settings.workflowElement;if(!e)return;let t=[];e.querySelectorAll("[data-name]").forEach((e=>{let n={prompt:e.value};t.push(n)}));const n={steps:t,sendCommandUrl:this.settings.sendCommandUrl?this.settings.sendCommandUrl:"",sendCommandStreamUrl:this.settings.sendCommandStreamUrl?this.settings.sendCommandStreamUrl:"",searchCommandUrl:this.settings.searchCommandUrl?this.settings.searchCommandUrl:"",scrapeCommandUrl:this.settings.scrapeCommandUrl?this.settings.scrapeCommandUrl:""};return JSON.stringify(n)}async send(e,t,n,s){this.controller=new AbortController,this.signal=this.controller.signal;s||(s=[]);const o={question:e,context:t,system:n,functs:s,temperature:.6,topP:.9,num:1,model:this.settings.model};try{let e={"Content-Type":"application/json"};const t=await fetch(this.settings.sendCommandUrl,{signal:this.signal,method:"POST",headers:e,body:JSON.stringify(o)});let n=await t.json();if(n.error)return console.log("Error:\n"+n.error),!1;if(n.answer.usage&&(this.tokenInput+=n.answer.usage.prompt_tokens,this.tokenOutput+=n.answer.usage.completion_tokens),0===s.length){let e;return n.answer.choices.forEach((t=>{e=t.message.content})),e}return n.answer}catch(e){return"AbortError"===e.name?this.settings.consoleLog&&console.log("Request aborted by user."):console.error("Error:",e),!1}}async request(e,t,n,s,o){this.controller=new AbortController,this.signal=this.controller.signal;s||(s=[]);const i={question:e,context:t,system:n,functs:s,temperature:.6,topP:.9,num:1,model:this.settings.model};try{let e={"Content-Type":"application/json"};const t=await fetch(this.settings.sendCommandStreamUrl,{signal:this.signal,method:"POST",headers:e,body:JSON.stringify(i)});if(!t.ok)return console.error("Error:",t.statusText),!1;const n=t.body.getReader(),s=new TextDecoder;let r="",l=!1;for(;!l;){const{done:e,value:t}=await n.read();if(l=e,l)break;r+=s.decode(t,{stream:!0});const i=r.split("\n");r="";for(const e of i)if(""!==e.trim()&&e.startsWith("data:")){const t=e.slice(5).trim();if("[DONE]"===t){this.settings.consoleLog&&console.log("Stream completed.");break}try{const e=JSON.parse(t);if(e.choices&&e.choices[0].delta&&e.choices[0].delta.content){const t=e.choices[0].delta.content;o&&o(t)}}catch(t){r+=e+"\n"}}}return!0}catch(e){return"AbortError"===e.name?this.settings.consoleLog&&console.log("Request aborted by user."):console.error("Error:",e),!1}}hideBuilder(){const e=document.querySelector(".formbuilder-container");e&&e.classList.add("hidden")}hideGenerator(){const e=document.querySelector(".formgenerator-container");e&&e.classList.add("hidden")}hideViewer(){const e=this.settings.previewElement;e&&e.classList.add("hidden")}showSettings(){const e=this.settings.settingsElement;if(e)if(e.classList.remove("hidden"),e.classList.add("formsettings-container"),e.classList.add("fb-ui"),e.querySelector(".inp-submit-text")){e.querySelector(".inp-submit-text").value=this.json&&this.json.submitText||this.settings.submitText;e.querySelector('input[name="hideheader"]').checked=this.json&&this.json.hideHeader||!1}else{let t=this.getId(),n=document.createElement("div");n.className="inner-container",e.appendChild(n);let s=document.createElement("div");s.className="settings-title",s.innerText=this.out("Settings"),n.appendChild(s);let o=document.createElement("label");o.setAttribute("for",`submit_text_${t}`),o.className="field-label",o.innerText=this.out("Submit Button Text:"),n.appendChild(o);const i=document.createElement("input");let r;i.id=`submit_text_${t}`,i.type="text",i.className="inp-submit-text inp-base",n.appendChild(i),i.value=this.json&&this.json.submitText||this.settings.submitText,i.addEventListener("input",(()=>{clearTimeout(r),r=setTimeout((()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}),300)}));const l=this.renderCheckbox({parentNode:n,name:"hideheader",text:this.out("Hide Header")});l.checked=this.json&&this.json.hideHeader||!1,l.addEventListener("input",(()=>{const e=this.get();this.settings.onChange&&this.settings.onChange(e)}))}}hideSettings(){const e=this.settings.settingsElement;e&&e.classList.add("hidden")}showDesigner(){const e=this.settings.designerElement;if(e&&(e.classList.remove("hidden"),e.classList.add("formdesigner-container"),e.classList.add("fb-ui"),!e.querySelector(".btn-theme-reset"))){let t=this.getId();const n=`\n                    <div class="inner-container">\n\n                        <div class="settings-title">\n                            ${this.out("Design")}\n                        </div>\n\n                        <div class="inner-header">\n                            <span>${this.out("General")}:</span>\n\n                            <button class="btn-theme-reset">${this.out("Reset")}</button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Default Text Color")}:\n                            </div>\n                            <button title="${this.out("Text Color")}" class="inp-text-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Primary Color")}:\n                            </div>\n                            <button title="${this.out("Primary Color")}" class="inp-primary-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Form Title Color")}:\n                            </div>\n                            <button title="${this.out("Form Title Color")}" class="inp-form-title-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Form Description Color")}:\n                            </div>\n                            <button title="${this.out("Form Description Color")}" class="inp-form-desc-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Label Color")}:\n                            </div>\n                            <button title="${this.out("Label Color")}" class="inp-label-color is-btn-color"></button>\n                        </div>\n\n                        <div class="items-group">\n                            ${this.out("Input")}:\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Bg Color")}:\n                            </div>\n                            <button title="${this.out("Bg Color")}" class="inp-input-bg-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Border Color")}:\n                            </div>\n                            <button title="${this.out("Border Color")}" class="inp-input-border-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Border Width")}:\n                            </div>\n                            <input id="${t}_input_border_width" type="number" value="1" class="inp-input-border-width width-setting" />\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Focused Border Width")}:\n                            </div>\n                            <input id="${t}_input_focused_border_width" type="number" value="1" class="inp-input-focused-border-width width-setting" />\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Placeholder Text Color")}:\n                            </div>\n                            <button title="${this.out("Placeholder Text Color")}" class="inp-input-placeholder-color is-btn-color"></button>\n                        </div>\n\n                        <div class="items-group">\n                            ${this.out("Choice (Checkbox & Radio Button)")}:\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Border Color")}:\n                            </div>\n                            <button title="${this.out("Border Color")}" class="inp-choice-border-color is-btn-color"></button>\n                        </div>\n\n                        <div class="items-group">\n                            ${this.out("Switch")}:\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Bg Color")}:\n                            </div>\n                            <button title="${this.out("Bg Color")}" class="inp-switch-bg-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Knob Color")}:\n                            </div>\n                            <button title="${this.out("Knob Color")}" class="inp-switch-knob-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Focus Offset Color")}:\n                            </div>\n                            <button title="${this.out("Focus Offset Color")}" class="inp-switch-focus-offset-color is-btn-color"></button>\n                        </div>\n\n                        <div class="items-group">\n                            ${this.out("File Upload")}:\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("Border Color")}:\n                            </div>\n                            <button title="${this.out("Border Color")}" class="inp-dropfile-border-color is-btn-color"></button>\n                        </div>\n\n                        <div class="item-setting">\n                            <div class="text-base">\n                                ${this.out("File Drop Hover Color")}:\n                            </div>\n                            <button title="${this.out("File Drop Hover Color")}" class="inp-dropfile-hover-color is-btn-color"></button>\n                        </div>\n\n                        <div class="div-use-button flex flex-wrap gap-6">\n\n                            <div class="items-group">\n                                ${this.out("Button")}:\n                            </div>\n                        \n                            <div class="item-setting">\n                                <div class="text-base">\n                                    ${this.out("Bg Color")}:\n                                </div>\n                                <button title="${this.out("Bg Color")}" class="inp-button-bg-color is-btn-color"></button>\n                            </div>\n                        \n                            <div class="item-setting">\n                                <div class="text-base">\n                                    ${this.out("Hover Bg Color")}:\n                                </div>\n                                <button title="${this.out("Hover Bg Color")}" class="inp-button-hover-bg-color is-btn-color"></button>\n                            </div>\n                        \n                            <div class="item-setting">\n                                <div class="text-base">\n                                    ${this.out("Text Color")}:\n                                </div>\n                                <button title="${this.out("Text Color")}" class="inp-button-text-color is-btn-color"></button>\n                            </div>\n                        \n                            <div class="item-setting">\n                                <div class="text-base">\n                                    ${this.out("Hover Text Color")}:\n                                </div>\n                                <button title="${this.out("Hover Text Color")}" class="inp-button-hover-text-color is-btn-color"></button>\n                            </div>\n\n                        </div>\n\n                    </div>\n                `;let s;e.insertAdjacentHTML("afterbegin",n),e.querySelectorAll(".is-btn-color").forEach((e=>{e.addEventListener("click",(()=>{this.colorPicker.open((t=>{e.style.backgroundColor=t,clearTimeout(s),s=setTimeout((()=>{const e=this.getTheme();this.settings.onThemeChange&&this.settings.onThemeChange(e)}),300)}),e.style.backgroundColor,(()=>{e.removeAttribute("data-focus"),e.focus()})),e.setAttribute("data-focus",!0)}))}));e.querySelector(".inp-input-border-width").addEventListener("input",(()=>{const e=this.getTheme();this.settings.onThemeChange&&this.settings.onThemeChange(e)}));e.querySelector(".inp-input-focused-border-width").addEventListener("input",(()=>{const e=this.getTheme();this.settings.onThemeChange&&this.settings.onThemeChange(e)}));e.querySelector(".btn-theme-reset").addEventListener("click",(()=>{this.setTheme({});const e=this.getTheme();this.settings.onThemeChange&&this.settings.onThemeChange(e)}))}this.themeData&&this.setTheme(this.themeData)}setTheme(e){let t;if(e)try{t=JSON.parse(e)}catch(e){t={}}else t={};this.themeData=e;const n=this.settings.designerElement||this.element,s=t.cssVariables;let o,i;const r=document.documentElement;i=s&&s["--form-text-color"]||"",r.style.setProperty("--form-text-color",i),o=n.querySelector(".inp-text-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-primary-color"]||"#3b82f6",r.style.setProperty("--form-primary-color",i),o=n.querySelector(".inp-primary-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-title-color"]||"",r.style.setProperty("--form-title-color",i),o=n.querySelector(".inp-form-title-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-desc-color"]||"",r.style.setProperty("--form-desc-color",i),o=n.querySelector(".inp-form-desc-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-label-color"]||"",r.style.setProperty("--form-label-color",i),o=n.querySelector(".inp-label-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-input-border-color"]||"",r.style.setProperty("--form-input-border-color",i),o=n.querySelector(".inp-input-border-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-primary-border-width"]||"1px",r.style.setProperty("--form-primary-border-width",i),o=n.querySelector(".inp-input-border-width"),i=parseInt(i),isNaN(i)&&(i=1),o&&(o.value=i),i=s&&s["--form-secondary-border-width"]||"2px",r.style.setProperty("--form-secondary-border-width",i),o=n.querySelector(".inp-input-focused-border-width"),i=parseInt(i),isNaN(i)&&(i=2),o&&(o.value=i),i=s&&s["--form-input-background-color"]||"",r.style.setProperty("--form-input-background-color",i),o=n.querySelector(".inp-input-bg-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-input-placeholder-color"]||"",r.style.setProperty("--form-input-placeholder-color",i),o=n.querySelector(".inp-input-placeholder-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-choice-border-color"]||"",r.style.setProperty("--form-choice-border-color",i),o=n.querySelector(".inp-choice-border-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-switch-background-color"]||"",r.style.setProperty("--form-switch-background-color",i),o=n.querySelector(".inp-switch-bg-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-switch-knob-color"]||"",r.style.setProperty("--form-switch-knob-color",i),o=n.querySelector(".inp-switch-knob-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-switch-focus-offset-color"]||"",r.style.setProperty("--form-switch-focus-offset-color",i),o=n.querySelector(".inp-switch-focus-offset-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-dropfile-border-color"]||"rgb(194 194 194)",r.style.setProperty("--form-dropfile-border-color",i),o=n.querySelector(".inp-dropfile-border-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-dropfile-hover-color"]||"",r.style.setProperty("--form-dropfile-hover-color",i),o=n.querySelector(".inp-dropfile-hover-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-button-background-color"]||"",r.style.setProperty("--form-button-background-color",i),o=n.querySelector(".inp-button-bg-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-button-hover-background-color"]||"",r.style.setProperty("--form-button-hover-background-color",i),o=n.querySelector(".inp-button-hover-bg-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-button-text-color"]||"",r.style.setProperty("--form-button-text-color",i),o=n.querySelector(".inp-button-text-color"),o&&(o.style.backgroundColor=i),i=s&&s["--form-button-hover-text-color"]||"",r.style.setProperty("--form-button-hover-text-color",i),o=n.querySelector(".inp-button-hover-text-color"),o&&(o.style.backgroundColor=i)}getTheme(){const e=this.settings.designerElement||this.element;let t,n,s={cssVariables:{}};const o=document.documentElement;t=e.querySelector(".inp-text-color"),n=t.style.backgroundColor,s.cssVariables["--form-text-color"]=n,o.style.setProperty("--form-text-color",n),t=e.querySelector(".inp-primary-color"),n=t.style.backgroundColor,s.cssVariables["--form-primary-color"]=n,o.style.setProperty("--form-primary-color",n),t=e.querySelector(".inp-form-title-color"),n=t.style.backgroundColor,s.cssVariables["--form-title-color"]=n,o.style.setProperty("--form-title-color",n),t=e.querySelector(".inp-form-desc-color"),n=t.style.backgroundColor,s.cssVariables["--form-desc-color"]=n,o.style.setProperty("--form-desc-color",n),t=e.querySelector(".inp-label-color"),n=t.style.backgroundColor,s.cssVariables["--form-label-color"]=n,o.style.setProperty("--form-label-color",n),t=e.querySelector(".inp-input-border-color"),n=t.style.backgroundColor,s.cssVariables["--form-input-border-color"]=n,o.style.setProperty("--form-input-border-color",n),t=e.querySelector(".inp-input-border-width"),n=t.value+"px",s.cssVariables["--form-primary-border-width"]=n,o.style.setProperty("--form-primary-border-width",n),t=e.querySelector(".inp-input-focused-border-width"),n=t.value+"px",s.cssVariables["--form-secondary-border-width"]=n,o.style.setProperty("--form-secondary-border-width",n),t=e.querySelector(".inp-input-bg-color"),n=t.style.backgroundColor,s.cssVariables["--form-input-background-color"]=n,o.style.setProperty("--form-input-background-color",n),t=e.querySelector(".inp-input-placeholder-color"),n=t.style.backgroundColor,s.cssVariables["--form-input-placeholder-color"]=n,o.style.setProperty("--form-input-placeholder-color",n),t=e.querySelector(".inp-choice-border-color"),n=t.style.backgroundColor,s.cssVariables["--form-choice-border-color"]=n,o.style.setProperty("--form-choice-border-color",n),t=e.querySelector(".inp-switch-bg-color"),n=t.style.backgroundColor,s.cssVariables["--form-switch-background-color"]=n,o.style.setProperty("--form-switch-background-color",n),t=e.querySelector(".inp-switch-knob-color"),n=t.style.backgroundColor,s.cssVariables["--form-switch-knob-color"]=n,o.style.setProperty("--form-switch-knob-color",n),t=e.querySelector(".inp-switch-focus-offset-color"),n=t.style.backgroundColor,s.cssVariables["--form-switch-focus-offset-color"]=n,o.style.setProperty("--form-switch-focus-offset-color",n),t=e.querySelector(".inp-dropfile-border-color"),n=t.style.backgroundColor,s.cssVariables["--form-dropfile-border-color"]=n,o.style.setProperty("--form-dropfile-border-color",n),t=e.querySelector(".inp-dropfile-hover-color"),n=t.style.backgroundColor,s.cssVariables["--form-dropfile-hover-color"]=n,o.style.setProperty("--form-dropfile-hover-color",n),t=e.querySelector(".inp-button-bg-color"),n=t.style.backgroundColor,s.cssVariables["--form-button-background-color"]=n,o.style.setProperty("--form-button-background-color",n),t=e.querySelector(".inp-button-hover-bg-color"),n=t.style.backgroundColor,s.cssVariables["--form-button-hover-background-color"]=n,o.style.setProperty("--form-button-hover-background-color",n),t=e.querySelector(".inp-button-text-color"),n=t.style.backgroundColor,s.cssVariables["--form-button-text-color"]=n,o.style.setProperty("--form-button-text-color",n),t=e.querySelector(".inp-button-hover-text-color"),n=t.style.backgroundColor,s.cssVariables["--form-button-hover-text-color"]=n,o.style.setProperty("--form-button-hover-text-color",n);const i=JSON.stringify(s);return this.themeData=i,i}hideDesigner(){const e=document.querySelector(".formdesigner-container");e&&e.classList.add("hidden")}showGenerator(){const e=this.settings.generatorElement;if(e&&(e.classList.remove("hidden"),e.classList.add("formgenerator-container"),e.classList.add("fb-ui"),!e.querySelector(".btn-generate-form"))){let t=this.getId();const n="en-US";let s=[];["af","sq","am","ar","hy","az","eu","be","bn","bs","bg","ca","ceb","zh","co","hr","cs","da","nl","en","eo","et","fi","fr","fy","gl","ka","de","el","gu","ht","ha","haw","he","hi","hmn","hu","is","ig","id","ga","it","ja","jw","kn","kk","km","rw","ko","ku","ky","lo","la","lv","lt","lb","mk","mg","ms","ml","mt","mi","mr","mn","my","ne","no","ny","or","ps","fa","pl","pt","pa","ro","ru","sm","gd","sr","st","sn","sd","si","sk","sl","so","es","su","sw","sv","tl","tg","ta","tt","te","th","tr","tk","uk","ur","ug","uz","vi","cy","xh","yi","yo","zu"].forEach((e=>{const t=new Intl.DisplayNames([n],{type:"language"}).of(e);s.push({id:e,name:t})}));let o="";s.map((e=>o+=`<option value="${e.name}"${e.name===this.settings.language?" selected":""}>\n                        ${e.name}\n                    </option>`));const i=`\n                    <div class="inner-container">\n                    \n                        <div class="settings-title">\n                            ${this.out("Generate Form")}\n                        </div>\n\n                        <label \n                            for="inpPrompt_${t}" \n                            class="field-label">\n                            ${this.out("What kind of form would you like to create?")}\n                        </label>\n\n                        <textarea \n                            id="inpPrompt_${t}" \n                            class="inp-base" \n                            required="required"></textarea>\n                        \n                        <div class="flex flex-col gap-2${this.settings.languageSelection?"":" hidden"}">\n                            <label htmlFor="inpLanguage_${t}" class="field-label">${this.out("Language")}:</label>\n                            <div class="relative">\n                                <select id="inpLanguage_${t}" aria-label="${this.out("Select language")}" \n                                    class="inp-base">\n                                    ${o}\n                                </select>\n                                <div class="select-arrow">\n                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />\n                                    </svg>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <button class="btn-generate-form">\n                        ${this.out("Generate")}\n                    </button>\n\n                    ${this.settings.demo?'\n                        <p class="demo-info">\n                            <b>License Info:</b> a developer license is required to use the library.\n                        </p>\n                    ':""}\n                `;e.insertAdjacentHTML("afterbegin",i);const r=e.querySelector(".btn-generate-form");r.addEventListener("click",(async()=>{const n=e.querySelector(`#inpPrompt_${t}`);let s=n.value;if(!s)return void n.focus();if(this.isGenerating)return this.abort(),this.isGenerating=!1,void(r.innerHTML=this.out("Generate"));this.isGenerating=!0,r.innerHTML=`\n                    <span class="loading-icon">\n                                <svg class="animate-spin" style="margin:0;margin-right: 0.5rem;width: 1.25rem;height: 1.25rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                                    <circle style="opacity: 0.25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                                    <path style="opacity: 0.75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                                </svg>\n                            </span> ${this.out("Abort")}`;let o={prompt:s,language:e.querySelector(`#inpLanguage_${t}`).value};const i=await this.generate(o);i?(this.settings.onGenerate&&this.settings.onGenerate(i),this.isGenerating=!1,r.innerHTML=this.out("Generate")):r.innerHTML=this.out("Generate")}))}}async generate(e){const t=e.prompt,n=e.language||this.settings.language||"English";this.settings.model=e.model||this.settings.model||"gpt-4o-mini";let s=t,o="You are an assistant",i=`This is example form configuration:\n\n {\n    "title": "Define Your Product Value Proposition",\n    "description": "Help us understand your product's unique value to refine your value proposition.",\n    "elements": [\n        {\n            "title": "What is your product name?",\n            "name": "product_name",\n            "type": "short-text",\n            "isRequired": true,\n            "placeholder": ""\n        },\n        {\n            "title": "What does your product do?",\n            "name": "product_description",\n            "type": "long-text",\n            "isRequired": true,\n            "placeholder": "Briefly describe what your product does."\n        },\n        {\n            "title": "What customer problem does your product solve?",\n            "name": "customer_problem",\n            "type": "long-text",\n            "isRequired": true,\n            "placeholder": "Describe the key issue your product addresses."\n        },\n        {\n            "title": "What is your unique value proposition?",\n            "name": "unique_value_proposition",\n            "type": "long-text",\n            "isRequired": true,\n            "placeholder": "Explain what sets your product apart from others."\n        },\n        {\n            "title": "Who are your key competitors?",\n            "name": "key_competitors",\n            "type": "long-text",\n            "isRequired": false,\n            "placeholder": "List competitors or alternative solutions."\n        },\n        {\n            "title": "What benefits does your product offer?",\n            "name": "product_benefits",\n            "type": "multi-select",\n            "choices": [\n                "Convenience (e.g., saves time, simplifies tasks)",\n                "Cost-effectiveness (e.g., reduces expenses, offers savings)",\n                "Quality improvement (e.g., better than existing solutions)",\n                "Access (e.g., makes something more available)",\n                "User experience (e.g., intuitive and easy to use)"\n            ],\n            "showOtherItem": true,\n            "otherText": "Other (describe):"\n        },\n        {\n            "title": "Who is your target audience?",\n            "name": "target_audience",\n            "type": "dropdown",\n            "isRequired": true,\n            "placeholder": "Select...",\n            "choices": [\n                "Teens (13-18 years old)",\n                "Young Adults (19-30 years old)",\n                "Adults (31-50 years old)",\n                "Seniors (51+ years old)",\n                "Businesses/Organizations"\n            ],\n            "showOtherItem": true,\n            "otherText": "Other (describe)"\n        },\n        {\n            "title": "What metrics define success for your product?",\n            "name": "success_metrics",\n            "type": "long-text",\n            "isRequired": false,\n            "placeholder": "E.g., sales volume, user adoption, satisfaction scores."\n        },\n        {\n            "title": "What is your product's pricing model?",\n            "name": "pricing_model",\n            "type": "select",\n            "isRequired": true,\n            "choices": [\n                "Free",\n                "Freemium",\n                "Subscription",\n                "One-time purchase",\n                "Pay-per-use"\n            ],\n            "showOtherItem": true,\n            "otherText": "Other (describe):"\n        }\n    ]\n}\n    \nYou will generate form for gathering data like this based on the instruction. The form inputs should gather enough information to be useful for analysis and insight generation.\nFor ease of use, maximize the usage of "select", "multi-select", and "switch" input types, not just "long-text" (it's easy to check/switch than to write).\nOption for 'Other' must use:\n\n    "showOtherItem": true\n\nand "otherText" must exists regardles "showOtherItem" is true or false.\n\nWrite in ${n}.\n\nNow talk. Answer only.\n`,r=await this.send(s,i,o,[]);if(!r)return!1;this.settings.consoleLog&&console.log(r);let l;r=(e=>{let t="```json";if(e.startsWith(t)&&e.endsWith("```")){return e.slice(7,-3).trim()}return e})(r);try{l=JSON.parse(r)}catch(e){}if(!l){let e=[{name:"form_generator",description:"Generate a form in JSON format.",parameters:{type:"object",properties:{count:{type:"number",description:"Count the number of fields in the form."},form:{type:"string",description:"The form in JSON format."}},required:["count","form"]}}];i="",s=`This is my form in JSON format:\n            \n${r}\n            `;let t=await this.send(s,i,o,e);if(!t)return!1;let n=JSON.parse(t);this.settings.consoleLog&&(console.log("Parse the Form:"),console.log(n)),r=n.form}return r}abort(){this.controller&&this.controller.abort()}load(e){let t;if(e)try{t=JSON.parse(e)}catch(e){t={}}else t={};const n=this.settings.builderElement;if(n){n.classList.remove("hidden"),n.classList.add("formbuilder-container"),this.render();n.querySelector(".form-title > span").innerText=t.title||this.out("Your Form Title Here");n.querySelector(".form-desc > span").innerText=t.description||this.out("Your Description Here");n.querySelector(".fields-container").innerHTML="",t.elements&&t.elements.forEach(((e,t)=>{this.addField(e.type);const s=n.querySelector(".fields-container").children[t];s.querySelector(".inp-field-title").innerText=e.title;const o=s.querySelector(".chk-required");o&&(o.checked=e.isRequired);const i=s.querySelector(".inp-placeholder-text");i&&(i.value=e.placeholder||"");const r=s.querySelector(".inp-default-value");r&&(r.value=e.value||""),s.setAttribute("data-name",e.name);const l=s.querySelector(".options-container");if(l){if(e.choices){let t=e.choices.length-l.children.length;if(t>0)for(let e=1;e<=t;e++)this.addSelectItem(l,!0);e.choices.forEach(((e,t)=>{l.children[t].querySelector(".inp-option").value=e}))}const t=s.querySelector(".inp-other-option"),n=s.querySelector(".btn-other");e.showOtherItem?(n.classList.add("active"),n.innerHTML='\n                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />\n                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />\n                        </svg>\n                        '):(n.classList.remove("active"),n.innerHTML='\n                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">\n                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />\n                        </svg>\n                        '),t.value=e.otherText||this.out("Other (describe)")}}))}this.json=t,this.formElements=t.elements,this.view(e),this.showDesigner(),this.showSettings(),this.showGenerator()}textToId(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").trim().replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}get(){if(this.element){let e=[];const t=this.element.querySelector(".fields-container");Array.from(t.children).forEach((t=>{let n={};const s=t.querySelector(".inp-field-title");n.title=s.innerText,n.name=t.getAttribute("data-name")||this.textToId(n.title),n.type=t.getAttribute("data-type");const o=t.querySelector(".chk-required"),i=t.querySelector(".inp-placeholder-text"),r=t.querySelector(".inp-default-value");o&&(n.isRequired=o.checked),i&&(n.placeholder=i.value),r&&(n.value=r.value);const l=t.querySelector(".options-container");if(l){let e=[];Array.from(l.children).forEach((t=>{const n=t.querySelector(".inp-option");e.push(n.value)})),n.choices=e;const s=t.querySelector(".btn-other");if(s&&s.classList.contains("active")){n.showOtherItem=!0;const e=t.querySelector(".inp-other-option");e&&(n.otherText=e.value)}}const a=Array.from(t.querySelectorAll('input[name="file-category"]:checked')).map((e=>e.value));a&&a.length>0&&(n.allowedFileTypes=a),e.push(n)})),this.formElements=e;let n={title:this.element.querySelector(".form-title > span").innerText.trim(),description:this.element.querySelector(".form-desc > span").innerText.trim(),elements:e};const s=this.settings.settingsElement;let o,i;if(s){const e=s.querySelector(".inp-submit-text");e&&(o=e.value);const t=s.querySelector('input[name="hideheader"]');t&&(i=t.checked),n.submitText=o,n.hideHeader=i}else n.submitText=this.json.submitText||this.settings.submitText,n.hideHeader=this.json.hideHeader||!1;n.useSubmitButton=this.settings.useSubmitButton,this.refreshPromptEditors();return JSON.stringify(n)}{const e=this.settings.settingsElement;let t,n;if(e){const s=e.querySelector(".inp-submit-text");s&&(t=s.value);const o=e.querySelector('input[name="hideheader"]');o&&(n=o.checked),this.json.submitText=t,this.json.hideHeader=n}return JSON.stringify(this.json)}}refreshPromptEditors(){let e=this.formElements;this.steps.length>0&&this.editors.forEach(((t,n)=>{let s=[];e.forEach((e=>{let t=e.title;t=t.replace(/:/g,""),s.push({title:t,name:e.name.toUpperCase()})}));const o=n+1;for(let e=1;e<o;e++)s.push({title:`Output from step ${e}`,name:`OUTPUT_STEP_${e}`});t.settings.tags=s,t.renderDropdown()}))}getFormValues(){const e=this.settings.previewElement;if(!e)return[];const t=e.querySelectorAll("[name]");if(0===t.length)return{};const n={};t.forEach((e=>{const{name:t,type:s,value:o,checked:i,files:r}=e;if("checkbox"===s)i&&(n[t]=n[t]||[],n[t].push(o));else if("radio"===s)i&&(n[t]=o);else if("file"===s)r.length>0&&(n[t]=r);else if("select-multiple"===s){const s=Array.from(e.selectedOptions);n[t]=s.map((e=>e.value))}else n[t]=o}));let s=[];return JSON.parse(this.get()).elements.forEach((e=>{let t=e.title,o=e.name,i={questions:t,name:o,value:n[o]};s.push(i)})),s}getId(e="id"){return`${e}-${Math.random().toString(36).substr(2,9)}`}appendHtml(e,t){e&&t&&e.insertAdjacentHTML("beforeend",t)}clearAllEventListener(e){for(let t=0;t<10;t++)e.removeEventListener("keydown",this.handlePopKeyDown),document.removeEventListener("mousedown",this.handlePopClickOut),document.removeEventListener("touchstart",this.handlePopClickOut,{passive:!1})}showPop(e,t,n){document.querySelectorAll(".is-pop.active").forEach((t=>{let s=!0;t.contains(n)&&(s=!1),t!==e&&s&&(t.style.display="",t.classList.remove("active"),t.setAttribute("aria-hidden",!0))})),e.style.display="flex",e.classList.add("active"),e.setAttribute("aria-hidden",!1),e.focus({preventScroll:!0}),this.handlePopClickOut=s=>{e.contains(s.target)||n.contains(s.target)||(this.hidePop(e),t&&t(),n&&n.focus())},this.handlePopKeyDown=s=>{27===s.keyCode&&(this.hidePop(e),t&&t(),n&&n.focus())},e.addEventListener("keydown",this.handlePopKeyDown),document.addEventListener("mousedown",this.handlePopClickOut),document.addEventListener("touchstart",this.handlePopClickOut,{passive:!1})}hidePop(e){e.style.display="",e.classList.remove("active"),document.activeElement.blur(),e.setAttribute("aria-hidden",!0),this.handlePopClickOut&&(document.removeEventListener("mousedown",this.handlePopClickOut),document.removeEventListener("touchstart",this.handlePopClickOut,{passive:!1}),this.handlePopClickOut=null),this.handlePopKeyDown&&(e.removeEventListener("keydown",this.handlePopKeyDown),this.handlePopKeyDown=null)}destroy(){this.settings.builderElement&&(this.cleanup(),this.settings.builderElement.innerHTML="",this.settings.builderElement.classList.remove("formbuilder-container"),this.settings.builderElement.classList.remove("fb-ui")),this.settings.designerElement&&(this.settings.designerElement.innerHTML="",this.settings.designerElement.classList.remove("formdesigner-container"),this.settings.designerElement.classList.remove("fb-ui")),this.settings.settingsElement&&(this.settings.settingsElement.innerHTML="",this.settings.settingsElement.classList.remove("formsettings-container"),this.settings.settingsElement.classList.remove("fb-ui")),this.settings.generatorElement&&(this.settings.generatorElement.innerHTML="",this.settings.generatorElement.classList.remove("formgenerator-container"),this.settings.generatorElement.classList.remove("fb-ui")),this.settings.workflowElement&&(this.settings.workflowElement.innerHTML="",this.settings.workflowElement.classList.remove("formworkflow-container"),this.settings.workflowElement.classList.remove("fb-ui")),this.settings.previewElement&&(this.settings.previewElement.innerHTML="",this.settings.previewElement.classList.remove("formview-container"),this.settings.previewElement.classList.remove("fb-ui")),this.settings.resultElement&&(this.settings.resultElement.innerHTML="",this.settings.resultElement.classList.remove("result-container"),this.settings.resultElement.classList.remove("fb-ui"))}out(e){let t=this.settings.lang[e];return t||e}}}();

</script>
</body>
</html>
